<!DOCTYPE html>  <html> <head>   <title>protoaculous.min.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="abapp.html">                 abapp.js               </a>                                           <a class="source" href="abmessage.html">                 abmessage.js               </a>                                           <a class="source" href="app.html">                 app.js               </a>                                           <a class="source" href="compiler.html">                 compiler.js               </a>                                           <a class="source" href="def.html">                 def.js               </a>                                           <a class="source" href="euwindow.html">                 euwindow.js               </a>                                           <a class="source" href="faye_ext.html">                 faye_ext.js               </a>                                           <a class="source" href="handlebars.html">                 handlebars.js               </a>                                           <a class="source" href="lowpro.html">                 lowpro.js               </a>                                           <a class="source" href="managers.html">                 managers.js               </a>                                           <a class="source" href="mustache.html">                 mustache.js               </a>                                           <a class="source" href="protoaculous.min.html">                 protoaculous.min.js               </a>                                           <a class="source" href="prototype.html">                 prototype.js               </a>                                           <a class="source" href="prototype.s2.min.html">                 prototype.s2.min.js               </a>                                           <a class="source" href="sha1.html">                 sha1.js               </a>                                           <a class="source" href="templates.html">                 templates.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               protoaculous.min.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Prototype</span><span class="o">=</span><span class="p">{</span><span class="nx">Version</span><span class="o">:</span><span class="s2">&quot;1.6.1&quot;</span><span class="p">,</span><span class="nx">Browser</span><span class="o">:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;[object Opera]&quot;</span><span class="p">;</span><span class="k">return</span><span class="p">{</span><span class="nx">IE</span><span class="o">:!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="o">&amp;&amp;!</span><span class="nx">A</span><span class="p">,</span><span class="nx">Opera</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">WebKit</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;AppleWebKit/&quot;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">,</span><span class="nx">Gecko</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;Gecko&quot;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;KHTML&quot;</span><span class="p">)</span><span class="o">===-</span><span class="mi">1</span><span class="p">,</span><span class="nx">MobileSafari</span><span class="o">:</span><span class="sr">/Apple.*Mobile.*Safari/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">B</span><span class="p">)}})(),</span><span class="nx">BrowserFeatures</span><span class="o">:</span><span class="p">{</span><span class="nx">XPath</span><span class="o">:!!</span><span class="nb">document</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">,</span><span class="nx">SelectorsAPI</span><span class="o">:!!</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">,</span><span class="nx">ElementExtensions</span><span class="o">:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">Element</span><span class="o">||</span><span class="nb">window</span><span class="p">.</span><span class="nx">HTMLElement</span><span class="p">;</span><span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)})(),</span><span class="nx">SpecificElementExtensions</span><span class="o">:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">HTMLDivElement</span><span class="o">!==</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="k">return</span> <span class="kc">true</span><span class="p">}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;form&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">__proto__</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">__proto__</span><span class="o">!==</span><span class="nx">B</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">)){</span><span class="nx">A</span><span class="o">=</span><span class="kc">true</span><span class="p">}</span><span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">})()},</span><span class="nx">ScriptFragment</span><span class="o">:</span><span class="s2">&quot;&lt;script[^&gt;]*&gt;([\\S\\s]*?)&lt;\/script&gt;&quot;</span><span class="p">,</span><span class="nx">JSONFilter</span><span class="o">:</span><span class="sr">/^\/\*-secure-([\s\S]*)\*\/\s*$/</span><span class="p">,</span><span class="nx">emptyFunction</span><span class="o">:</span><span class="kd">function</span><span class="p">(){},</span><span class="nx">K</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}};</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">MobileSafari</span><span class="p">){</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">SpecificElementExtensions</span><span class="o">=</span><span class="kc">false</span><span class="p">}</span><span class="kd">var</span> <span class="nx">Abstract</span><span class="o">=</span><span class="p">{};</span><span class="kd">var</span> <span class="nx">Try</span><span class="o">=</span><span class="p">{</span><span class="nx">these</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">C</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">B</span><span class="o">&lt;</span><span class="nx">D</span><span class="p">;</span><span class="nx">B</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="nx">B</span><span class="p">];</span><span class="k">try</span><span class="p">{</span><span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">();</span><span class="k">break</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">E</span><span class="p">){}}</span><span class="k">return</span> <span class="nx">C</span><span class="p">}};</span><span class="kd">var</span> <span class="nx">Class</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(){}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="kc">null</span><span class="p">,</span><span class="nx">F</span><span class="o">=</span><span class="nx">$A</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">F</span><span class="p">[</span><span class="mi">0</span><span class="p">])){</span><span class="nx">G</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">shift</span><span class="p">()}</span><span class="kd">function</span> <span class="nx">D</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">Class</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);</span><span class="nx">D</span><span class="p">.</span><span class="nx">superclass</span><span class="o">=</span><span class="nx">G</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">subclasses</span><span class="o">=</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="k">new</span> <span class="nx">A</span><span class="p">;</span><span class="nx">G</span><span class="p">.</span><span class="nx">subclasses</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">E</span><span class="o">&lt;</span><span class="nx">F</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">E</span><span class="o">++</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">addMethods</span><span class="p">(</span><span class="nx">F</span><span class="p">[</span><span class="nx">E</span><span class="p">])}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">initialize</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">initialize</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">}</span><span class="nx">D</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="k">return</span> <span class="nx">D</span><span class="p">}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">J</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">superclass</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">J</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">({</span><span class="nx">toString</span><span class="o">:</span><span class="kc">true</span><span class="p">}).</span><span class="nx">length</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">J</span><span class="p">.</span><span class="nx">toString</span><span class="o">!=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;toString&quot;</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">J</span><span class="p">.</span><span class="nx">valueOf</span><span class="o">!=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;valueOf&quot;</span><span class="p">)}}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">G</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">D</span><span class="o">&lt;</span><span class="nx">G</span><span class="p">;</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">I</span><span class="o">=</span><span class="nx">E</span><span class="p">[</span><span class="nx">D</span><span class="p">],</span><span class="nx">H</span><span class="o">=</span><span class="nx">J</span><span class="p">[</span><span class="nx">I</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">&amp;&amp;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">H</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">H</span><span class="p">.</span><span class="nx">argumentNames</span><span class="p">().</span><span class="nx">first</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;$super&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">K</span><span class="o">=</span><span class="nx">H</span><span class="p">;</span><span class="nx">H</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">L</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">F</span><span class="p">[</span><span class="nx">L</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)}})(</span><span class="nx">I</span><span class="p">).</span><span class="nx">wrap</span><span class="p">(</span><span class="nx">K</span><span class="p">);</span><span class="nx">H</span><span class="p">.</span><span class="nx">valueOf</span><span class="o">=</span><span class="nx">K</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">K</span><span class="p">);</span><span class="nx">H</span><span class="p">.</span><span class="nx">toString</span><span class="o">=</span><span class="nx">K</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">K</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">I</span><span class="p">]</span><span class="o">=</span><span class="nx">H</span><span class="p">}</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="k">return</span><span class="p">{</span><span class="nx">create</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">Methods</span><span class="o">:</span><span class="p">{</span><span class="nx">addMethods</span><span class="o">:</span><span class="nx">C</span><span class="p">}}})();(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span><span class="kd">function</span> <span class="nx">I</span><span class="p">(</span><span class="nx">Q</span><span class="p">,</span><span class="nx">S</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">R</span> <span class="k">in</span> <span class="nx">S</span><span class="p">){</span><span class="nx">Q</span><span class="p">[</span><span class="nx">R</span><span class="p">]</span><span class="o">=</span><span class="nx">S</span><span class="p">[</span><span class="nx">R</span><span class="p">]}</span><span class="k">return</span> <span class="nx">Q</span><span class="p">}</span><span class="kd">function</span> <span class="nx">L</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">(</span><span class="nx">Q</span><span class="p">)){</span><span class="k">return</span><span class="s2">&quot;undefined&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">Q</span><span class="o">===</span><span class="kc">null</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;null&quot;</span><span class="p">}</span><span class="k">return</span> <span class="nx">Q</span><span class="p">.</span><span class="nx">inspect</span><span class="o">?</span><span class="nx">Q</span><span class="p">.</span><span class="nx">inspect</span><span class="p">()</span><span class="o">:</span><span class="nb">String</span><span class="p">(</span><span class="nx">Q</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">R</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">R</span> <span class="k">instanceof</span> <span class="nx">RangeError</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;...&quot;</span><span class="p">}</span><span class="k">throw</span> <span class="nx">R</span><span class="p">}}</span><span class="kd">function</span> <span class="nx">K</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="kd">var</span> <span class="nx">S</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">Q</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="nx">S</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;undefined&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;function&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;unknown&quot;</span><span class="o">:</span><span class="k">return</span> <span class="p">;</span><span class="k">case</span><span class="s2">&quot;boolean&quot;</span><span class="o">:</span><span class="k">return</span> <span class="nx">Q</span><span class="p">.</span><span class="nx">toString</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nx">Q</span><span class="o">===</span><span class="kc">null</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;null&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">Q</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">){</span><span class="k">return</span> <span class="nx">Q</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nx">H</span><span class="p">(</span><span class="nx">Q</span><span class="p">)){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">R</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">U</span> <span class="k">in</span> <span class="nx">Q</span><span class="p">){</span><span class="kd">var</span> <span class="nx">T</span><span class="o">=</span><span class="nx">K</span><span class="p">(</span><span class="nx">Q</span><span class="p">[</span><span class="nx">U</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">E</span><span class="p">(</span><span class="nx">T</span><span class="p">)){</span><span class="nx">R</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">U</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;: &quot;</span><span class="o">+</span><span class="nx">T</span><span class="p">)}}</span><span class="k">return</span><span class="s2">&quot;{&quot;</span><span class="o">+</span><span class="nx">R</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;}&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="nx">$H</span><span class="p">(</span><span class="nx">Q</span><span class="p">).</span><span class="nx">toQueryString</span><span class="p">()}</span><span class="kd">function</span> <span class="nx">F</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="nx">Q</span><span class="o">&amp;&amp;</span><span class="nx">Q</span><span class="p">.</span><span class="nx">toHTML</span><span class="o">?</span><span class="nx">Q</span><span class="p">.</span><span class="nx">toHTML</span><span class="p">()</span><span class="o">:</span><span class="nb">String</span><span class="p">.</span><span class="nx">interpret</span><span class="p">(</span><span class="nx">Q</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">O</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="kd">var</span> <span class="nx">R</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">S</span> <span class="k">in</span> <span class="nx">Q</span><span class="p">){</span><span class="nx">R</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">S</span><span class="p">)}</span><span class="k">return</span> <span class="nx">R</span><span class="p">}</span><span class="kd">function</span> <span class="nx">M</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="kd">var</span> <span class="nx">R</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">S</span> <span class="k">in</span> <span class="nx">Q</span><span class="p">){</span><span class="nx">R</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Q</span><span class="p">[</span><span class="nx">S</span><span class="p">])}</span><span class="k">return</span> <span class="nx">R</span><span class="p">}</span><span class="kd">function</span> <span class="nx">J</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="nx">I</span><span class="p">({},</span><span class="nx">Q</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">H</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">Q</span><span class="o">&amp;&amp;</span><span class="nx">Q</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">1</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">G</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">Q</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;[object Array]&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">P</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="nx">Q</span> <span class="k">instanceof</span> <span class="nx">Hash</span><span class="p">}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="k">typeof</span> <span class="nx">Q</span><span class="o">===</span><span class="s2">&quot;function&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">Q</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;[object String]&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">N</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">Q</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;[object Number]&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">E</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="k">typeof</span> <span class="nx">Q</span><span class="o">===</span><span class="s2">&quot;undefined&quot;</span><span class="p">}</span><span class="nx">I</span><span class="p">(</span><span class="nb">Object</span><span class="p">,{</span><span class="nx">extend</span><span class="o">:</span><span class="nx">I</span><span class="p">,</span><span class="nx">inspect</span><span class="o">:</span><span class="nx">L</span><span class="p">,</span><span class="nx">toJSON</span><span class="o">:</span><span class="nx">K</span><span class="p">,</span><span class="nx">toQueryString</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">toHTML</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">keys</span><span class="o">:</span><span class="nx">O</span><span class="p">,</span><span class="nx">values</span><span class="o">:</span><span class="nx">M</span><span class="p">,</span><span class="nx">clone</span><span class="o">:</span><span class="nx">J</span><span class="p">,</span><span class="nx">isElement</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">isArray</span><span class="o">:</span><span class="nx">G</span><span class="p">,</span><span class="nx">isHash</span><span class="o">:</span><span class="nx">P</span><span class="p">,</span><span class="nx">isFunction</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">isString</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">isNumber</span><span class="o">:</span><span class="nx">N</span><span class="p">,</span><span class="nx">isUndefined</span><span class="o">:</span><span class="nx">E</span><span class="p">})})();</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">K</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">;</span><span class="kd">function</span> <span class="nx">D</span><span class="p">(</span><span class="nx">O</span><span class="p">,</span><span class="nx">L</span><span class="p">){</span><span class="kd">var</span> <span class="nx">N</span><span class="o">=</span><span class="nx">O</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">M</span><span class="o">=</span><span class="nx">L</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">M</span><span class="o">--</span><span class="p">){</span><span class="nx">O</span><span class="p">[</span><span class="nx">N</span><span class="o">+</span><span class="nx">M</span><span class="p">]</span><span class="o">=</span><span class="nx">L</span><span class="p">[</span><span class="nx">M</span><span class="p">]}</span><span class="k">return</span> <span class="nx">O</span><span class="p">}</span><span class="kd">function</span> <span class="nx">I</span><span class="p">(</span><span class="nx">M</span><span class="p">,</span><span class="nx">L</span><span class="p">){</span><span class="nx">M</span><span class="o">=</span><span class="nx">K</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">M</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span> <span class="nx">D</span><span class="p">(</span><span class="nx">M</span><span class="p">,</span><span class="nx">L</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">G</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^[\s\(]*function[^(]*\(([^)]*)\)/</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s+/g</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">L</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">1</span><span class="o">&amp;&amp;!</span><span class="nx">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">?</span><span class="p">[]</span><span class="o">:</span><span class="nx">L</span><span class="p">}</span><span class="kd">function</span> <span class="nx">H</span><span class="p">(</span><span class="nx">N</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&amp;&amp;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">])){</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">M</span><span class="o">=</span><span class="nx">K</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">O</span><span class="o">=</span><span class="nx">I</span><span class="p">(</span><span class="nx">M</span><span class="p">,</span><span class="nx">arguments</span><span class="p">);</span><span class="k">return</span> <span class="nx">L</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">N</span><span class="p">,</span><span class="nx">O</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">F</span><span class="p">(</span><span class="nx">N</span><span class="p">){</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">M</span><span class="o">=</span><span class="nx">K</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">P</span><span class="p">){</span><span class="kd">var</span> <span class="nx">O</span><span class="o">=</span><span class="nx">D</span><span class="p">([</span><span class="nx">P</span><span class="o">||</span><span class="nb">window</span><span class="p">.</span><span class="nx">event</span><span class="p">],</span><span class="nx">M</span><span class="p">);</span><span class="k">return</span> <span class="nx">L</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">N</span><span class="p">,</span><span class="nx">O</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">J</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">M</span><span class="o">=</span><span class="nx">K</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">N</span><span class="o">=</span><span class="nx">I</span><span class="p">(</span><span class="nx">M</span><span class="p">,</span><span class="nx">arguments</span><span class="p">);</span><span class="k">return</span> <span class="nx">L</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">N</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">E</span><span class="p">(</span><span class="nx">N</span><span class="p">){</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">M</span><span class="o">=</span><span class="nx">K</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="nx">N</span><span class="o">=</span><span class="nx">N</span><span class="o">*</span><span class="mi">1000</span><span class="p">;</span><span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">L</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">L</span><span class="p">,</span><span class="nx">M</span><span class="p">)},</span><span class="nx">N</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="nx">D</span><span class="p">([</span><span class="mf">0.01</span><span class="p">],</span><span class="nx">arguments</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">delay</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">L</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">M</span><span class="p">){</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">N</span><span class="o">=</span><span class="nx">D</span><span class="p">([</span><span class="nx">L</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)],</span><span class="nx">arguments</span><span class="p">);</span><span class="k">return</span> <span class="nx">M</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">N</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_methodized</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_methodized</span><span class="p">}</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_methodized</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">M</span><span class="o">=</span><span class="nx">D</span><span class="p">([</span><span class="k">this</span><span class="p">],</span><span class="nx">arguments</span><span class="p">);</span><span class="k">return</span> <span class="nx">L</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">M</span><span class="p">)}}</span><span class="k">return</span><span class="p">{</span><span class="nx">argumentNames</span><span class="o">:</span><span class="nx">G</span><span class="p">,</span><span class="nx">bind</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">bindAsEventListener</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">curry</span><span class="o">:</span><span class="nx">J</span><span class="p">,</span><span class="nx">delay</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">defer</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">wrap</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">methodize</span><span class="o">:</span><span class="nx">B</span><span class="p">}})());</span><span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toJSON</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCFullYear</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="nx">toPaddedString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCDate</span><span class="p">().</span><span class="nx">toPaddedString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;T&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCHours</span><span class="p">().</span><span class="nx">toPaddedString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCMinutes</span><span class="p">().</span><span class="nx">toPaddedString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">getUTCSeconds</span><span class="p">().</span><span class="nx">toPaddedString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Z&quot;&#39;</span><span class="p">};</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">match</span><span class="o">=</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">test</span><span class="p">;</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">escape</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nb">String</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([.*+?^=!:${}()|[\]\/\\])/g</span><span class="p">,</span><span class="s2">&quot;\\$1&quot;</span><span class="p">)};</span><span class="kd">var</span> <span class="nx">PeriodicalExecuter</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">currentlyExecuting</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">registerCallback</span><span class="p">()},</span><span class="nx">registerCallback</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="o">=</span><span class="nx">setInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onTimerEvent</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="o">*</span><span class="mi">1000</span><span class="p">)},</span><span class="nx">execute</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="k">this</span><span class="p">)},</span><span class="nx">stop</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="o">=</span><span class="kc">null</span><span class="p">},</span><span class="nx">onTimerEvent</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">currentlyExecuting</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">currentlyExecuting</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">currentlyExecuting</span><span class="o">=</span><span class="kc">false</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">currentlyExecuting</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">throw</span> <span class="nx">A</span><span class="p">}}}});</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">String</span><span class="p">,{</span><span class="nx">interpret</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nb">String</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">specialChar</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;\b&quot;</span><span class="o">:</span><span class="s2">&quot;\\b&quot;</span><span class="p">,</span><span class="s2">&quot;\t&quot;</span><span class="o">:</span><span class="s2">&quot;\\t&quot;</span><span class="p">,</span><span class="s2">&quot;\n&quot;</span><span class="o">:</span><span class="s2">&quot;\\n&quot;</span><span class="p">,</span><span class="s2">&quot;\f&quot;</span><span class="o">:</span><span class="s2">&quot;\\f&quot;</span><span class="p">,</span><span class="s2">&quot;\r&quot;</span><span class="o">:</span><span class="s2">&quot;\\r&quot;</span><span class="p">,</span><span class="s2">&quot;\\&quot;</span><span class="o">:</span><span class="s2">&quot;\\\\&quot;</span><span class="p">}});</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">prepareReplacement</span><span class="p">(</span><span class="nx">replacement</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">replacement</span><span class="p">)){</span><span class="k">return</span> <span class="nx">replacement</span><span class="p">}</span><span class="kd">var</span> <span class="nx">template</span><span class="o">=</span><span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="nx">replacement</span><span class="p">);</span><span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">){</span><span class="k">return</span> <span class="nx">template</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">match</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">gsub</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span><span class="nx">replacement</span><span class="p">){</span><span class="kd">var</span> <span class="nx">result</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">source</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">match</span><span class="p">;</span><span class="nx">replacement</span><span class="o">=</span><span class="nx">prepareReplacement</span><span class="p">(</span><span class="nx">replacement</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">pattern</span><span class="p">)){</span><span class="nx">pattern</span><span class="o">=</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">pattern</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">pattern</span><span class="p">.</span><span class="nx">length</span><span class="o">||</span><span class="nx">pattern</span><span class="p">.</span><span class="nx">source</span><span class="p">)){</span><span class="nx">replacement</span><span class="o">=</span><span class="nx">replacement</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">replacement</span><span class="o">+</span><span class="nx">source</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="nx">replacement</span><span class="p">)</span><span class="o">+</span><span class="nx">replacement</span><span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">match</span><span class="o">=</span><span class="nx">source</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">pattern</span><span class="p">)){</span><span class="nx">result</span><span class="o">+=</span><span class="nx">source</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">match</span><span class="p">.</span><span class="nx">index</span><span class="p">);</span><span class="nx">result</span><span class="o">+=</span><span class="nb">String</span><span class="p">.</span><span class="nx">interpret</span><span class="p">(</span><span class="nx">replacement</span><span class="p">(</span><span class="nx">match</span><span class="p">));</span><span class="nx">source</span><span class="o">=</span><span class="nx">source</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">match</span><span class="p">.</span><span class="nx">index</span><span class="o">+</span><span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">result</span><span class="o">+=</span><span class="nx">source</span><span class="p">,</span><span class="nx">source</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">}}</span><span class="k">return</span> <span class="nx">result</span><span class="p">}</span><span class="kd">function</span> <span class="nx">sub</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span><span class="nx">replacement</span><span class="p">,</span><span class="nx">count</span><span class="p">){</span><span class="nx">replacement</span><span class="o">=</span><span class="nx">prepareReplacement</span><span class="p">(</span><span class="nx">replacement</span><span class="p">);</span><span class="nx">count</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">count</span><span class="p">)</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="nx">count</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">gsub</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">--</span><span class="nx">count</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span><span class="k">return</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span><span class="k">return</span> <span class="nx">replacement</span><span class="p">(</span><span class="nx">match</span><span class="p">)})}</span><span class="kd">function</span> <span class="nx">scan</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span><span class="nx">iterator</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">gsub</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span><span class="nx">iterator</span><span class="p">);</span><span class="k">return</span> <span class="nb">String</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">truncate</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span><span class="nx">truncation</span><span class="p">){</span><span class="nx">length</span><span class="o">=</span><span class="nx">length</span><span class="o">||</span><span class="mi">30</span><span class="p">;</span><span class="nx">truncation</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">truncation</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;...&quot;</span><span class="o">:</span><span class="nx">truncation</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="nx">length</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">length</span><span class="o">-</span><span class="nx">truncation</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">+</span><span class="nx">truncation</span><span class="o">:</span><span class="nb">String</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">strip</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s+$/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">stripTags</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;\w+(\s+(&quot;[^&quot;]*&quot;|&#39;[^&#39;]*&#39;|[^&gt;])+)?&gt;|&lt;\/\w+&gt;/gi</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">stripScripts</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">ScriptFragment</span><span class="p">,</span><span class="s2">&quot;img&quot;</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">extractScripts</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">matchAll</span><span class="o">=</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">ScriptFragment</span><span class="p">,</span><span class="s2">&quot;img&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">matchOne</span><span class="o">=</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">ScriptFragment</span><span class="p">,</span><span class="s2">&quot;im&quot;</span><span class="p">);</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">matchAll</span><span class="p">)</span><span class="o">||</span><span class="p">[]).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">scriptTag</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">scriptTag</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">matchOne</span><span class="p">)</span><span class="o">||</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">1</span><span class="p">]})}</span><span class="kd">function</span> <span class="nx">evalScripts</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">extractScripts</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">script</span><span class="p">){</span><span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">script</span><span class="p">)})}</span><span class="kd">function</span> <span class="nx">escapeHTML</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;/g</span><span class="p">,</span><span class="s2">&quot;&amp;amp;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span><span class="s2">&quot;&amp;lt;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">unescapeHTML</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">stripTags</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;lt;/g</span><span class="p">,</span><span class="s2">&quot;&lt;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;gt;/g</span><span class="p">,</span><span class="s2">&quot;&gt;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;amp;/g</span><span class="p">,</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">toQueryParams</span><span class="p">(</span><span class="nx">separator</span><span class="p">){</span><span class="kd">var</span> <span class="nx">match</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">strip</span><span class="p">().</span><span class="nx">match</span><span class="p">(</span><span class="sr">/([^?#]*)(#.*)?$/</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="p">){</span><span class="k">return</span><span class="p">{}}</span><span class="k">return</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="nx">separator</span><span class="o">||</span><span class="s2">&quot;&amp;&quot;</span><span class="p">).</span><span class="nx">inject</span><span class="p">({},</span><span class="kd">function</span><span class="p">(</span><span class="nx">hash</span><span class="p">,</span><span class="nx">pair</span><span class="p">){</span><span class="k">if</span><span class="p">((</span><span class="nx">pair</span><span class="o">=</span><span class="nx">pair</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]){</span><span class="kd">var</span> <span class="nx">key</span><span class="o">=</span><span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">pair</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span><span class="kd">var</span> <span class="nx">value</span><span class="o">=</span><span class="nx">pair</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="nx">pair</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="o">!=</span><span class="kc">undefined</span><span class="p">){</span><span class="nx">value</span><span class="o">=</span><span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">value</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">hash</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">hash</span><span class="p">[</span><span class="nx">key</span><span class="p">])){</span><span class="nx">hash</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="nx">hash</span><span class="p">[</span><span class="nx">key</span><span class="p">]]}</span><span class="nx">hash</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">hash</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="o">=</span><span class="nx">value</span><span class="p">}}</span><span class="k">return</span> <span class="nx">hash</span><span class="p">})}</span><span class="kd">function</span> <span class="nx">toArray</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">succ</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">times</span><span class="p">(</span><span class="nx">count</span><span class="p">){</span><span class="k">return</span> <span class="nx">count</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">count</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">camelize</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">parts</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">),</span><span class="nx">len</span><span class="o">=</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">len</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span><span class="kd">var</span> <span class="nx">camelized</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;-&quot;</span><span class="o">?</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">+</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">len</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span><span class="nx">camelized</span><span class="o">+=</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">+</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span><span class="k">return</span> <span class="nx">camelized</span><span class="p">}</span><span class="kd">function</span> <span class="nx">capitalize</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">()}</span><span class="kd">function</span> <span class="nx">underscore</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/::/g</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([A-Z]+)([A-Z][a-z])/g</span><span class="p">,</span><span class="s2">&quot;$1_$2&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([a-z\d])([A-Z])/g</span><span class="p">,</span><span class="s2">&quot;$1_$2&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-/g</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">()}</span><span class="kd">function</span> <span class="nx">dasherize</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/_/g</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">inspect</span><span class="p">(</span><span class="nx">useDoubleQuotes</span><span class="p">){</span><span class="kd">var</span> <span class="nx">escapedString</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[\x00-\x1f\\]/g</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">character</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">character</span> <span class="k">in</span> <span class="nb">String</span><span class="p">.</span><span class="nx">specialChar</span><span class="p">){</span><span class="k">return</span> <span class="nb">String</span><span class="p">.</span><span class="nx">specialChar</span><span class="p">[</span><span class="nx">character</span><span class="p">]}</span><span class="k">return</span><span class="s2">&quot;\\u00&quot;</span><span class="o">+</span><span class="nx">character</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">().</span><span class="nx">toPaddedString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">)});</span><span class="k">if</span><span class="p">(</span><span class="nx">useDoubleQuotes</span><span class="p">){</span><span class="k">return</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="nx">escapedString</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;/g</span><span class="p">,</span><span class="s1">&#39;\\&quot;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">}</span><span class="k">return</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="nx">escapedString</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&#39;/g</span><span class="p">,</span><span class="s2">&quot;\\&#39;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">toJSON</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">inspect</span><span class="p">(</span><span class="kc">true</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">unfilterJSON</span><span class="p">(</span><span class="nx">filter</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">filter</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">JSONFilter</span><span class="p">,</span><span class="s2">&quot;$1&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">isJSON</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">str</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">blank</span><span class="p">()){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="nx">str</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\./g</span><span class="p">,</span><span class="s2">&quot;@&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;[^&quot;\\\n\r]*&quot;/g</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">return</span><span class="p">(</span><span class="sr">/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">str</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">evalJSON</span><span class="p">(</span><span class="nx">sanitize</span><span class="p">){</span><span class="kd">var</span> <span class="nx">json</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">unfilterJSON</span><span class="p">();</span><span class="k">try</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">sanitize</span><span class="o">||</span><span class="nx">json</span><span class="p">.</span><span class="nx">isJSON</span><span class="p">()){</span><span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="o">+</span><span class="nx">json</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">)}}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){}</span><span class="k">throw</span> <span class="k">new</span> <span class="nx">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Badly formed JSON string: &quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">inspect</span><span class="p">())}</span><span class="kd">function</span> <span class="nx">include</span><span class="p">(</span><span class="nx">pattern</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">pattern</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">}</span><span class="kd">function</span> <span class="nx">startsWith</span><span class="p">(</span><span class="nx">pattern</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">pattern</span><span class="p">)</span><span class="o">===</span><span class="mi">0</span><span class="p">}</span><span class="kd">function</span> <span class="nx">endsWith</span><span class="p">(</span><span class="nx">pattern</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="nx">pattern</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">return</span> <span class="nx">d</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="nx">pattern</span><span class="p">)</span><span class="o">===</span><span class="nx">d</span><span class="p">}</span><span class="kd">function</span> <span class="nx">empty</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">blank</span><span class="p">(){</span><span class="k">return</span><span class="sr">/^\s*$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span><span class="nx">pattern</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">pattern</span><span class="p">).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">object</span><span class="p">)}</span><span class="k">return</span><span class="p">{</span><span class="nx">gsub</span><span class="o">:</span><span class="nx">gsub</span><span class="p">,</span><span class="nx">sub</span><span class="o">:</span><span class="nx">sub</span><span class="p">,</span><span class="nx">scan</span><span class="o">:</span><span class="nx">scan</span><span class="p">,</span><span class="nx">truncate</span><span class="o">:</span><span class="nx">truncate</span><span class="p">,</span><span class="nx">strip</span><span class="o">:</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trim</span><span class="o">?</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trim</span><span class="o">:</span><span class="nx">strip</span><span class="p">,</span><span class="nx">stripTags</span><span class="o">:</span><span class="nx">stripTags</span><span class="p">,</span><span class="nx">stripScripts</span><span class="o">:</span><span class="nx">stripScripts</span><span class="p">,</span><span class="nx">extractScripts</span><span class="o">:</span><span class="nx">extractScripts</span><span class="p">,</span><span class="nx">evalScripts</span><span class="o">:</span><span class="nx">evalScripts</span><span class="p">,</span><span class="nx">escapeHTML</span><span class="o">:</span><span class="nx">escapeHTML</span><span class="p">,</span><span class="nx">unescapeHTML</span><span class="o">:</span><span class="nx">unescapeHTML</span><span class="p">,</span><span class="nx">toQueryParams</span><span class="o">:</span><span class="nx">toQueryParams</span><span class="p">,</span><span class="nx">parseQuery</span><span class="o">:</span><span class="nx">toQueryParams</span><span class="p">,</span><span class="nx">toArray</span><span class="o">:</span><span class="nx">toArray</span><span class="p">,</span><span class="nx">succ</span><span class="o">:</span><span class="nx">succ</span><span class="p">,</span><span class="nx">times</span><span class="o">:</span><span class="nx">times</span><span class="p">,</span><span class="nx">camelize</span><span class="o">:</span><span class="nx">camelize</span><span class="p">,</span><span class="nx">capitalize</span><span class="o">:</span><span class="nx">capitalize</span><span class="p">,</span><span class="nx">underscore</span><span class="o">:</span><span class="nx">underscore</span><span class="p">,</span><span class="nx">dasherize</span><span class="o">:</span><span class="nx">dasherize</span><span class="p">,</span><span class="nx">inspect</span><span class="o">:</span><span class="nx">inspect</span><span class="p">,</span><span class="nx">toJSON</span><span class="o">:</span><span class="nx">toJSON</span><span class="p">,</span><span class="nx">unfilterJSON</span><span class="o">:</span><span class="nx">unfilterJSON</span><span class="p">,</span><span class="nx">isJSON</span><span class="o">:</span><span class="nx">isJSON</span><span class="p">,</span><span class="nx">evalJSON</span><span class="o">:</span><span class="nx">evalJSON</span><span class="p">,</span><span class="nx">include</span><span class="o">:</span><span class="nx">include</span><span class="p">,</span><span class="nx">startsWith</span><span class="o">:</span><span class="nx">startsWith</span><span class="p">,</span><span class="nx">endsWith</span><span class="o">:</span><span class="nx">endsWith</span><span class="p">,</span><span class="nx">empty</span><span class="o">:</span><span class="nx">empty</span><span class="p">,</span><span class="nx">blank</span><span class="o">:</span><span class="nx">blank</span><span class="p">,</span><span class="nx">interpolate</span><span class="o">:</span><span class="nx">interpolate</span><span class="p">}})());</span><span class="kd">var</span> <span class="nx">Template</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">template</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">pattern</span><span class="o">=</span><span class="nx">B</span><span class="o">||</span><span class="nx">Template</span><span class="p">.</span><span class="nx">Pattern</span><span class="p">},</span><span class="nx">evaluate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">toTemplateReplacements</span><span class="p">)){</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">toTemplateReplacements</span><span class="p">()}</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">template</span><span class="p">.</span><span class="nx">gsub</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pattern</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">==</span><span class="s2">&quot;\\&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">,</span><span class="nx">G</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="sr">/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">G</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span><span class="k">return</span> <span class="nx">F</span><span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="nx">D</span><span class="o">!=</span><span class="kc">null</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">?</span><span class="nx">D</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\\\]/g</span><span class="p">,</span><span class="s2">&quot;]&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="kc">null</span><span class="o">==</span><span class="nx">B</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="o">==</span><span class="nx">D</span><span class="p">[</span><span class="mi">3</span><span class="p">]){</span><span class="k">break</span><span class="p">}</span><span class="nx">G</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="o">==</span><span class="nx">D</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">?</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="o">:</span><span class="nx">D</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">);</span><span class="nx">D</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">G</span><span class="p">)}</span><span class="k">return</span> <span class="nx">F</span><span class="o">+</span><span class="nb">String</span><span class="p">.</span><span class="nx">interpret</span><span class="p">(</span><span class="nx">B</span><span class="p">)})}});</span><span class="nx">Template</span><span class="p">.</span><span class="nx">Pattern</span><span class="o">=</span><span class="sr">/(^|.|\r|\n)(#\{(.*?)\})/</span><span class="p">;</span><span class="kd">var</span> <span class="nx">$break</span><span class="o">=</span><span class="p">{};</span><span class="kd">var</span> <span class="nx">Enumerable</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">_each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">W</span><span class="o">++</span><span class="p">)})}</span><span class="k">catch</span><span class="p">(</span><span class="nx">Z</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Z</span><span class="o">!=</span><span class="nx">$break</span><span class="p">){</span><span class="k">throw</span> <span class="nx">Z</span><span class="p">}}</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="kd">function</span> <span class="nx">R</span><span class="p">(</span><span class="nx">Z</span><span class="p">,</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=-</span><span class="nx">Z</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="p">[],</span><span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">Z</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">b</span><span class="p">}</span><span class="k">while</span><span class="p">((</span><span class="nx">W</span><span class="o">+=</span><span class="nx">Z</span><span class="p">)</span><span class="o">&lt;</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">W</span><span class="p">,</span><span class="nx">W</span><span class="o">+</span><span class="nx">Z</span><span class="p">))}</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">collect</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">Y</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="nx">W</span><span class="o">=</span><span class="nx">W</span><span class="o">&amp;&amp;!!</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">W</span><span class="p">){</span><span class="k">throw</span> <span class="nx">$break</span><span class="p">}});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">I</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">Y</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">W</span><span class="o">=!!</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">)){</span><span class="k">throw</span> <span class="nx">$break</span><span class="p">}});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">J</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">Y</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="nx">W</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">))});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">T</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="kd">var</span> <span class="nx">W</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">)){</span><span class="nx">W</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span><span class="k">throw</span> <span class="nx">$break</span><span class="p">}});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">H</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">)){</span><span class="nx">W</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">)}});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">G</span><span class="p">(</span><span class="nx">Z</span><span class="p">,</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">Y</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">Z</span><span class="p">)){</span><span class="nx">Z</span><span class="o">=</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">Z</span><span class="p">))}</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Z</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">b</span><span class="p">)){</span><span class="nx">W</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">))}});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">W</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">W</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="kc">true</span><span class="p">}}</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Y</span><span class="o">==</span><span class="nx">W</span><span class="p">){</span><span class="nx">X</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">throw</span> <span class="nx">$break</span><span class="p">}});</span><span class="k">return</span> <span class="nx">X</span><span class="p">}</span><span class="kd">function</span> <span class="nx">Q</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">W</span><span class="p">){</span><span class="nx">W</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">W</span><span class="p">)</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">W</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">eachSlice</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">){</span><span class="k">while</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">length</span><span class="o">&lt;</span><span class="nx">X</span><span class="p">){</span><span class="nx">Y</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">W</span><span class="p">)}</span><span class="k">return</span> <span class="nx">Y</span><span class="p">})}</span><span class="kd">function</span> <span class="nx">L</span><span class="p">(</span><span class="nx">W</span><span class="p">,</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="nx">W</span><span class="o">=</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">W</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">)});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">V</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="nx">$A</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">){</span><span class="k">return</span> <span class="nx">Y</span><span class="p">[</span><span class="nx">X</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">W</span><span class="p">)})}</span><span class="kd">function</span> <span class="nx">P</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">Y</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">W</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">W</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="nx">a</span><span class="o">&gt;=</span><span class="nx">W</span><span class="p">){</span><span class="nx">W</span><span class="o">=</span><span class="nx">a</span><span class="p">}});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">N</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">Y</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">W</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">W</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="nx">a</span><span class="o">&lt;</span><span class="nx">W</span><span class="p">){</span><span class="nx">W</span><span class="o">=</span><span class="nx">a</span><span class="p">}});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">E</span><span class="p">(</span><span class="nx">Z</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="nx">Z</span><span class="o">=</span><span class="nx">Z</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">Y</span><span class="o">=</span><span class="p">[],</span><span class="nx">W</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">){(</span><span class="nx">Z</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="nx">Y</span><span class="o">:</span><span class="nx">W</span><span class="p">).</span><span class="nx">push</span><span class="p">(</span><span class="nx">b</span><span class="p">)});</span><span class="k">return</span><span class="p">[</span><span class="nx">Y</span><span class="p">,</span><span class="nx">W</span><span class="p">]}</span><span class="kd">function</span> <span class="nx">F</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">){</span><span class="nx">W</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Y</span><span class="p">[</span><span class="nx">X</span><span class="p">])});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">D</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Y</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">)){</span><span class="nx">W</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">)}});</span><span class="k">return</span> <span class="nx">W</span><span class="p">}</span><span class="kd">function</span> <span class="nx">M</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">W</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Z</span><span class="p">,</span><span class="nx">Y</span><span class="p">){</span><span class="k">return</span><span class="p">{</span><span class="nx">value</span><span class="o">:</span><span class="nx">Z</span><span class="p">,</span><span class="nx">criteria</span><span class="o">:</span><span class="nx">X</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">W</span><span class="p">,</span><span class="nx">Z</span><span class="p">,</span><span class="nx">Y</span><span class="p">)}}).</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">Z</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">criteria</span><span class="p">,</span><span class="nx">Y</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">criteria</span><span class="p">;</span><span class="k">return</span> <span class="nx">Z</span><span class="o">&lt;</span><span class="nx">Y</span><span class="o">?-</span><span class="mi">1</span><span class="o">:</span><span class="nx">Z</span><span class="o">&gt;</span><span class="nx">Y</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">}).</span><span class="nx">pluck</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">O</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">()}</span><span class="kd">function</span> <span class="nx">S</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">,</span><span class="nx">W</span><span class="o">=</span><span class="nx">$A</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">W</span><span class="p">.</span><span class="nx">last</span><span class="p">())){</span><span class="nx">X</span><span class="o">=</span><span class="nx">W</span><span class="p">.</span><span class="nx">pop</span><span class="p">()}</span><span class="kd">var</span> <span class="nx">Y</span><span class="o">=</span><span class="p">[</span><span class="k">this</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">W</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">$A</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">){</span><span class="k">return</span> <span class="nx">X</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="nx">Z</span><span class="p">))})}</span><span class="kd">function</span> <span class="nx">K</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">length</span><span class="p">}</span><span class="kd">function</span> <span class="nx">U</span><span class="p">(){</span><span class="k">return</span><span class="s2">&quot;#&lt;Enumerable:&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">inspect</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&gt;&quot;</span><span class="p">}</span><span class="k">return</span><span class="p">{</span><span class="nx">each</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">eachSlice</span><span class="o">:</span><span class="nx">R</span><span class="p">,</span><span class="nx">all</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">every</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">any</span><span class="o">:</span><span class="nx">I</span><span class="p">,</span><span class="nx">some</span><span class="o">:</span><span class="nx">I</span><span class="p">,</span><span class="nx">collect</span><span class="o">:</span><span class="nx">J</span><span class="p">,</span><span class="nx">map</span><span class="o">:</span><span class="nx">J</span><span class="p">,</span><span class="nx">detect</span><span class="o">:</span><span class="nx">T</span><span class="p">,</span><span class="nx">findAll</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">select</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">filter</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">grep</span><span class="o">:</span><span class="nx">G</span><span class="p">,</span><span class="nx">include</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">member</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">inGroupsOf</span><span class="o">:</span><span class="nx">Q</span><span class="p">,</span><span class="nx">inject</span><span class="o">:</span><span class="nx">L</span><span class="p">,</span><span class="nx">invoke</span><span class="o">:</span><span class="nx">V</span><span class="p">,</span><span class="nx">max</span><span class="o">:</span><span class="nx">P</span><span class="p">,</span><span class="nx">min</span><span class="o">:</span><span class="nx">N</span><span class="p">,</span><span class="nx">partition</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">pluck</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">reject</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">sortBy</span><span class="o">:</span><span class="nx">M</span><span class="p">,</span><span class="nx">toArray</span><span class="o">:</span><span class="nx">O</span><span class="p">,</span><span class="nx">entries</span><span class="o">:</span><span class="nx">O</span><span class="p">,</span><span class="nx">zip</span><span class="o">:</span><span class="nx">S</span><span class="p">,</span><span class="nx">size</span><span class="o">:</span><span class="nx">K</span><span class="p">,</span><span class="nx">inspect</span><span class="o">:</span><span class="nx">U</span><span class="p">,</span><span class="nx">find</span><span class="o">:</span><span class="nx">T</span><span class="p">}})();</span><span class="kd">function</span> <span class="nx">$A</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="p">){</span><span class="k">return</span><span class="p">[]}</span><span class="k">if</span><span class="p">(</span><span class="s2">&quot;toArray&quot;</span> <span class="k">in</span> <span class="nb">Object</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="k">return</span> <span class="nx">C</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="o">--</span><span class="p">){</span><span class="nx">A</span><span class="p">[</span><span class="nx">B</span><span class="p">]</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="nx">B</span><span class="p">]}</span><span class="k">return</span> <span class="nx">A</span><span class="p">}</span><span class="kd">function</span> <span class="nx">$w</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="k">return</span><span class="p">[]}</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">strip</span><span class="p">();</span><span class="k">return</span> <span class="nx">A</span><span class="o">?</span><span class="nx">A</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">)</span><span class="o">:</span><span class="p">[]}</span><span class="nb">Array</span><span class="p">.</span><span class="nx">from</span><span class="o">=</span><span class="nx">$A</span><span class="p">;(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">S</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span><span class="nx">M</span><span class="o">=</span><span class="nx">S</span><span class="p">.</span><span class="nx">slice</span><span class="p">,</span><span class="nx">O</span><span class="o">=</span><span class="nx">S</span><span class="p">.</span><span class="nx">forEach</span><span class="p">;</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">W</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">V</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">X</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">V</span><span class="o">&lt;</span><span class="nx">X</span><span class="p">;</span><span class="nx">V</span><span class="o">++</span><span class="p">){</span><span class="nx">W</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">V</span><span class="p">])}}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">O</span><span class="p">){</span><span class="nx">O</span><span class="o">=</span><span class="nx">B</span><span class="p">}</span><span class="kd">function</span> <span class="nx">L</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="kd">function</span> <span class="nx">D</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span><span class="kd">function</span> <span class="nx">G</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span><span class="kd">function</span> <span class="nx">I</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">V</span><span class="p">){</span><span class="k">return</span> <span class="nx">V</span><span class="o">!=</span><span class="kc">null</span><span class="p">})}</span><span class="kd">function</span> <span class="nx">U</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">inject</span><span class="p">([],</span><span class="kd">function</span><span class="p">(</span><span class="nx">W</span><span class="p">,</span><span class="nx">V</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">V</span><span class="p">)){</span><span class="k">return</span> <span class="nx">W</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">V</span><span class="p">.</span><span class="nx">flatten</span><span class="p">())}</span><span class="nx">W</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">V</span><span class="p">);</span><span class="k">return</span> <span class="nx">W</span><span class="p">})}</span><span class="kd">function</span> <span class="nx">H</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">V</span><span class="o">=</span><span class="nx">M</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">W</span><span class="p">){</span><span class="k">return</span> <span class="o">!</span><span class="nx">V</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">W</span><span class="p">)})}</span><span class="kd">function</span> <span class="nx">F</span><span class="p">(</span><span class="nx">V</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">V</span><span class="o">!==</span><span class="kc">false</span><span class="o">?</span><span class="k">this</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()).</span><span class="nx">_reverse</span><span class="p">()}</span><span class="kd">function</span> <span class="nx">K</span><span class="p">(</span><span class="nx">V</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">inject</span><span class="p">([],</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">,</span><span class="nx">W</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="mi">0</span><span class="o">==</span><span class="nx">W</span><span class="o">||</span><span class="p">(</span><span class="nx">V</span><span class="o">?</span><span class="nx">Y</span><span class="p">.</span><span class="nx">last</span><span class="p">()</span><span class="o">!=</span><span class="nx">X</span><span class="o">:!</span><span class="nx">Y</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">X</span><span class="p">))){</span><span class="nx">Y</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">X</span><span class="p">)}</span><span class="k">return</span> <span class="nx">Y</span><span class="p">})}</span><span class="kd">function</span> <span class="nx">P</span><span class="p">(</span><span class="nx">V</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">uniq</span><span class="p">().</span><span class="nx">findAll</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">W</span><span class="p">){</span><span class="k">return</span> <span class="nx">V</span><span class="p">.</span><span class="nx">detect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="k">return</span> <span class="nx">W</span><span class="o">===</span><span class="nx">X</span><span class="p">})})}</span><span class="kd">function</span> <span class="nx">Q</span><span class="p">(){</span><span class="k">return</span> <span class="nx">M</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">J</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="kd">function</span> <span class="nx">T</span><span class="p">(){</span><span class="k">return</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">inspect</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">R</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">V</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">W</span><span class="p">){</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">(</span><span class="nx">W</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">X</span><span class="p">)){</span><span class="nx">V</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">X</span><span class="p">)}});</span><span class="k">return</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="nx">V</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">V</span><span class="p">){</span><span class="nx">V</span><span class="o">||</span><span class="p">(</span><span class="nx">V</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">V</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">V</span><span class="o">=</span><span class="nx">W</span><span class="o">+</span><span class="nx">V</span><span class="p">}</span><span class="k">for</span><span class="p">(;</span><span class="nx">V</span><span class="o">&lt;</span><span class="nx">W</span><span class="p">;</span><span class="nx">V</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">V</span><span class="p">]</span><span class="o">===</span><span class="nx">X</span><span class="p">){</span><span class="k">return</span> <span class="nx">V</span><span class="p">}}</span><span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span><span class="kd">function</span> <span class="nx">N</span><span class="p">(</span><span class="nx">W</span><span class="p">,</span><span class="nx">V</span><span class="p">){</span><span class="nx">V</span><span class="o">=</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">V</span><span class="p">)</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">:</span><span class="p">(</span><span class="nx">V</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="nx">V</span><span class="o">:</span><span class="nx">V</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">V</span><span class="p">).</span><span class="nx">reverse</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">W</span><span class="p">);</span><span class="k">return</span><span class="p">(</span><span class="nx">X</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">?</span><span class="nx">X</span><span class="o">:</span><span class="nx">V</span><span class="o">-</span><span class="nx">X</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">M</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nx">Y</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">X</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">W</span><span class="o">&lt;</span><span class="nx">X</span><span class="p">;</span><span class="nx">W</span><span class="o">++</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="nx">W</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">Y</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="p">(</span><span class="s2">&quot;callee&quot;</span> <span class="k">in</span> <span class="nx">Y</span><span class="p">)){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">V</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">Z</span><span class="o">=</span><span class="nx">Y</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">V</span><span class="o">&lt;</span><span class="nx">Z</span><span class="p">;</span><span class="nx">V</span><span class="o">++</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Y</span><span class="p">[</span><span class="nx">V</span><span class="p">])}}</span><span class="k">else</span><span class="p">{</span><span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Y</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">a</span><span class="p">}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">S</span><span class="p">,</span><span class="nx">Enumerable</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">S</span><span class="p">.</span><span class="nx">_reverse</span><span class="p">){</span><span class="nx">S</span><span class="p">.</span><span class="nx">_reverse</span><span class="o">=</span><span class="nx">S</span><span class="p">.</span><span class="nx">reverse</span><span class="p">}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">S</span><span class="p">,{</span><span class="nx">_each</span><span class="o">:</span><span class="nx">O</span><span class="p">,</span><span class="nx">clear</span><span class="o">:</span><span class="nx">L</span><span class="p">,</span><span class="nx">first</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">last</span><span class="o">:</span><span class="nx">G</span><span class="p">,</span><span class="nx">compact</span><span class="o">:</span><span class="nx">I</span><span class="p">,</span><span class="nx">flatten</span><span class="o">:</span><span class="nx">U</span><span class="p">,</span><span class="nx">without</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">reverse</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">uniq</span><span class="o">:</span><span class="nx">K</span><span class="p">,</span><span class="nx">intersect</span><span class="o">:</span><span class="nx">P</span><span class="p">,</span><span class="nx">clone</span><span class="o">:</span><span class="nx">Q</span><span class="p">,</span><span class="nx">toArray</span><span class="o">:</span><span class="nx">Q</span><span class="p">,</span><span class="nx">size</span><span class="o">:</span><span class="nx">J</span><span class="p">,</span><span class="nx">inspect</span><span class="o">:</span><span class="nx">T</span><span class="p">,</span><span class="nx">toJSON</span><span class="o">:</span><span class="nx">R</span><span class="p">});</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="p">[].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">!==</span><span class="mi">1</span><span class="p">})(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="nx">S</span><span class="p">.</span><span class="nx">concat</span><span class="o">=</span><span class="nx">C</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">S</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">){</span><span class="nx">S</span><span class="p">.</span><span class="nx">indexOf</span><span class="o">=</span><span class="nx">A</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">S</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">){</span><span class="nx">S</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="o">=</span><span class="nx">N</span><span class="p">}})();</span><span class="kd">function</span> <span class="nx">$H</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Hash</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">Hash</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Enumerable</span><span class="p">,(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">E</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isHash</span><span class="p">(</span><span class="nx">Q</span><span class="p">)</span><span class="o">?</span><span class="nx">Q</span><span class="p">.</span><span class="nx">toObject</span><span class="p">()</span><span class="o">:</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">Q</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">F</span><span class="p">(</span><span class="nx">R</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">Q</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="p">){</span><span class="kd">var</span> <span class="nx">S</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="p">[</span><span class="nx">Q</span><span class="p">],</span><span class="nx">T</span><span class="o">=</span><span class="p">[</span><span class="nx">Q</span><span class="p">,</span><span class="nx">S</span><span class="p">];</span><span class="nx">T</span><span class="p">.</span><span class="nx">key</span><span class="o">=</span><span class="nx">Q</span><span class="p">;</span><span class="nx">T</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">S</span><span class="p">;</span><span class="nx">R</span><span class="p">(</span><span class="nx">T</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">K</span><span class="p">(</span><span class="nx">Q</span><span class="p">,</span><span class="nx">R</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="p">[</span><span class="nx">Q</span><span class="p">]</span><span class="o">=</span><span class="nx">R</span><span class="p">}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="p">[</span><span class="nx">Q</span><span class="p">]</span><span class="o">!==</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">Q</span><span class="p">]){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="p">[</span><span class="nx">Q</span><span class="p">]}}</span><span class="kd">function</span> <span class="nx">N</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="kd">var</span> <span class="nx">R</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="p">[</span><span class="nx">Q</span><span class="p">];</span><span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="p">[</span><span class="nx">Q</span><span class="p">];</span><span class="k">return</span> <span class="nx">R</span><span class="p">}</span><span class="kd">function</span> <span class="nx">P</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_object</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">O</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">M</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">G</span><span class="p">(</span><span class="nx">R</span><span class="p">){</span><span class="kd">var</span> <span class="nx">Q</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">detect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">S</span><span class="p">){</span><span class="k">return</span> <span class="nx">S</span><span class="p">.</span><span class="nx">value</span><span class="o">===</span><span class="nx">R</span><span class="p">});</span><span class="k">return</span> <span class="nx">Q</span><span class="o">&amp;&amp;</span><span class="nx">Q</span><span class="p">.</span><span class="nx">key</span><span class="p">}</span><span class="kd">function</span> <span class="nx">I</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">clone</span><span class="p">().</span><span class="nx">update</span><span class="p">(</span><span class="nx">Q</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">D</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Hash</span><span class="p">(</span><span class="nx">Q</span><span class="p">).</span><span class="nx">inject</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">R</span><span class="p">,</span><span class="nx">S</span><span class="p">){</span><span class="nx">R</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">S</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span><span class="nx">S</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span><span class="k">return</span> <span class="nx">R</span><span class="p">})}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">Q</span><span class="p">,</span><span class="nx">R</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">R</span><span class="p">)){</span><span class="k">return</span> <span class="nx">Q</span><span class="p">}</span><span class="k">return</span> <span class="nx">Q</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">interpret</span><span class="p">(</span><span class="nx">R</span><span class="p">))}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">inject</span><span class="p">([],</span><span class="kd">function</span><span class="p">(</span><span class="nx">S</span><span class="p">,</span><span class="nx">T</span><span class="p">){</span><span class="kd">var</span> <span class="nx">R</span><span class="o">=</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">T</span><span class="p">.</span><span class="nx">key</span><span class="p">),</span><span class="nx">Q</span><span class="o">=</span><span class="nx">T</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Q</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">Q</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">Q</span><span class="p">)){</span><span class="k">return</span> <span class="nx">S</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">Q</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">curry</span><span class="p">(</span><span class="nx">R</span><span class="p">)))}}</span><span class="k">else</span><span class="p">{</span><span class="nx">S</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">B</span><span class="p">(</span><span class="nx">R</span><span class="p">,</span><span class="nx">Q</span><span class="p">))}</span><span class="k">return</span> <span class="nx">S</span><span class="p">}).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">L</span><span class="p">(){</span><span class="k">return</span><span class="s2">&quot;#&lt;Hash:{&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Q</span><span class="p">){</span><span class="k">return</span> <span class="nx">Q</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">inspect</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;: &quot;</span><span class="p">)}).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;}&gt;&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">J</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toObject</span><span class="p">())}</span><span class="kd">function</span> <span class="nx">H</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Hash</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="k">return</span><span class="p">{</span><span class="nx">initialize</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">_each</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">set</span><span class="o">:</span><span class="nx">K</span><span class="p">,</span><span class="nx">get</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">unset</span><span class="o">:</span><span class="nx">N</span><span class="p">,</span><span class="nx">toObject</span><span class="o">:</span><span class="nx">P</span><span class="p">,</span><span class="nx">toTemplateReplacements</span><span class="o">:</span><span class="nx">P</span><span class="p">,</span><span class="nx">keys</span><span class="o">:</span><span class="nx">O</span><span class="p">,</span><span class="nx">values</span><span class="o">:</span><span class="nx">M</span><span class="p">,</span><span class="nx">index</span><span class="o">:</span><span class="nx">G</span><span class="p">,</span><span class="nx">merge</span><span class="o">:</span><span class="nx">I</span><span class="p">,</span><span class="nx">update</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">toQueryString</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">inspect</span><span class="o">:</span><span class="nx">L</span><span class="p">,</span><span class="nx">toJSON</span><span class="o">:</span><span class="nx">J</span><span class="p">,</span><span class="nx">clone</span><span class="o">:</span><span class="nx">H</span><span class="p">}})());</span><span class="nx">Hash</span><span class="p">.</span><span class="nx">from</span><span class="o">=</span><span class="nx">$H</span><span class="p">;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">Number</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">D</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">toPaddedString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">E</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">K</span><span class="p">,</span><span class="nx">J</span><span class="p">){</span><span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="kc">true</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="nx">K</span><span class="p">,</span><span class="nx">J</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">L</span><span class="p">,</span><span class="nx">K</span><span class="p">){</span><span class="kd">var</span> <span class="nx">J</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">K</span><span class="o">||</span><span class="mi">10</span><span class="p">);</span><span class="k">return</span><span class="s2">&quot;0&quot;</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">L</span><span class="o">-</span><span class="nx">J</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">+</span><span class="nx">J</span><span class="p">}</span><span class="kd">function</span> <span class="nx">F</span><span class="p">(){</span><span class="k">return</span> <span class="nb">isFinite</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="o">:</span><span class="s2">&quot;null&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">I</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">H</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">G</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="k">return</span><span class="p">{</span><span class="nx">toColorPart</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">succ</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">times</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">toPaddedString</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">toJSON</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">abs</span><span class="o">:</span><span class="nx">I</span><span class="p">,</span><span class="nx">round</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">ceil</span><span class="o">:</span><span class="nx">G</span><span class="p">,</span><span class="nx">floor</span><span class="o">:</span><span class="nx">C</span><span class="p">}})());</span><span class="kd">function</span> <span class="nx">$R</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">ObjectRange</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">ObjectRange</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Enumerable</span><span class="p">,(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="o">=</span><span class="nx">F</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">end</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">exclusive</span><span class="o">=</span><span class="nx">E</span><span class="p">}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">E</span><span class="p">)){</span><span class="nx">D</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="nx">E</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">succ</span><span class="p">()}}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">exclusive</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">end</span><span class="p">}</span><span class="k">return</span> <span class="nx">D</span><span class="o">&lt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">end</span><span class="p">}</span><span class="k">return</span><span class="p">{</span><span class="nx">initialize</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">_each</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">include</span><span class="o">:</span><span class="nx">A</span><span class="p">}})());</span><span class="kd">var</span> <span class="nx">Ajax</span><span class="o">=</span><span class="p">{</span><span class="nx">getTransport</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">Try</span><span class="p">.</span><span class="nx">these</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">()},</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Msxml2.XMLHTTP&quot;</span><span class="p">)},</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLHTTP&quot;</span><span class="p">)})</span><span class="o">||</span><span class="kc">false</span><span class="p">},</span><span class="nx">activeRequestCount</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Responders</span><span class="o">=</span><span class="p">{</span><span class="nx">responders</span><span class="o">:</span><span class="p">[],</span><span class="nx">_each</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">responders</span><span class="p">.</span><span class="nx">_each</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">register</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">responders</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">unregister</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">responders</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">responders</span><span class="p">.</span><span class="nx">without</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">dispatch</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="nx">D</span><span class="p">])){</span><span class="k">try</span><span class="p">{</span><span class="nx">E</span><span class="p">[</span><span class="nx">D</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">E</span><span class="p">,[</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">])}</span><span class="k">catch</span><span class="p">(</span><span class="nx">F</span><span class="p">){}}})}};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Responders</span><span class="p">,</span><span class="nx">Enumerable</span><span class="p">);</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Responders</span><span class="p">.</span><span class="nx">register</span><span class="p">({</span><span class="nx">onCreate</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">activeRequestCount</span><span class="o">++</span><span class="p">},</span><span class="nx">onComplete</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">activeRequestCount</span><span class="o">--</span><span class="p">}});</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Base</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="p">{</span><span class="nx">method</span><span class="o">:</span><span class="s2">&quot;post&quot;</span><span class="p">,</span><span class="nx">asynchronous</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">contentType</span><span class="o">:</span><span class="s2">&quot;application/x-www-form-urlencoded&quot;</span><span class="p">,</span><span class="nx">encoding</span><span class="o">:</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">,</span><span class="nx">parameters</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">evalJSON</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">evalJS</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span><span class="nx">A</span><span class="o">||</span><span class="p">{});</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">method</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">method</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">toQueryParams</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isHash</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">toObject</span><span class="p">()}}}});</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">_complete</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">$super</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">$super</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="o">=</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">getTransport</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">B</span><span class="p">)},</span><span class="nx">request</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">method</span><span class="p">;</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span><span class="s2">&quot;post&quot;</span><span class="p">].</span><span class="nx">include</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="p">)){</span><span class="nx">D</span><span class="p">.</span><span class="nx">_method</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="o">=</span><span class="s2">&quot;post&quot;</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">parameters</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toQueryString</span><span class="p">(</span><span class="nx">D</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="o">==</span><span class="s2">&quot;get&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="o">+=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;&amp;&quot;</span><span class="o">:</span><span class="s2">&quot;?&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">D</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="sr">/Konqueror|Safari|KHTML/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">)){</span><span class="nx">D</span><span class="o">+=</span><span class="s2">&quot;&amp;_=&quot;</span><span class="p">}}}</span><span class="k">try</span><span class="p">{</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Response</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onCreate</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onCreate</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Responders</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&quot;onCreate&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">(),</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">asynchronous</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">asynchronous</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">respondToReadyState</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">defer</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">onStateChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">setRequestHeaders</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">body</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="o">==</span><span class="s2">&quot;post&quot;</span><span class="o">?</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">postBody</span><span class="o">||</span><span class="nx">D</span><span class="p">)</span><span class="o">:</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">asynchronous</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">overrideMimeType</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">onStateChange</span><span class="p">()}}</span><span class="k">catch</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dispatchException</span><span class="p">(</span><span class="nx">C</span><span class="p">)}},</span><span class="nx">onStateChange</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">readyState</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&amp;&amp;!</span><span class="p">((</span><span class="nx">A</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">_complete</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">respondToReadyState</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">readyState</span><span class="p">)}},</span><span class="nx">setRequestHeaders</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X-Requested-With&quot;</span><span class="o">:</span><span class="s2">&quot;XMLHttpRequest&quot;</span><span class="p">,</span><span class="s2">&quot;X-Prototype-Version&quot;</span><span class="o">:</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Version</span><span class="p">,</span><span class="nx">Accept</span><span class="o">:</span><span class="s2">&quot;text/javascript, text/html, application/xml, text/xml, */*&quot;</span><span class="p">};</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="o">==</span><span class="s2">&quot;post&quot;</span><span class="p">){</span><span class="nx">E</span><span class="p">[</span><span class="s2">&quot;Content-type&quot;</span><span class="p">]</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">contentType</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">encoding</span><span class="o">?</span><span class="s2">&quot;; charset=&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">encoding</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">overrideMimeType</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/Gecko\/(\d{4})/</span><span class="p">)</span><span class="o">||</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2005</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">2005</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">Connection</span><span class="o">=</span><span class="s2">&quot;close&quot;</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">requestHeaders</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">requestHeaders</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">)){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">B</span><span class="o">&lt;</span><span class="nx">D</span><span class="p">;</span><span class="nx">B</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="nx">E</span><span class="p">[</span><span class="nx">C</span><span class="p">[</span><span class="nx">B</span><span class="p">]]</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="nx">B</span><span class="o">+</span><span class="mi">1</span><span class="p">]}}</span><span class="k">else</span><span class="p">{</span><span class="nx">$H</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">E</span><span class="p">[</span><span class="nx">F</span><span class="p">.</span><span class="nx">key</span><span class="p">]</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">value</span><span class="p">})}}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">A</span> <span class="k">in</span> <span class="nx">E</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">E</span><span class="p">[</span><span class="nx">A</span><span class="p">])}},</span><span class="nx">success</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">();</span><span class="k">return</span> <span class="o">!</span><span class="nx">A</span><span class="o">||</span><span class="p">(</span><span class="nx">A</span><span class="o">&gt;=</span><span class="mi">200</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="o">&lt;</span><span class="mi">300</span><span class="p">)},</span><span class="nx">getStatus</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">status</span><span class="o">||</span><span class="mi">0</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="mi">0</span><span class="p">}},</span><span class="nx">respondToReadyState</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">.</span><span class="nx">Events</span><span class="p">[</span><span class="nx">A</span><span class="p">],</span><span class="nx">B</span><span class="o">=</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Response</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;Complete&quot;</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">_complete</span><span class="o">=</span><span class="kc">true</span><span class="p">;(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">status</span><span class="p">]</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">success</span><span class="p">()</span><span class="o">?</span><span class="s2">&quot;Success&quot;</span><span class="o">:</span><span class="s2">&quot;Failure&quot;</span><span class="p">)]</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">)(</span><span class="nx">B</span><span class="p">,</span><span class="nx">B</span><span class="p">.</span><span class="nx">headerJSON</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dispatchException</span><span class="p">(</span><span class="nx">D</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getHeader</span><span class="p">(</span><span class="s2">&quot;Content-type&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">evalJS</span><span class="o">==</span><span class="s2">&quot;force&quot;</span><span class="o">||</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">evalJS</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">isSameOrigin</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="nx">E</span><span class="o">&amp;&amp;</span><span class="nx">E</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i</span><span class="p">))){</span><span class="k">this</span><span class="p">.</span><span class="nx">evalResponse</span><span class="p">()}}</span><span class="k">try</span><span class="p">{(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">C</span><span class="p">]</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">)(</span><span class="nx">B</span><span class="p">,</span><span class="nx">B</span><span class="p">.</span><span class="nx">headerJSON</span><span class="p">);</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Responders</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">C</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">B</span><span class="p">.</span><span class="nx">headerJSON</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dispatchException</span><span class="p">(</span><span class="nx">D</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;Complete&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">}},</span><span class="nx">isSameOrigin</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^\s*https?:\/\/[^\/]*/</span><span class="p">);</span><span class="k">return</span> <span class="o">!</span><span class="nx">A</span><span class="o">||</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;#{protocol}//#{domain}#{port}&quot;</span><span class="p">.</span><span class="nx">interpolate</span><span class="p">({</span><span class="nx">protocol</span><span class="o">:</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span><span class="p">,</span><span class="nx">domain</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">domain</span><span class="p">,</span><span class="nx">port</span><span class="o">:</span><span class="nx">location</span><span class="p">.</span><span class="nx">port</span><span class="o">?</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="nx">location</span><span class="p">.</span><span class="nx">port</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">}))},</span><span class="nx">getHeader</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span><span class="o">||</span><span class="kc">null</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}},</span><span class="nx">evalResponse</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="nb">eval</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">responseText</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">unfilterJSON</span><span class="p">())}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dispatchException</span><span class="p">(</span><span class="nx">e</span><span class="p">)}},</span><span class="nx">dispatchException</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onException</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">)(</span><span class="k">this</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Responders</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&quot;onException&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="nx">A</span><span class="p">)}});</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">.</span><span class="nx">Events</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Uninitialized&quot;</span><span class="p">,</span><span class="s2">&quot;Loading&quot;</span><span class="p">,</span><span class="s2">&quot;Loaded&quot;</span><span class="p">,</span><span class="s2">&quot;Interactive&quot;</span><span class="p">,</span><span class="s2">&quot;Complete&quot;</span><span class="p">];</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Response</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">transport</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">readyState</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">readyState</span><span class="p">;</span><span class="k">if</span><span class="p">((</span><span class="nx">A</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&amp;&amp;!</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">)</span><span class="o">||</span><span class="nx">A</span><span class="o">==</span><span class="mi">4</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">statusText</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getStatusText</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="o">=</span><span class="nb">String</span><span class="p">.</span><span class="nx">interpret</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">headerJSON</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_getHeaderJSON</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">==</span><span class="mi">4</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">responseXML</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">B</span><span class="p">)</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">responseJSON</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_getResponseJSON</span><span class="p">()}},</span><span class="nx">status</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">statusText</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">getStatus</span><span class="o">:</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">,</span><span class="nx">getStatusText</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">statusText</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;&quot;</span><span class="p">}},</span><span class="nx">getHeader</span><span class="o">:</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getHeader</span><span class="p">,</span><span class="nx">getAllHeaders</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAllResponseHeaders</span><span class="p">()}</span><span class="k">catch</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}},</span><span class="nx">getResponseHeader</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">getAllResponseHeaders</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">transport</span><span class="p">.</span><span class="nx">getAllResponseHeaders</span><span class="p">()},</span><span class="nx">_getHeaderJSON</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getHeader</span><span class="p">(</span><span class="s2">&quot;X-JSON&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="nx">A</span><span class="o">=</span><span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">escape</span><span class="p">(</span><span class="nx">A</span><span class="p">));</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">evalJSON</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">sanitizeJSON</span><span class="o">||!</span><span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">isSameOrigin</span><span class="p">())}</span><span class="k">catch</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">dispatchException</span><span class="p">(</span><span class="nx">B</span><span class="p">)}},</span><span class="nx">_getResponseJSON</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">.</span><span class="nx">evalJSON</span><span class="o">||</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">evalJSON</span><span class="o">!=</span><span class="s2">&quot;force&quot;</span><span class="o">&amp;&amp;!</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getHeader</span><span class="p">(</span><span class="s2">&quot;Content-type&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;application/json&quot;</span><span class="p">))</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">.</span><span class="nx">blank</span><span class="p">()){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">.</span><span class="nx">evalJSON</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">sanitizeJSON</span><span class="o">||!</span><span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">isSameOrigin</span><span class="p">())}</span><span class="k">catch</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">dispatchException</span><span class="p">(</span><span class="nx">B</span><span class="p">)}}});</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Updater</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">$super</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="o">=</span><span class="p">{</span><span class="nx">success</span><span class="o">:</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">success</span><span class="o">||</span><span class="nx">A</span><span class="p">),</span><span class="nx">failure</span><span class="o">:</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">failure</span><span class="o">||</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">success</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">A</span><span class="p">))};</span><span class="nx">B</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">onComplete</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">updateContent</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">D</span><span class="p">)){</span><span class="nx">D</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">F</span><span class="p">)}}).</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">$super</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">)},</span><span class="nx">updateContent</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">success</span><span class="p">()</span><span class="o">?</span><span class="s2">&quot;success&quot;</span><span class="o">:</span><span class="s2">&quot;failure&quot;</span><span class="p">],</span><span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">.</span><span class="nx">evalScripts</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">stripScripts</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">insertion</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">insertion</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">{};</span><span class="nx">B</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">insertion</span><span class="p">]</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="nx">C</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">B</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">A</span><span class="p">.</span><span class="nx">insertion</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">)}}</span><span class="k">else</span><span class="p">{</span><span class="nx">C</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}}});</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">PeriodicalUpdater</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">$super</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">$super</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="o">=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">frequency</span><span class="o">||</span><span class="mi">2</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">decay</span><span class="o">=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">decay</span><span class="o">||</span><span class="mi">1</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">updater</span><span class="o">=</span><span class="p">{};</span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">()},</span><span class="nx">start</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onComplete</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">updateComplete</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">onTimerEvent</span><span class="p">()},</span><span class="nx">stop</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">updater</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onComplete</span><span class="o">=</span><span class="kc">undefined</span><span class="p">;</span><span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">);(</span><span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">).</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)},</span><span class="nx">updateComplete</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">decay</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">decay</span><span class="o">=</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">responseText</span><span class="o">==</span><span class="k">this</span><span class="p">.</span><span class="nx">lastText</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">decay</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">decay</span><span class="o">:</span><span class="mi">1</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">lastText</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">responseText</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">onTimerEvent</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">delay</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">decay</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="p">)},</span><span class="nx">onTimerEvent</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">updater</span><span class="o">=</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Updater</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">)}});</span><span class="kd">function</span> <span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="p">[],</span><span class="nx">C</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">A</span><span class="o">&lt;</span><span class="nx">C</span><span class="p">;</span><span class="nx">A</span><span class="o">++</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="nx">A</span><span class="p">]))}</span><span class="k">return</span> <span class="nx">D</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">B</span><span class="p">)){</span><span class="nx">B</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">B</span><span class="p">)}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">B</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">XPath</span><span class="p">){</span><span class="nb">document</span><span class="p">.</span><span class="nx">_getElementsByXPath</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="p">[];</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span><span class="o">||</span><span class="nb">document</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="nx">XPathResult</span><span class="p">.</span><span class="nx">ORDERED_NODE_SNAPSHOT_TYPE</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">snapshotLength</span><span class="p">;</span><span class="nx">B</span><span class="o">&lt;</span><span class="nx">D</span><span class="p">;</span><span class="nx">B</span><span class="o">++</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">snapshotItem</span><span class="p">(</span><span class="nx">B</span><span class="p">)))}</span><span class="k">return</span> <span class="nx">C</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">Node</span><span class="p">){</span><span class="kd">var</span> <span class="nx">Node</span><span class="o">=</span><span class="p">{}}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Node</span><span class="p">.</span><span class="nx">ELEMENT_NODE</span><span class="p">){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Node</span><span class="p">,{</span><span class="nx">ELEMENT_NODE</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">ATTRIBUTE_NODE</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">TEXT_NODE</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">CDATA_SECTION_NODE</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span><span class="nx">ENTITY_REFERENCE_NODE</span><span class="o">:</span><span class="mi">5</span><span class="p">,</span><span class="nx">ENTITY_NODE</span><span class="o">:</span><span class="mi">6</span><span class="p">,</span><span class="nx">PROCESSING_INSTRUCTION_NODE</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="nx">COMMENT_NODE</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="nx">DOCUMENT_NODE</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="nx">DOCUMENT_TYPE_NODE</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="nx">DOCUMENT_FRAGMENT_NODE</span><span class="o">:</span><span class="mi">11</span><span class="p">,</span><span class="nx">NOTATION_NODE</span><span class="o">:</span><span class="mi">12</span><span class="p">})}(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;form&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span><span class="nx">E</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="s2">&quot;test&quot;</span><span class="p">);</span><span class="nx">F</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="nx">D</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">F</span><span class="p">);</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">elements</span><span class="o">?</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">F</span><span class="p">.</span><span class="nx">elements</span><span class="p">.</span><span class="nx">test</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">)</span><span class="o">:</span><span class="kc">null</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">F</span><span class="p">);</span><span class="nx">F</span><span class="o">=</span><span class="nx">E</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">G</span><span class="p">})();</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">Element</span><span class="p">;</span><span class="nx">C</span><span class="p">.</span><span class="nx">Element</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="nx">E</span><span class="o">||</span><span class="p">{};</span><span class="nx">F</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cache</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">&amp;&amp;</span><span class="nx">E</span><span class="p">.</span><span class="nx">name</span><span class="p">){</span><span class="nx">F</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="o">+</span><span class="nx">F</span><span class="o">+</span><span class="s1">&#39; name=&quot;&#39;</span><span class="o">+</span><span class="nx">E</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">;</span><span class="k">delete</span> <span class="nx">E</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">writeAttribute</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">F</span><span class="p">),</span><span class="nx">E</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="p">[</span><span class="nx">F</span><span class="p">]){</span><span class="nx">D</span><span class="p">[</span><span class="nx">F</span><span class="p">]</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">F</span><span class="p">))}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">writeAttribute</span><span class="p">(</span><span class="nx">D</span><span class="p">[</span><span class="nx">F</span><span class="p">].</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">false</span><span class="p">),</span><span class="nx">E</span><span class="p">)};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">Element</span><span class="p">,</span><span class="nx">A</span><span class="o">||</span><span class="p">{});</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">prototype</span><span class="p">}})(</span><span class="k">this</span><span class="p">);</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cache</span><span class="o">=</span><span class="p">{};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">idCounter</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="o">=</span><span class="p">{</span><span class="nx">visible</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">!=</span><span class="s2">&quot;none&quot;</span><span class="p">},</span><span class="nx">toggle</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">Element</span><span class="p">[</span><span class="nx">Element</span><span class="p">.</span><span class="nx">visible</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;hide&quot;</span><span class="o">:</span><span class="s2">&quot;show&quot;</span><span class="p">](</span><span class="nx">A</span><span class="p">);</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">hide</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">show</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">remove</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">update</span><span class="o">:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;select&quot;</span><span class="p">),</span><span class="nx">F</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="nx">E</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s1">&#39;&lt;option value=&quot;test&quot;&gt;test&lt;/option&gt;&#39;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">options</span><span class="o">&amp;&amp;</span><span class="nx">E</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]){</span><span class="nx">F</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">!==</span><span class="s2">&quot;OPTION&quot;</span><span class="p">}</span><span class="nx">E</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">F</span><span class="p">})();</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">&amp;&amp;</span><span class="nx">E</span><span class="p">.</span><span class="nx">tBodies</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;test&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">E</span><span class="p">.</span><span class="nx">tBodies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">G</span><span class="p">}}</span><span class="k">catch</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="k">return</span> <span class="kc">true</span><span class="p">}})();</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">),</span><span class="nx">G</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="nx">E</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">));</span><span class="nx">G</span><span class="o">=!</span><span class="nx">E</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">||</span><span class="nx">E</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">&amp;&amp;</span><span class="nx">E</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">3</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">G</span><span class="o">=</span><span class="kc">true</span><span class="p">}</span><span class="nx">E</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">G</span><span class="p">})();</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">G</span><span class="p">){</span><span class="nx">F</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">F</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="o">&amp;&amp;</span><span class="nx">G</span><span class="p">.</span><span class="nx">toElement</span><span class="p">){</span><span class="nx">G</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">toElement</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">G</span><span class="p">)){</span><span class="k">return</span> <span class="nx">F</span><span class="p">.</span><span class="nx">update</span><span class="p">().</span><span class="nx">insert</span><span class="p">(</span><span class="nx">G</span><span class="p">)}</span><span class="nx">G</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toHTML</span><span class="p">(</span><span class="nx">G</span><span class="p">);</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">===</span><span class="s2">&quot;SCRIPT&quot;</span><span class="o">&amp;&amp;</span><span class="nx">D</span><span class="p">){</span><span class="nx">F</span><span class="p">.</span><span class="nx">text</span><span class="o">=</span><span class="nx">G</span><span class="p">;</span><span class="k">return</span> <span class="nx">F</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">||</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span> <span class="k">in</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_insertionTranslations</span><span class="p">.</span><span class="nx">tags</span><span class="p">){</span><span class="k">while</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">){</span><span class="nx">F</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)}</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_getContentFromAnonymousElement</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">G</span><span class="p">.</span><span class="nx">stripScripts</span><span class="p">()).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">H</span><span class="p">){</span><span class="nx">F</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">H</span><span class="p">)})}</span><span class="k">else</span><span class="p">{</span><span class="nx">F</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">stripScripts</span><span class="p">()}}</span><span class="k">else</span><span class="p">{</span><span class="nx">F</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">stripScripts</span><span class="p">()}</span><span class="nx">G</span><span class="p">.</span><span class="nx">evalScripts</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">G</span><span class="p">).</span><span class="nx">defer</span><span class="p">();</span><span class="k">return</span> <span class="nx">F</span><span class="p">}</span><span class="k">return</span> <span class="nx">C</span><span class="p">})(),</span><span class="nx">replace</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">&amp;&amp;</span><span class="nx">C</span><span class="p">.</span><span class="nx">toElement</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">toElement</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="nx">C</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toHTML</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">createRange</span><span class="p">();</span><span class="nx">A</span><span class="p">.</span><span class="nx">selectNode</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="nx">C</span><span class="p">.</span><span class="nx">evalScripts</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">defer</span><span class="p">();</span><span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">createContextualFragment</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">stripScripts</span><span class="p">())}}</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">replaceChild</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">insert</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">E</span><span class="p">)</span><span class="o">||</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">E</span><span class="p">)</span><span class="o">||</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">E</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">E</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">toElement</span><span class="o">||</span><span class="nx">E</span><span class="p">.</span><span class="nx">toHTML</span><span class="p">))){</span><span class="nx">E</span><span class="o">=</span><span class="p">{</span><span class="nx">bottom</span><span class="o">:</span><span class="nx">E</span><span class="p">}}</span><span class="kd">var</span> <span class="nx">D</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">G</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">A</span> <span class="k">in</span> <span class="nx">E</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">E</span><span class="p">[</span><span class="nx">A</span><span class="p">];</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="nx">F</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_insertionTranslations</span><span class="p">[</span><span class="nx">A</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">&amp;&amp;</span><span class="nx">D</span><span class="p">.</span><span class="nx">toElement</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">toElement</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">D</span><span class="p">)){</span><span class="nx">F</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">);</span><span class="k">continue</span><span class="p">}</span><span class="nx">D</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toHTML</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="nx">B</span><span class="o">=</span><span class="p">((</span><span class="nx">A</span><span class="o">==</span><span class="s2">&quot;before&quot;</span><span class="o">||</span><span class="nx">A</span><span class="o">==</span><span class="s2">&quot;after&quot;</span><span class="p">)</span><span class="o">?</span><span class="nx">C</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">:</span><span class="nx">C</span><span class="p">).</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="nx">G</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_getContentFromAnonymousElement</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">.</span><span class="nx">stripScripts</span><span class="p">());</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">==</span><span class="s2">&quot;top&quot;</span><span class="o">||</span><span class="nx">A</span><span class="o">==</span><span class="s2">&quot;after&quot;</span><span class="p">){</span><span class="nx">G</span><span class="p">.</span><span class="nx">reverse</span><span class="p">()}</span><span class="nx">G</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">curry</span><span class="p">(</span><span class="nx">C</span><span class="p">));</span><span class="nx">D</span><span class="p">.</span><span class="nx">evalScripts</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">D</span><span class="p">).</span><span class="nx">defer</span><span class="p">()}</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="nx">wrap</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">writeAttribute</span><span class="p">(</span><span class="nx">A</span><span class="o">||</span><span class="p">{})}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="nx">C</span><span class="o">=</span><span class="k">new</span> <span class="nx">Element</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">C</span><span class="o">=</span><span class="k">new</span> <span class="nx">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span><span class="nx">C</span><span class="p">)}}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">replaceChild</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">)}</span><span class="nx">C</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="nx">inspect</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="nx">$H</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="nx">className</span><span class="o">:</span><span class="s2">&quot;class&quot;</span><span class="p">}).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">first</span><span class="p">(),</span><span class="nx">C</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">last</span><span class="p">();</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">(</span><span class="nx">B</span><span class="p">[</span><span class="nx">E</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">A</span><span class="o">+=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">+</span><span class="nx">D</span><span class="p">.</span><span class="nx">inspect</span><span class="p">(</span><span class="kc">true</span><span class="p">)}});</span><span class="k">return</span> <span class="nx">A</span><span class="o">+</span><span class="s2">&quot;&gt;&quot;</span><span class="p">},</span><span class="nx">recursivelyCollect</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">[];</span><span class="k">while</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">C</span><span class="p">]){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">))}}</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">ancestors</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">recursivelyCollect</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;parentNode&quot;</span><span class="p">)},</span><span class="nx">descendants</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">)},</span><span class="nx">firstDescendant</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">firstChild</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!=</span><span class="mi">1</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">}</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">immediateDescendants</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">firstChild</span><span class="p">)){</span><span class="k">return</span><span class="p">[]}</span><span class="k">while</span><span class="p">(</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!=</span><span class="mi">1</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">[</span><span class="nx">A</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">nextSiblings</span><span class="p">())}</span><span class="k">return</span><span class="p">[]},</span><span class="nx">previousSiblings</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">recursivelyCollect</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;previousSibling&quot;</span><span class="p">)},</span><span class="nx">nextSiblings</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">recursivelyCollect</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;nextSibling&quot;</span><span class="p">)},</span><span class="nx">siblings</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">previousSiblings</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">reverse</span><span class="p">().</span><span class="nx">concat</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">nextSiblings</span><span class="p">(</span><span class="nx">A</span><span class="p">))},</span><span class="nx">match</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="nx">A</span><span class="o">=</span><span class="k">new</span> <span class="nx">Selector</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">))},</span><span class="nx">up</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">ancestors</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">?</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">:</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">findElement</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">down</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">firstDescendant</span><span class="p">(</span><span class="nx">B</span><span class="p">)}</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">C</span><span class="p">)</span><span class="o">?</span><span class="nx">Element</span><span class="p">.</span><span class="nx">descendants</span><span class="p">(</span><span class="nx">B</span><span class="p">)[</span><span class="nx">C</span><span class="p">]</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">)[</span><span class="nx">A</span><span class="o">||</span><span class="mi">0</span><span class="p">]},</span><span class="nx">previous</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">previousElementSibling</span><span class="p">(</span><span class="nx">B</span><span class="p">))}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">previousSiblings</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">?</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">:</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">findElement</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">next</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">nextElementSibling</span><span class="p">(</span><span class="nx">C</span><span class="p">))}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">nextSiblings</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">?</span><span class="nx">A</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">:</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">findElement</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">B</span><span class="p">)},</span><span class="nx">select</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">findChildElements</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">adjacent</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">findChildElements</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">A</span><span class="p">).</span><span class="nx">without</span><span class="p">(</span><span class="nx">B</span><span class="p">)},</span><span class="nx">identify</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">readAttribute</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">}</span><span class="k">do</span><span class="p">{</span><span class="nx">B</span><span class="o">=</span><span class="s2">&quot;anonymous_element_&quot;</span><span class="o">+</span><span class="nx">Element</span><span class="p">.</span><span class="nx">idCounter</span><span class="o">++</span><span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">));</span><span class="nx">Element</span><span class="p">.</span><span class="nx">writeAttribute</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">readAttribute</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">read</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="p">]){</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="p">](</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">names</span><span class="p">[</span><span class="nx">A</span><span class="p">]){</span><span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">names</span><span class="p">[</span><span class="nx">A</span><span class="p">]}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)){</span><span class="k">return</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="p">.</span><span class="nx">attributes</span><span class="o">||!</span><span class="nx">C</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">A</span><span class="p">])</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">A</span><span class="p">].</span><span class="nx">value</span><span class="p">}}</span><span class="k">return</span> <span class="nx">C</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">writeAttribute</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">{},</span><span class="nx">D</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">write</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">C</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">]</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">F</span><span class="p">)</span><span class="o">?</span><span class="kc">true</span><span class="o">:</span><span class="nx">F</span><span class="p">}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">A</span> <span class="k">in</span> <span class="nx">B</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">names</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">||</span><span class="nx">A</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">A</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="p">]){</span><span class="nx">C</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="p">](</span><span class="nx">E</span><span class="p">,</span><span class="nx">F</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">===</span><span class="kc">false</span><span class="o">||</span><span class="nx">F</span><span class="o">===</span><span class="kc">null</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="nx">C</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">===</span><span class="kc">true</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">C</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">E</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">F</span><span class="p">)}}}</span><span class="k">return</span> <span class="nx">E</span><span class="p">},</span><span class="nx">getHeight</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">getDimensions</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">height</span><span class="p">},</span><span class="nx">getWidth</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">getDimensions</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">width</span><span class="p">},</span><span class="nx">classNames</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">ClassNames</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">hasClassName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">))){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">className</span><span class="p">;</span><span class="k">return</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="nx">B</span><span class="o">||</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;(^|\\s)&quot;</span><span class="o">+</span><span class="nx">B</span><span class="o">+</span><span class="s2">&quot;(\\s|$)&quot;</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">C</span><span class="p">)))},</span><span class="nx">addClassName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">))){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Element</span><span class="p">.</span><span class="nx">hasClassName</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">)){</span><span class="nx">A</span><span class="p">.</span><span class="nx">className</span><span class="o">+=</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">className</span><span class="o">?</span><span class="s2">&quot; &quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">B</span><span class="p">}</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">removeClassName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">))){</span><span class="k">return</span> <span class="p">}</span><span class="nx">A</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;(^|\\s+)&quot;</span><span class="o">+</span><span class="nx">B</span><span class="o">+</span><span class="s2">&quot;(\\s+|$)&quot;</span><span class="p">),</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">strip</span><span class="p">();</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">toggleClassName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">))){</span><span class="k">return</span> <span class="p">}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">[</span><span class="nx">Element</span><span class="p">.</span><span class="nx">hasClassName</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;removeClassName&quot;</span><span class="o">:</span><span class="s2">&quot;addClassName&quot;</span><span class="p">](</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">)},</span><span class="nx">cleanWhitespace</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">3</span><span class="o">&amp;&amp;!</span><span class="sr">/\S/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">C</span><span class="p">)}</span><span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">}</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">empty</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">blank</span><span class="p">()},</span><span class="nx">descendantOf</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">8</span><span class="p">)</span><span class="o">===</span><span class="mi">8</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">contains</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">B</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="o">!==</span><span class="nx">B</span><span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="kc">true</span><span class="p">}}</span><span class="k">return</span> <span class="kc">false</span><span class="p">},</span><span class="nx">scrollTo</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nb">window</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">getStyle</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="nx">C</span><span class="o">=</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;float&quot;</span><span class="o">?</span><span class="s2">&quot;cssFloat&quot;</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">camelize</span><span class="p">();</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="o">||</span><span class="nx">D</span><span class="o">==</span><span class="s2">&quot;auto&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">defaultView</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="o">?</span><span class="nx">A</span><span class="p">[</span><span class="nx">C</span><span class="p">]</span><span class="o">:</span><span class="kc">null</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;opacity&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="o">?</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">:</span><span class="mi">1</span><span class="p">}</span><span class="k">return</span> <span class="nx">D</span><span class="o">==</span><span class="s2">&quot;auto&quot;</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">D</span><span class="p">},</span><span class="nx">getOpacity</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">)},</span><span class="nx">setStyle</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">,</span><span class="nx">A</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span><span class="o">+=</span><span class="s2">&quot;;&quot;</span><span class="o">+</span><span class="nx">C</span><span class="p">;</span><span class="k">return</span> <span class="nx">C</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">)</span><span class="o">?</span><span class="nx">B</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/opacity:\s*(\d?\.?\d*)/</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">:</span><span class="nx">B</span><span class="p">}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span> <span class="k">in</span> <span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">==</span><span class="s2">&quot;opacity&quot;</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">])}</span><span class="k">else</span><span class="p">{</span><span class="nx">E</span><span class="p">[(</span><span class="nx">D</span><span class="o">==</span><span class="s2">&quot;float&quot;</span><span class="o">||</span><span class="nx">D</span><span class="o">==</span><span class="s2">&quot;cssFloat&quot;</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">styleFloat</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;cssFloat&quot;</span><span class="o">:</span><span class="s2">&quot;styleFloat&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">D</span><span class="p">]</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">]}}</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">setOpacity</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="mi">1</span><span class="o">||</span><span class="nx">B</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="o">&lt;</span><span class="mf">0.00001</span><span class="p">)</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="nx">B</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">getDimensions</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="s2">&quot;display&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="o">!=</span><span class="s2">&quot;none&quot;</span><span class="o">&amp;&amp;</span><span class="nx">G</span><span class="o">!=</span><span class="kc">null</span><span class="p">){</span><span class="k">return</span><span class="p">{</span><span class="nx">width</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">,</span><span class="nx">height</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">}}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">;</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">visibility</span><span class="p">;</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">display</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">visibility</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">!=</span><span class="s2">&quot;fixed&quot;</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="s2">&quot;absolute&quot;</span><span class="p">}</span><span class="nx">B</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;block&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">;</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">visibility</span><span class="o">=</span><span class="nx">F</span><span class="p">;</span><span class="k">return</span><span class="p">{</span><span class="nx">width</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">height</span><span class="o">:</span><span class="nx">E</span><span class="p">}},</span><span class="nx">makePositioned</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;static&quot;</span><span class="o">||!</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">_madePositioned</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">Opera</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="mi">0</span><span class="p">}}</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">undoPositioned</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">_madePositioned</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">_madePositioned</span><span class="o">=</span><span class="kc">undefined</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">bottom</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">right</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">}</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">makeClipping</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">_overflow</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}</span><span class="nx">A</span><span class="p">.</span><span class="nx">_overflow</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;overflow&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;auto&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">_overflow</span><span class="o">!==</span><span class="s2">&quot;hidden&quot;</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflow</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span><span class="p">}</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">undoClipping</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">.</span><span class="nx">_overflow</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflow</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">_overflow</span><span class="o">==</span><span class="s2">&quot;auto&quot;</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_overflow</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">_overflow</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">cumulativeOffset</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="nx">A</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">C</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">positionedOffset</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="nx">A</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">D</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;BODY&quot;</span><span class="p">){</span><span class="k">break</span><span class="p">}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">!==</span><span class="s2">&quot;static&quot;</span><span class="p">){</span><span class="k">break</span><span class="p">}}}</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">absolutize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">positionedOffset</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">_originalLeft</span><span class="o">=</span><span class="nx">E</span><span class="o">-</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">||</span><span class="mi">0</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">_originalTop</span><span class="o">=</span><span class="nx">F</span><span class="o">-</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">||</span><span class="mi">0</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">_originalWidth</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">_originalHeight</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="s2">&quot;absolute&quot;</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="nx">F</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">E</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="o">=</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">relativize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;relative&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">||</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">_originalTop</span><span class="o">||</span><span class="mi">0</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">||</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">_originalLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">B</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">_originalHeight</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">_originalWidth</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">cumulativeScrollOffset</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="nx">A</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">C</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">getOffsetParent</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">==</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="k">while</span><span class="p">((</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="o">!=</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">!=</span><span class="s2">&quot;static&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)},</span><span class="nx">viewportOffset</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="nx">A</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">C</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetParent</span><span class="o">==</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="o">&amp;&amp;</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">){</span><span class="k">break</span><span class="p">}}</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">);</span><span class="nx">B</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">Opera</span><span class="o">||</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">tagName</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;BODY&quot;</span><span class="p">))){</span><span class="nx">A</span><span class="o">-=</span><span class="nx">B</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">C</span><span class="o">-=</span><span class="nx">B</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">}}</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">);</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">clonePosition</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">setLeft</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">setTop</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">setWidth</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">setHeight</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">offsetTop</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">offsetLeft</span><span class="o">:</span><span class="mi">0</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="nx">D</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">viewportOffset</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getOffsetParent</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="nx">F</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">viewportOffset</span><span class="p">(</span><span class="nx">C</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">){</span><span class="nx">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-=</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-=</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">setLeft</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">setTop</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">setWidth</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">setHeight</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">return</span> <span class="nx">B</span><span class="p">}};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">,{</span><span class="nx">getElementsBySelector</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">select</span><span class="p">,</span><span class="nx">childElements</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">immediateDescendants</span><span class="p">});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="o">=</span><span class="p">{</span><span class="nx">write</span><span class="o">:</span><span class="p">{</span><span class="nx">names</span><span class="o">:</span><span class="p">{</span><span class="nx">className</span><span class="o">:</span><span class="s2">&quot;class&quot;</span><span class="p">,</span><span class="nx">htmlFor</span><span class="o">:</span><span class="s2">&quot;for&quot;</span><span class="p">},</span><span class="nx">values</span><span class="o">:</span><span class="p">{}}};</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">Opera</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">getStyle</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">switch</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;left&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;top&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;right&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;bottom&quot;</span><span class="o">:</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;static&quot;</span><span class="p">){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="k">case</span><span class="s2">&quot;height&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;width&quot;</span><span class="o">:</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Element</span><span class="p">.</span><span class="nx">visible</span><span class="p">(</span><span class="nx">B</span><span class="p">)){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">D</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">),</span><span class="mi">10</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">!==</span><span class="nx">B</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="o">+</span><span class="nx">C</span><span class="p">.</span><span class="nx">capitalize</span><span class="p">()]){</span><span class="k">return</span> <span class="nx">E</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="kd">var</span> <span class="nx">A</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">===</span><span class="s2">&quot;height&quot;</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;border-top-width&quot;</span><span class="p">,</span><span class="s2">&quot;padding-top&quot;</span><span class="p">,</span><span class="s2">&quot;padding-bottom&quot;</span><span class="p">,</span><span class="s2">&quot;border-bottom-width&quot;</span><span class="p">]}</span><span class="k">else</span><span class="p">{</span><span class="nx">A</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;border-left-width&quot;</span><span class="p">,</span><span class="s2">&quot;padding-left&quot;</span><span class="p">,</span><span class="s2">&quot;padding-right&quot;</span><span class="p">,</span><span class="s2">&quot;border-right-width&quot;</span><span class="p">]}</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">inject</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">G</span><span class="p">){</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="nx">D</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">G</span><span class="p">);</span><span class="k">return</span> <span class="nx">H</span><span class="o">===</span><span class="kc">null</span><span class="o">?</span><span class="nx">F</span><span class="o">:</span><span class="nx">F</span><span class="o">-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="mi">10</span><span class="p">)})</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span><span class="k">default</span><span class="o">:</span><span class="k">return</span> <span class="nx">D</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">)}});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">readAttribute</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">readAttribute</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">===</span><span class="s2">&quot;title&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="k">return</span> <span class="nx">C</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">)})}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">getOffsetParent</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">getOffsetParent</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">!==</span><span class="s2">&quot;static&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">C</span><span class="p">(</span><span class="nx">B</span><span class="p">)}</span><span class="nx">B</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span><span class="s2">&quot;relative&quot;</span><span class="p">});</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">C</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span><span class="nx">A</span><span class="p">});</span><span class="k">return</span> <span class="nx">D</span><span class="p">});</span><span class="nx">$w</span><span class="p">(</span><span class="s2">&quot;positionedOffset viewportOffset&quot;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">[</span><span class="nx">A</span><span class="p">].</span><span class="nx">wrap</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="nx">C</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">!==</span><span class="s2">&quot;static&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">E</span><span class="p">(</span><span class="nx">C</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">getOffsetParent</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">&amp;&amp;</span><span class="nx">D</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;fixed&quot;</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">zoom</span><span class="o">:</span><span class="mi">1</span><span class="p">})}</span><span class="nx">C</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span><span class="s2">&quot;relative&quot;</span><span class="p">});</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">E</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="nx">C</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span><span class="nx">B</span><span class="p">});</span><span class="k">return</span> <span class="nx">F</span><span class="p">})});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="k">return</span> <span class="nx">B</span><span class="p">(</span><span class="nx">A</span><span class="p">)});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">getStyle</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">B</span><span class="o">=</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;float&quot;</span><span class="o">||</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;cssFloat&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;styleFloat&quot;</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">camelize</span><span class="p">();</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">B</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">[</span><span class="nx">B</span><span class="p">]}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;opacity&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">=</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;filter&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">match</span><span class="p">(</span><span class="sr">/alpha\(opacity=(.*)\)/</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]){</span><span class="k">return</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">100</span><span class="p">}}</span><span class="k">return</span> <span class="mi">1</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;auto&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">((</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;width&quot;</span><span class="o">||</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">)</span><span class="o">!=</span><span class="s2">&quot;none&quot;</span><span class="p">)){</span><span class="k">return</span> <span class="nx">A</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">capitalize</span><span class="p">()]</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="k">return</span> <span class="nx">C</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">setOpacity</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="kd">function</span> <span class="nx">F</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="k">return</span> <span class="nx">G</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/alpha\([^\)]*\)/gi</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)}</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">;</span><span class="k">if</span><span class="p">((</span><span class="nx">A</span><span class="o">&amp;&amp;!</span><span class="nx">A</span><span class="p">.</span><span class="nx">hasLayout</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zoom</span><span class="o">==</span><span class="s2">&quot;normal&quot;</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;filter&quot;</span><span class="p">),</span><span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">==</span><span class="mi">1</span><span class="o">||</span><span class="nx">E</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">){(</span><span class="nx">D</span><span class="o">=</span><span class="nx">F</span><span class="p">(</span><span class="nx">D</span><span class="p">))</span><span class="o">?</span><span class="nx">C</span><span class="p">.</span><span class="nx">filter</span><span class="o">=</span><span class="nx">D</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="s2">&quot;filter&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">B</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">&lt;</span><span class="mf">0.00001</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">}}</span><span class="nx">C</span><span class="p">.</span><span class="nx">filter</span><span class="o">=</span><span class="nx">F</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;alpha(opacity=&quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">E</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">B</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="s2">&quot;className&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="s2">&quot;for&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nx">C</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;x&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">className</span><span class="o">!==</span><span class="s2">&quot;x&quot;</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span><span class="s2">&quot;x&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">className</span><span class="o">===</span><span class="s2">&quot;x&quot;</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="s2">&quot;class&quot;</span><span class="p">}}</span><span class="nx">C</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="nx">C</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">);</span><span class="nx">C</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;x&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">htmlFor</span><span class="o">!==</span><span class="s2">&quot;x&quot;</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;htmlFor&quot;</span><span class="p">,</span><span class="s2">&quot;x&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">htmlFor</span><span class="o">===</span><span class="s2">&quot;x&quot;</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="s2">&quot;htmlFor&quot;</span><span class="p">}}</span><span class="nx">C</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span><span class="p">{</span><span class="nx">read</span><span class="o">:</span><span class="p">{</span><span class="nx">names</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">className</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;for&quot;</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">htmlFor</span><span class="o">:</span><span class="nx">A</span><span class="p">},</span><span class="nx">values</span><span class="o">:</span><span class="p">{</span><span class="nx">_getAttr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">E</span><span class="p">)},</span><span class="nx">_getAttr2</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="mi">2</span><span class="p">)},</span><span class="nx">_getAttrNode</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="nx">F</span><span class="p">);</span><span class="k">return</span> <span class="nx">E</span><span class="o">?</span><span class="nx">E</span><span class="p">.</span><span class="nx">value</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="nx">_getEv</span><span class="o">:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nx">D</span><span class="p">.</span><span class="nx">onclick</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">;</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;onclick&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">E</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">F</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">H</span><span class="p">){</span><span class="nx">H</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">H</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">H</span><span class="p">){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="nx">H</span><span class="o">=</span><span class="nx">H</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span><span class="nx">H</span><span class="o">=</span><span class="nx">H</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span><span class="nx">H</span><span class="o">=</span><span class="nx">H</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="k">return</span> <span class="nx">H</span><span class="p">.</span><span class="nx">strip</span><span class="p">()}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">H</span><span class="p">){</span><span class="nx">H</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">H</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">H</span><span class="p">){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="k">return</span> <span class="nx">H</span><span class="p">.</span><span class="nx">strip</span><span class="p">()}}}</span><span class="nx">D</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">E</span><span class="p">})(),</span><span class="nx">_flag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">).</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="nx">E</span><span class="p">)</span><span class="o">?</span><span class="nx">E</span><span class="o">:</span><span class="kc">null</span><span class="p">},</span><span class="nx">style</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()},</span><span class="nx">title</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">title</span><span class="p">}}}}})();</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">write</span><span class="o">=</span><span class="p">{</span><span class="nx">names</span><span class="o">:</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">cellpadding</span><span class="o">:</span><span class="s2">&quot;cellPadding&quot;</span><span class="p">,</span><span class="nx">cellspacing</span><span class="o">:</span><span class="s2">&quot;cellSpacing&quot;</span><span class="p">},</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">read</span><span class="p">.</span><span class="nx">names</span><span class="p">),</span><span class="nx">values</span><span class="o">:</span><span class="p">{</span><span class="nx">checked</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">checked</span><span class="o">=!!</span><span class="nx">B</span><span class="p">},</span><span class="nx">style</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span><span class="o">=</span><span class="nx">B</span><span class="o">?</span><span class="nx">B</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">}}};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">has</span><span class="o">=</span><span class="p">{};</span><span class="nx">$w</span><span class="p">(</span><span class="s2">&quot;colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder&quot;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">write</span><span class="p">.</span><span class="nx">names</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()]</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">has</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()]</span><span class="o">=</span><span class="nx">A</span><span class="p">});(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">href</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getAttr2</span><span class="p">,</span><span class="nx">src</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getAttr2</span><span class="p">,</span><span class="nx">type</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getAttr</span><span class="p">,</span><span class="nx">action</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getAttrNode</span><span class="p">,</span><span class="nx">disabled</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_flag</span><span class="p">,</span><span class="nx">checked</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_flag</span><span class="p">,</span><span class="nx">readonly</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_flag</span><span class="p">,</span><span class="nx">multiple</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_flag</span><span class="p">,</span><span class="nx">onload</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onunload</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onclick</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">ondblclick</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onmousedown</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onmouseup</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onmouseover</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onmousemove</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onmouseout</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onfocus</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onblur</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onkeypress</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onkeydown</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onkeyup</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onsubmit</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onreset</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onselect</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">,</span><span class="nx">onchange</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_getEv</span><span class="p">})})(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">read</span><span class="p">.</span><span class="nx">values</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">ElementExtensions</span><span class="p">){(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">),</span><span class="nx">D</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">F</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">tagName</span><span class="o">!==</span><span class="s2">&quot;!&quot;</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">F</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">D</span><span class="p">}</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">down</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">C</span><span class="p">.</span><span class="nx">firstDescendant</span><span class="p">()}</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">?</span><span class="nx">A</span><span class="p">(</span><span class="nx">C</span><span class="p">)[</span><span class="nx">D</span><span class="p">]</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">)[</span><span class="nx">B</span><span class="o">||</span><span class="mi">0</span><span class="p">]}})()}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">Gecko</span><span class="o">&amp;&amp;</span><span class="sr">/rv:1\.8\.0/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">)){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">setOpacity</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">?</span><span class="mf">0.999999</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="o">&lt;</span><span class="mf">0.00001</span><span class="p">)</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="nx">B</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">setOpacity</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="mi">1</span><span class="o">||</span><span class="nx">B</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="o">&lt;</span><span class="mf">0.00001</span><span class="p">)</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="nx">B</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;IMG&quot;</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">width</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">width</span><span class="o">++</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">width</span><span class="o">--</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">try</span><span class="p">{</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">D</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">C</span><span class="p">){}}}</span><span class="k">return</span> <span class="nx">A</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="nx">A</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">C</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetParent</span><span class="o">==</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">){</span><span class="k">break</span><span class="p">}}</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)}}}}}</span><span class="k">if</span><span class="p">(</span><span class="s2">&quot;outerHTML&quot;</span> <span class="k">in</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">replace</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">&amp;&amp;</span><span class="nx">E</span><span class="p">.</span><span class="nx">toElement</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">toElement</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">E</span><span class="p">)){</span><span class="nx">C</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">replaceChild</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">C</span><span class="p">);</span><span class="k">return</span> <span class="nx">C</span><span class="p">}</span><span class="nx">E</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toHTML</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">B</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_insertionTranslations</span><span class="p">.</span><span class="nx">tags</span><span class="p">[</span><span class="nx">B</span><span class="p">]){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_getContentFromAnonymousElement</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">E</span><span class="p">.</span><span class="nx">stripScripts</span><span class="p">());</span><span class="nx">D</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">F</span><span class="p">)})}</span><span class="k">else</span><span class="p">{</span><span class="nx">A</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">G</span><span class="p">)})}}</span><span class="k">else</span><span class="p">{</span><span class="nx">C</span><span class="p">.</span><span class="nx">outerHTML</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">stripScripts</span><span class="p">()}</span><span class="nx">E</span><span class="p">.</span><span class="nx">evalScripts</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">E</span><span class="p">).</span><span class="nx">defer</span><span class="p">();</span><span class="k">return</span> <span class="nx">C</span><span class="p">}}</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">[</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">];</span><span class="nx">A</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_getContentFromAnonymousElement</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="k">new</span> <span class="nx">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">A</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_insertionTranslations</span><span class="p">.</span><span class="nx">tags</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nx">B</span><span class="o">+</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="nx">A</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">times</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">})}</span><span class="k">else</span><span class="p">{</span><span class="nx">D</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">B</span><span class="p">}</span><span class="k">return</span> <span class="nx">$A</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">)};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_insertionTranslations</span><span class="o">=</span><span class="p">{</span><span class="nx">before</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">top</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)},</span><span class="nx">bottom</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">B</span><span class="p">)},</span><span class="nx">after</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">)},</span><span class="nx">tags</span><span class="o">:</span><span class="p">{</span><span class="nx">TABLE</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;&lt;table&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="nx">TBODY</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;&lt;table&gt;&lt;tbody&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/tbody&gt;&lt;/table&gt;&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="nx">TR</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="nx">TD</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="nx">SELECT</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;&lt;select&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/select&gt;&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">]}};(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_insertionTranslations</span><span class="p">.</span><span class="nx">tags</span><span class="p">;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">THEAD</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">TBODY</span><span class="p">,</span><span class="nx">TFOOT</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">TBODY</span><span class="p">,</span><span class="nx">TH</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">TD</span><span class="p">})})();</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">Simulated</span><span class="o">=</span><span class="p">{</span><span class="nx">hasAttribute</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">_attributeTranslations</span><span class="p">.</span><span class="nx">has</span><span class="p">[</span><span class="nx">C</span><span class="p">]</span><span class="o">||</span><span class="nx">C</span><span class="p">;</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">B</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">specified</span><span class="p">)}};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="o">=</span><span class="p">{};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Element</span><span class="p">,</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">ElementExtensions</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">HTMLElement</span><span class="o">=</span><span class="p">{};</span><span class="nb">window</span><span class="p">.</span><span class="nx">HTMLElement</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">;</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">ElementExtensions</span><span class="o">=</span><span class="kc">true</span><span class="p">}</span><span class="nx">A</span><span class="o">=</span><span class="kc">null</span><span class="p">})(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">));</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Element</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">I</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">I</span><span class="p">){</span><span class="kd">var</span> <span class="nx">K</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">G</span><span class="p">);</span><span class="nx">I</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">J</span><span class="o">=</span><span class="p">(</span><span class="nx">H</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">!==</span><span class="s2">&quot;x&quot;</span><span class="p">);</span><span class="k">delete</span> <span class="nx">I</span><span class="p">[</span><span class="nx">K</span><span class="p">];</span><span class="nx">H</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">J</span><span class="p">}}</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">G</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">J</span> <span class="k">in</span> <span class="nx">G</span><span class="p">){</span><span class="kd">var</span> <span class="nx">I</span><span class="o">=</span><span class="nx">G</span><span class="p">[</span><span class="nx">J</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">I</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="p">(</span><span class="nx">J</span> <span class="k">in</span> <span class="nx">H</span><span class="p">)){</span><span class="nx">H</span><span class="p">[</span><span class="nx">J</span><span class="p">]</span><span class="o">=</span><span class="nx">I</span><span class="p">.</span><span class="nx">methodize</span><span class="p">()}}}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">C</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">SpecificElementExtensions</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">H</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">H</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">H</span><span class="p">.</span><span class="nx">_extendedByPrototype</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nx">H</span><span class="p">.</span><span class="nx">tagName</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="sr">/^(?:object|applet|embed)$/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">G</span><span class="p">))){</span><span class="nx">B</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);</span><span class="nx">B</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">Simulated</span><span class="p">);</span><span class="nx">B</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">[</span><span class="nx">G</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()])}}</span><span class="k">return</span> <span class="nx">H</span><span class="p">}}</span><span class="k">return</span> <span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{},</span><span class="nx">E</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">;</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">I</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">I</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">I</span><span class="p">.</span><span class="nx">_extendedByPrototype</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">||</span><span class="nx">I</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!=</span><span class="mi">1</span><span class="o">||</span><span class="nx">I</span><span class="o">==</span><span class="nb">window</span><span class="p">){</span><span class="k">return</span> <span class="nx">I</span><span class="p">}</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">A</span><span class="p">),</span><span class="nx">H</span><span class="o">=</span><span class="nx">I</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="nx">H</span><span class="p">]){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">E</span><span class="p">[</span><span class="nx">H</span><span class="p">])}</span><span class="nx">B</span><span class="p">(</span><span class="nx">I</span><span class="p">,</span><span class="nx">G</span><span class="p">);</span><span class="nx">I</span><span class="p">.</span><span class="nx">_extendedByPrototype</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">;</span><span class="k">return</span> <span class="nx">I</span><span class="p">},{</span><span class="nx">refresh</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">ElementExtensions</span><span class="p">){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">Simulated</span><span class="p">)}}});</span><span class="nx">F</span><span class="p">.</span><span class="nx">refresh</span><span class="p">();</span><span class="k">return</span> <span class="nx">F</span><span class="p">})();</span><span class="nx">Element</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="nx">B</span><span class="p">)}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">Simulated</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">)};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">addMethods</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">J</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="p">){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Form</span><span class="p">,</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">,</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">,{</span><span class="nx">FORM</span><span class="o">:</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Methods</span><span class="p">),</span><span class="nx">INPUT</span><span class="o">:</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">),</span><span class="nx">SELECT</span><span class="o">:</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">),</span><span class="nx">TEXTAREA</span><span class="o">:</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">)})}</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="nx">C</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="p">){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">,</span><span class="nx">C</span><span class="o">||</span><span class="p">{})}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">B</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">H</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">H</span><span class="p">(</span><span class="nx">B</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">H</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">F</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">[</span><span class="nx">F</span><span class="p">]){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">[</span><span class="nx">F</span><span class="p">]</span><span class="o">=</span><span class="p">{}}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">[</span><span class="nx">F</span><span class="p">],</span><span class="nx">C</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">M</span><span class="p">,</span><span class="nx">L</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="nx">F</span><span class="o">=</span><span class="nx">F</span><span class="o">||</span><span class="kc">false</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">O</span> <span class="k">in</span> <span class="nx">M</span><span class="p">){</span><span class="kd">var</span> <span class="nx">N</span><span class="o">=</span><span class="nx">M</span><span class="p">[</span><span class="nx">O</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">N</span><span class="p">)){</span><span class="k">continue</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">F</span><span class="o">||!</span><span class="p">(</span><span class="nx">O</span> <span class="k">in</span> <span class="nx">L</span><span class="p">)){</span><span class="nx">L</span><span class="p">[</span><span class="nx">O</span><span class="p">]</span><span class="o">=</span><span class="nx">N</span><span class="p">.</span><span class="nx">methodize</span><span class="p">()}}}</span><span class="kd">function</span> <span class="nx">E</span><span class="p">(</span><span class="nx">N</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="p">;</span><span class="kd">var</span> <span class="nx">M</span><span class="o">=</span><span class="p">{</span><span class="nx">OPTGROUP</span><span class="o">:</span><span class="s2">&quot;OptGroup&quot;</span><span class="p">,</span><span class="nx">TEXTAREA</span><span class="o">:</span><span class="s2">&quot;TextArea&quot;</span><span class="p">,</span><span class="nx">P</span><span class="o">:</span><span class="s2">&quot;Paragraph&quot;</span><span class="p">,</span><span class="nx">FIELDSET</span><span class="o">:</span><span class="s2">&quot;FieldSet&quot;</span><span class="p">,</span><span class="nx">UL</span><span class="o">:</span><span class="s2">&quot;UList&quot;</span><span class="p">,</span><span class="nx">OL</span><span class="o">:</span><span class="s2">&quot;OList&quot;</span><span class="p">,</span><span class="nx">DL</span><span class="o">:</span><span class="s2">&quot;DList&quot;</span><span class="p">,</span><span class="nx">DIR</span><span class="o">:</span><span class="s2">&quot;Directory&quot;</span><span class="p">,</span><span class="nx">H1</span><span class="o">:</span><span class="s2">&quot;Heading&quot;</span><span class="p">,</span><span class="nx">H2</span><span class="o">:</span><span class="s2">&quot;Heading&quot;</span><span class="p">,</span><span class="nx">H3</span><span class="o">:</span><span class="s2">&quot;Heading&quot;</span><span class="p">,</span><span class="nx">H4</span><span class="o">:</span><span class="s2">&quot;Heading&quot;</span><span class="p">,</span><span class="nx">H5</span><span class="o">:</span><span class="s2">&quot;Heading&quot;</span><span class="p">,</span><span class="nx">H6</span><span class="o">:</span><span class="s2">&quot;Heading&quot;</span><span class="p">,</span><span class="nx">Q</span><span class="o">:</span><span class="s2">&quot;Quote&quot;</span><span class="p">,</span><span class="nx">INS</span><span class="o">:</span><span class="s2">&quot;Mod&quot;</span><span class="p">,</span><span class="nx">DEL</span><span class="o">:</span><span class="s2">&quot;Mod&quot;</span><span class="p">,</span><span class="nx">A</span><span class="o">:</span><span class="s2">&quot;Anchor&quot;</span><span class="p">,</span><span class="nx">IMG</span><span class="o">:</span><span class="s2">&quot;Image&quot;</span><span class="p">,</span><span class="nx">CAPTION</span><span class="o">:</span><span class="s2">&quot;TableCaption&quot;</span><span class="p">,</span><span class="nx">COL</span><span class="o">:</span><span class="s2">&quot;TableCol&quot;</span><span class="p">,</span><span class="nx">COLGROUP</span><span class="o">:</span><span class="s2">&quot;TableCol&quot;</span><span class="p">,</span><span class="nx">THEAD</span><span class="o">:</span><span class="s2">&quot;TableSection&quot;</span><span class="p">,</span><span class="nx">TFOOT</span><span class="o">:</span><span class="s2">&quot;TableSection&quot;</span><span class="p">,</span><span class="nx">TBODY</span><span class="o">:</span><span class="s2">&quot;TableSection&quot;</span><span class="p">,</span><span class="nx">TR</span><span class="o">:</span><span class="s2">&quot;TableRow&quot;</span><span class="p">,</span><span class="nx">TH</span><span class="o">:</span><span class="s2">&quot;TableCell&quot;</span><span class="p">,</span><span class="nx">TD</span><span class="o">:</span><span class="s2">&quot;TableCell&quot;</span><span class="p">,</span><span class="nx">FRAMESET</span><span class="o">:</span><span class="s2">&quot;FrameSet&quot;</span><span class="p">,</span><span class="nx">IFRAME</span><span class="o">:</span><span class="s2">&quot;IFrame&quot;</span><span class="p">};</span><span class="k">if</span><span class="p">(</span><span class="nx">M</span><span class="p">[</span><span class="nx">N</span><span class="p">]){</span><span class="nx">F</span><span class="o">=</span><span class="s2">&quot;HTML&quot;</span><span class="o">+</span><span class="nx">M</span><span class="p">[</span><span class="nx">N</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;Element&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">[</span><span class="nx">F</span><span class="p">]){</span><span class="k">return</span> <span class="nb">window</span><span class="p">[</span><span class="nx">F</span><span class="p">]}</span><span class="nx">F</span><span class="o">=</span><span class="s2">&quot;HTML&quot;</span><span class="o">+</span><span class="nx">N</span><span class="o">+</span><span class="s2">&quot;Element&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">[</span><span class="nx">F</span><span class="p">]){</span><span class="k">return</span> <span class="nb">window</span><span class="p">[</span><span class="nx">F</span><span class="p">]}</span><span class="nx">F</span><span class="o">=</span><span class="s2">&quot;HTML&quot;</span><span class="o">+</span><span class="nx">N</span><span class="p">.</span><span class="nx">capitalize</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;Element&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">[</span><span class="nx">F</span><span class="p">]){</span><span class="k">return</span> <span class="nb">window</span><span class="p">[</span><span class="nx">F</span><span class="p">]}</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">N</span><span class="p">);</span><span class="kd">var</span> <span class="nx">O</span><span class="o">=</span><span class="nx">L</span><span class="p">.</span><span class="nx">__proto__</span><span class="o">||</span><span class="nx">L</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="nx">L</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">O</span><span class="p">}</span><span class="kd">var</span> <span class="nx">I</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">HTMLElement</span><span class="o">?</span><span class="nx">HTMLElement</span><span class="p">.</span><span class="nx">prototype</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">J</span><span class="p">.</span><span class="nx">ElementExtensions</span><span class="p">){</span><span class="nx">A</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">,</span><span class="nx">I</span><span class="p">);</span><span class="nx">A</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">Simulated</span><span class="p">,</span><span class="nx">I</span><span class="p">,</span><span class="kc">true</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">J</span><span class="p">.</span><span class="nx">SpecificElementExtensions</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">K</span> <span class="k">in</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">){</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nx">E</span><span class="p">(</span><span class="nx">K</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">G</span><span class="p">)){</span><span class="k">continue</span><span class="p">}</span><span class="nx">A</span><span class="p">(</span><span class="nx">D</span><span class="p">[</span><span class="nx">K</span><span class="p">],</span><span class="nx">G</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)}}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Element</span><span class="p">,</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);</span><span class="k">delete</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">ByTag</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">.</span><span class="nx">refresh</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">.</span><span class="nx">refresh</span><span class="p">()}</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cache</span><span class="o">=</span><span class="p">{}};</span><span class="nb">document</span><span class="p">.</span><span class="nx">viewport</span><span class="o">=</span><span class="p">{</span><span class="nx">getDimensions</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="p">{</span><span class="nx">width</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">getWidth</span><span class="p">(),</span><span class="nx">height</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">getHeight</span><span class="p">()}},</span><span class="nx">getScrollOffsets</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">_returnOffset</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">pageXOffset</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">pageYOffset</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">)}};(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">,</span><span class="nx">F</span><span class="o">=</span><span class="nb">document</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="p">{};</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">H</span><span class="p">.</span><span class="nx">WebKit</span><span class="o">&amp;&amp;!</span><span class="nx">F</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">){</span><span class="k">return</span> <span class="nb">document</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">H</span><span class="p">.</span><span class="nx">Opera</span><span class="o">&amp;&amp;</span><span class="nb">window</span><span class="p">.</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="p">.</span><span class="nx">version</span><span class="p">())</span><span class="o">&lt;</span><span class="mf">9.5</span><span class="p">){</span><span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">}</span><span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">}</span><span class="kd">function</span> <span class="nx">G</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">()}</span><span class="nx">E</span><span class="p">[</span><span class="nx">B</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;client&quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">;</span><span class="nx">C</span><span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">D</span><span class="p">[</span><span class="nx">E</span><span class="p">[</span><span class="nx">B</span><span class="p">]]};</span><span class="k">return</span> <span class="nx">C</span><span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">]()}</span><span class="nx">C</span><span class="p">.</span><span class="nx">getWidth</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">curry</span><span class="p">(</span><span class="s2">&quot;Width&quot;</span><span class="p">);</span><span class="nx">C</span><span class="p">.</span><span class="nx">getHeight</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">curry</span><span class="p">(</span><span class="s2">&quot;Height&quot;</span><span class="p">)})(</span><span class="nb">document</span><span class="p">.</span><span class="nx">viewport</span><span class="p">);</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Storage</span><span class="o">=</span><span class="p">{</span><span class="nx">UID</span><span class="o">:</span><span class="mi">1</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">addMethods</span><span class="p">({</span><span class="nx">getStorage</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">))){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">A</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">===</span><span class="nb">window</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">B</span><span class="p">.</span><span class="nx">_prototypeUID</span><span class="o">===</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">_prototypeUID</span><span class="o">=</span><span class="p">[</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Storage</span><span class="p">.</span><span class="nx">UID</span><span class="o">++</span><span class="p">]}</span><span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">_prototypeUID</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Storage</span><span class="p">[</span><span class="nx">A</span><span class="p">]){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Storage</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">=</span><span class="nx">$H</span><span class="p">()}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">Storage</span><span class="p">[</span><span class="nx">A</span><span class="p">]},</span><span class="nx">store</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">))){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">2</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStorage</span><span class="p">(</span><span class="nx">B</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStorage</span><span class="p">(</span><span class="nx">B</span><span class="p">).</span><span class="nx">set</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">)}</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">retrieve</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">))){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStorage</span><span class="p">(</span><span class="nx">C</span><span class="p">),</span><span class="nx">D</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">D</span><span class="p">)){</span><span class="nx">E</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">}</span><span class="k">return</span> <span class="nx">D</span><span class="p">},</span><span class="nx">clone</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">))){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">E</span><span class="p">.</span><span class="nx">_prototypeUID</span><span class="o">=</span><span class="k">void</span> <span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">),</span><span class="nx">B</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">B</span><span class="o">--</span><span class="p">){</span><span class="nx">D</span><span class="p">[</span><span class="nx">B</span><span class="p">].</span><span class="nx">_prototypeUID</span><span class="o">=</span><span class="k">void</span> <span class="mi">0</span><span class="p">}}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">E</span><span class="p">)}});</span><span class="kd">var</span> <span class="nx">Selector</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">strip</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">shouldUseSelectorsAPI</span><span class="p">()){</span><span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="o">=</span><span class="s2">&quot;selectorsAPI&quot;</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">shouldUseXPath</span><span class="p">()){</span><span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="o">=</span><span class="s2">&quot;xpath&quot;</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">compileXPathMatcher</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">compileMatcher</span><span class="p">()}}},</span><span class="nx">shouldUseXPath</span><span class="o">:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">evaluate</span><span class="o">&amp;&amp;</span><span class="nb">window</span><span class="p">.</span><span class="nx">XPathResult</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nx">D</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;ul&gt;&lt;li&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="s2">&quot;.//*[local-name()=&#39;ul&#39; or local-name()=&#39;UL&#39;]//*[local-name()=&#39;li&#39; or local-name()=&#39;LI&#39;]&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="nx">XPathResult</span><span class="p">.</span><span class="nx">ORDERED_NODE_SNAPSHOT_TYPE</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span><span class="nx">E</span><span class="o">=</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">snapshotLength</span><span class="o">!==</span><span class="mi">2</span><span class="p">);</span><span class="nx">D</span><span class="o">=</span><span class="kc">null</span><span class="p">}</span><span class="k">return</span> <span class="nx">E</span><span class="p">})();</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">XPath</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;-of-type&quot;</span><span class="p">)</span><span class="o">||</span><span class="nx">B</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;:empty&quot;</span><span class="p">))){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">if</span><span class="p">((</span><span class="sr">/(\[[\w-]*?:|:checked)/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">B</span><span class="p">)){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">return</span> <span class="kc">true</span><span class="p">}})(),</span><span class="nx">shouldUseSelectorsAPI</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">SelectorsAPI</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">CASE_INSENSITIVE_CLASS_NAMES</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_div</span><span class="p">){</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_div</span><span class="o">=</span><span class="k">new</span> <span class="nx">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">)}</span><span class="k">try</span><span class="p">{</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_div</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">return</span> <span class="kc">true</span><span class="p">},</span><span class="nx">compileMatcher</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">,</span><span class="nx">ps</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">patterns</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">criteria</span><span class="p">,</span><span class="nx">le</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">len</span><span class="o">=</span><span class="nx">ps</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">name</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_cache</span><span class="p">[</span><span class="nx">e</span><span class="p">]){</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_cache</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;this.matcher = function(root) {&quot;</span><span class="p">,</span><span class="s2">&quot;var r = root, h = Selector.handlers, c = false, n;&quot;</span><span class="p">];</span><span class="k">while</span><span class="p">(</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">le</span><span class="o">!=</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="sr">/\S/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span><span class="nx">le</span><span class="o">=</span><span class="nx">e</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">len</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span><span class="nx">p</span><span class="o">=</span><span class="nx">ps</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">re</span><span class="p">;</span><span class="nx">name</span><span class="o">=</span><span class="nx">ps</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">m</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">p</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span><span class="o">?</span><span class="nx">c</span><span class="p">[</span><span class="nx">name</span><span class="p">](</span><span class="nx">m</span><span class="p">)</span><span class="o">:</span><span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">name</span><span class="p">]).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">m</span><span class="p">));</span><span class="nx">e</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">break</span><span class="p">}}}</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;return h.unique(n);\n}&quot;</span><span class="p">);</span><span class="nb">eval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">));</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_cache</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">]</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="p">},</span><span class="nx">compileXPathMatcher</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">,</span><span class="nx">H</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">patterns</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="nx">H</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_cache</span><span class="p">[</span><span class="nx">G</span><span class="p">]){</span><span class="k">this</span><span class="p">.</span><span class="nx">xpath</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_cache</span><span class="p">[</span><span class="nx">G</span><span class="p">];</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;.//*&quot;</span><span class="p">];</span><span class="k">while</span><span class="p">(</span><span class="nx">G</span><span class="o">&amp;&amp;</span><span class="nx">F</span><span class="o">!=</span><span class="nx">G</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="sr">/\S/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">G</span><span class="p">)){</span><span class="nx">F</span><span class="o">=</span><span class="nx">G</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">E</span><span class="o">&lt;</span><span class="nx">A</span><span class="p">;</span><span class="nx">E</span><span class="o">++</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">H</span><span class="p">[</span><span class="nx">E</span><span class="p">].</span><span class="nx">name</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">H</span><span class="p">[</span><span class="nx">E</span><span class="p">].</span><span class="nx">re</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">])</span><span class="o">?</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">](</span><span class="nx">B</span><span class="p">)</span><span class="o">:</span><span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">]).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">B</span><span class="p">));</span><span class="nx">G</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">break</span><span class="p">}}}</span><span class="k">this</span><span class="p">.</span><span class="nx">xpath</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">_cache</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">]</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">xpath</span><span class="p">},</span><span class="nx">findElements</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="o">||</span><span class="nb">document</span><span class="p">;</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">,</span><span class="nx">B</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;selectorsAPI&quot;</span><span class="o">:</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">!==</span><span class="nb">document</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">identify</span><span class="p">();</span><span class="nx">E</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([\.:])/g</span><span class="p">,</span><span class="s2">&quot;\\$1&quot;</span><span class="p">);</span><span class="nx">C</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="o">+</span><span class="nx">E</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">C</span><span class="p">}</span><span class="nx">B</span><span class="o">=</span><span class="nx">$A</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="nx">C</span><span class="p">)).</span><span class="nx">map</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="k">return</span> <span class="nx">B</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;xpath&quot;</span><span class="o">:</span><span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">_getElementsByXPath</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">xpath</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="k">default</span><span class="o">:</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">matcher</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">match</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">I</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">tokens</span><span class="o">=</span><span class="p">[];</span><span class="kd">var</span> <span class="nx">M</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">patterns</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">assertions</span><span class="p">;</span><span class="kd">var</span> <span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">L</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">C</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">M</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="o">!==</span><span class="nx">M</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="sr">/\S/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">M</span><span class="p">)){</span><span class="nx">B</span><span class="o">=</span><span class="nx">M</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">H</span><span class="o">&lt;</span><span class="nx">L</span><span class="p">;</span><span class="nx">H</span><span class="o">++</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">H</span><span class="p">].</span><span class="nx">re</span><span class="p">;</span><span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">H</span><span class="p">].</span><span class="nx">name</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">=</span><span class="nx">M</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">D</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="nx">C</span><span class="p">]){</span><span class="k">this</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">C</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">F</span><span class="p">)]);</span><span class="nx">M</span><span class="o">=</span><span class="nx">M</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">F</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;&quot;</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">findElements</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">include</span><span class="p">(</span><span class="nx">I</span><span class="p">)}}}}</span><span class="kd">var</span> <span class="nx">K</span><span class="o">=</span><span class="kc">true</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">J</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">G</span><span class="p">;</span><span class="nx">G</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">tokens</span><span class="p">[</span><span class="nx">H</span><span class="p">];</span><span class="nx">H</span><span class="o">++</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">G</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">J</span><span class="o">=</span><span class="nx">G</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">assertions</span><span class="p">[</span><span class="nx">C</span><span class="p">](</span><span class="nx">I</span><span class="p">,</span><span class="nx">J</span><span class="p">)){</span><span class="nx">K</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">break</span><span class="p">}}</span><span class="k">return</span> <span class="nx">K</span><span class="p">},</span><span class="nx">toString</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">},</span><span class="nx">inspect</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="s2">&quot;#&lt;Selector:&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">expression</span><span class="p">.</span><span class="nx">inspect</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&gt;&quot;</span><span class="p">}});</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">SelectorsAPI</span><span class="o">&amp;&amp;</span><span class="nb">document</span><span class="p">.</span><span class="nx">compatMode</span><span class="o">===</span><span class="s2">&quot;BackCompat&quot;</span><span class="p">){</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">CASE_INSENSITIVE_CLASS_NAMES</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">A</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">);</span><span class="nx">C</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="s2">&quot;prototype_test_id&quot;</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">;</span><span class="nx">C</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#prototype_test_id .test&quot;</span><span class="p">)</span><span class="o">!==</span><span class="kc">null</span><span class="p">);</span><span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">B</span><span class="p">})()}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Selector</span><span class="p">,{</span><span class="nx">_cache</span><span class="o">:</span><span class="p">{},</span><span class="nx">xpath</span><span class="o">:</span><span class="p">{</span><span class="nx">descendant</span><span class="o">:</span><span class="s2">&quot;//*&quot;</span><span class="p">,</span><span class="nx">child</span><span class="o">:</span><span class="s2">&quot;/*&quot;</span><span class="p">,</span><span class="nx">adjacent</span><span class="o">:</span><span class="s2">&quot;/following-sibling::*[1]&quot;</span><span class="p">,</span><span class="nx">laterSibling</span><span class="o">:</span><span class="s2">&quot;/following-sibling::*&quot;</span><span class="p">,</span><span class="nx">tagName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;*&quot;</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;&quot;</span><span class="p">}</span><span class="k">return</span><span class="s2">&quot;[local-name()=&#39;&quot;</span><span class="o">+</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&#39; or local-name()=&#39;&quot;</span><span class="o">+</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&#39;]&quot;</span><span class="p">},</span><span class="nx">className</span><span class="o">:</span><span class="s2">&quot;[contains(concat(&#39; &#39;, @class, &#39; &#39;), &#39; #{1} &#39;)]&quot;</span><span class="p">,</span><span class="nx">id</span><span class="o">:</span><span class="s2">&quot;[@id=&#39;#{1}&#39;]&quot;</span><span class="p">,</span><span class="nx">attrPresence</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="s2">&quot;[@#{1}]&quot;</span><span class="p">).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">attr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="nx">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">||</span><span class="nx">A</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">operators</span><span class="p">[</span><span class="nx">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]]).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">pseudo</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">[</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">B</span><span class="p">)){</span><span class="k">return</span> <span class="nx">B</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">[</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]]).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">operators</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;=&quot;</span><span class="o">:</span><span class="s2">&quot;[@#{1}=&#39;#{3}&#39;]&quot;</span><span class="p">,</span><span class="s2">&quot;!=&quot;</span><span class="o">:</span><span class="s2">&quot;[@#{1}!=&#39;#{3}&#39;]&quot;</span><span class="p">,</span><span class="s2">&quot;^=&quot;</span><span class="o">:</span><span class="s2">&quot;[starts-with(@#{1}, &#39;#{3}&#39;)]&quot;</span><span class="p">,</span><span class="s2">&quot;$=&quot;</span><span class="o">:</span><span class="s2">&quot;[substring(@#{1}, (string-length(@#{1}) - string-length(&#39;#{3}&#39;) + 1))=&#39;#{3}&#39;]&quot;</span><span class="p">,</span><span class="s2">&quot;*=&quot;</span><span class="o">:</span><span class="s2">&quot;[contains(@#{1}, &#39;#{3}&#39;)]&quot;</span><span class="p">,</span><span class="s2">&quot;~=&quot;</span><span class="o">:</span><span class="s2">&quot;[contains(concat(&#39; &#39;, @#{1}, &#39; &#39;), &#39; #{3} &#39;)]&quot;</span><span class="p">,</span><span class="s2">&quot;|=&quot;</span><span class="o">:</span><span class="s2">&quot;[contains(concat(&#39;-&#39;, @#{1}, &#39;-&#39;), &#39;-#{3}-&#39;)]&quot;</span><span class="p">},</span><span class="nx">pseudos</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;first-child&quot;</span><span class="o">:</span><span class="s2">&quot;[not(preceding-sibling::*)]&quot;</span><span class="p">,</span><span class="s2">&quot;last-child&quot;</span><span class="o">:</span><span class="s2">&quot;[not(following-sibling::*)]&quot;</span><span class="p">,</span><span class="s2">&quot;only-child&quot;</span><span class="o">:</span><span class="s2">&quot;[not(preceding-sibling::* or following-sibling::*)]&quot;</span><span class="p">,</span><span class="nx">empty</span><span class="o">:</span><span class="s2">&quot;[count(*) = 0 and (count(text()) = 0)]&quot;</span><span class="p">,</span><span class="nx">checked</span><span class="o">:</span><span class="s2">&quot;[@checked]&quot;</span><span class="p">,</span><span class="nx">disabled</span><span class="o">:</span><span class="s2">&quot;[(@disabled) and (@type!=&#39;hidden&#39;)]&quot;</span><span class="p">,</span><span class="nx">enabled</span><span class="o">:</span><span class="s2">&quot;[not(@disabled) and (@type!=&#39;hidden&#39;)]&quot;</span><span class="p">,</span><span class="nx">not</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="nx">E</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="nx">C</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">patterns</span><span class="p">,</span><span class="nx">I</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">J</span><span class="p">,</span><span class="nx">G</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">B</span><span class="p">;</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">[];</span><span class="k">while</span><span class="p">(</span><span class="nx">H</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="o">!=</span><span class="nx">H</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="sr">/\S/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">H</span><span class="p">)){</span><span class="nx">A</span><span class="o">=</span><span class="nx">H</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">F</span><span class="o">&lt;</span><span class="nx">G</span><span class="p">;</span><span class="nx">F</span><span class="o">++</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="nx">F</span><span class="p">].</span><span class="nx">name</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">=</span><span class="nx">H</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">F</span><span class="p">].</span><span class="nx">re</span><span class="p">)){</span><span class="nx">J</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">I</span><span class="p">[</span><span class="nx">B</span><span class="p">])</span><span class="o">?</span><span class="nx">I</span><span class="p">[</span><span class="nx">B</span><span class="p">](</span><span class="nx">E</span><span class="p">)</span><span class="o">:</span><span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="nx">I</span><span class="p">[</span><span class="nx">B</span><span class="p">]).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="o">+</span><span class="nx">J</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">J</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">);</span><span class="nx">H</span><span class="o">=</span><span class="nx">H</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">break</span><span class="p">}}}</span><span class="k">return</span><span class="s2">&quot;[not(&quot;</span><span class="o">+</span><span class="nx">D</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)]&quot;</span><span class="p">},</span><span class="s2">&quot;nth-child&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="s2">&quot;(count(./preceding-sibling::*) + 1) &quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;nth-last-child&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="s2">&quot;(count(./following-sibling::*) + 1) &quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;nth-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="s2">&quot;position() &quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;nth-last-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="s2">&quot;(last() + 1 - position()) &quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;first-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">[</span><span class="s2">&quot;nth-of-type&quot;</span><span class="p">](</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;last-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">[</span><span class="s2">&quot;nth-last-of-type&quot;</span><span class="p">](</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;only-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">xpath</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">;</span><span class="k">return</span> <span class="nx">B</span><span class="p">[</span><span class="s2">&quot;first-of-type&quot;</span><span class="p">](</span><span class="nx">A</span><span class="p">)</span><span class="o">+</span><span class="nx">B</span><span class="p">[</span><span class="s2">&quot;last-of-type&quot;</span><span class="p">](</span><span class="nx">A</span><span class="p">)},</span><span class="nx">nth</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="p">,</span><span class="nx">G</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="nx">B</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="o">==</span><span class="s2">&quot;even&quot;</span><span class="p">){</span><span class="nx">G</span><span class="o">=</span><span class="s2">&quot;2n+0&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="o">==</span><span class="s2">&quot;odd&quot;</span><span class="p">){</span><span class="nx">G</span><span class="o">=</span><span class="s2">&quot;2n+1&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^(\d+)$/</span><span class="p">)){</span><span class="k">return</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="nx">E</span><span class="o">+</span><span class="s2">&quot;= &quot;</span><span class="o">+</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^(-?\d*)?n(([+-])(\d+))?/</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;-&quot;</span><span class="p">){</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="nb">Number</span><span class="p">(</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">F</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">?</span><span class="nb">Number</span><span class="p">(</span><span class="nx">F</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="nx">B</span><span class="o">=</span><span class="s2">&quot;[((#{fragment} - #{b}) mod #{a} = 0) and ((#{fragment} - #{b}) div #{a} &gt;= 0)]&quot;</span><span class="p">;</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="nx">B</span><span class="p">).</span><span class="nx">evaluate</span><span class="p">({</span><span class="nx">fragment</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">a</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="nx">A</span><span class="p">})}}}},</span><span class="nx">criteria</span><span class="o">:</span><span class="p">{</span><span class="nx">tagName</span><span class="o">:</span><span class="s1">&#39;n = h.tagName(n, r, &quot;#{1}&quot;, c);      c = false;&#39;</span><span class="p">,</span><span class="nx">className</span><span class="o">:</span><span class="s1">&#39;n = h.className(n, r, &quot;#{1}&quot;, c);    c = false;&#39;</span><span class="p">,</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;n = h.id(n, r, &quot;#{1}&quot;, c);           c = false;&#39;</span><span class="p">,</span><span class="nx">attrPresence</span><span class="o">:</span><span class="s1">&#39;n = h.attrPresence(n, r, &quot;#{1}&quot;, c); c = false;&#39;</span><span class="p">,</span><span class="nx">attr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">||</span><span class="nx">A</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="s1">&#39;n = h.attr(n, r, &quot;#{1}&quot;, &quot;#{3}&quot;, &quot;#{2}&quot;, c); c = false;&#39;</span><span class="p">).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">pseudo</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="mi">6</span><span class="p">]){</span><span class="nx">A</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="mi">6</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;/g</span><span class="p">,</span><span class="s1">&#39;\\&quot;&#39;</span><span class="p">)}</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="s1">&#39;n = h.pseudo(n, &quot;#{1}&quot;, &quot;#{6}&quot;, r, c); c = false;&#39;</span><span class="p">).</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">descendant</span><span class="o">:</span><span class="s1">&#39;c = &quot;descendant&quot;;&#39;</span><span class="p">,</span><span class="nx">child</span><span class="o">:</span><span class="s1">&#39;c = &quot;child&quot;;&#39;</span><span class="p">,</span><span class="nx">adjacent</span><span class="o">:</span><span class="s1">&#39;c = &quot;adjacent&quot;;&#39;</span><span class="p">,</span><span class="nx">laterSibling</span><span class="o">:</span><span class="s1">&#39;c = &quot;laterSibling&quot;;&#39;</span><span class="p">},</span><span class="nx">patterns</span><span class="o">:</span><span class="p">[{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;laterSibling&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^\s*~\s*/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;child&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^\s*&gt;\s*/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;adjacent&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^\s*\+\s*/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;descendant&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^\s/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;tagName&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^\s*(\*|[\w\-]+)(\b|$)?/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^#([\w\-\*]+)(\b|$)/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;className&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^\.([\w\-\*]+)(\b|$)/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;pseudo&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~&gt;]))/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;attrPresence&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/^\[((?:[\w-]+:)?[\w-]+)\]/</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;attr&quot;</span><span class="p">,</span><span class="nx">re</span><span class="o">:</span><span class="sr">/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*(([&#39;&quot;])([^\4]*?)\4|([^&#39;&quot;][^\]]*?)))?\]/</span><span class="p">}],</span><span class="nx">assertions</span><span class="o">:</span><span class="p">{</span><span class="nx">tagName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">==</span><span class="nx">A</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()},</span><span class="nx">className</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">hasClassName</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">[</span><span class="mi">1</span><span class="p">])},</span><span class="nx">id</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="o">===</span><span class="nx">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span><span class="nx">attrPresence</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">[</span><span class="mi">1</span><span class="p">])},</span><span class="nx">attr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">readAttribute</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">return</span> <span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">operators</span><span class="p">[</span><span class="nx">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]](</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">||</span><span class="nx">C</span><span class="p">[</span><span class="mi">6</span><span class="p">])}},</span><span class="nx">handlers</span><span class="o">:</span><span class="p">{</span><span class="nx">concat</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">mark</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="p">;</span><span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">B</span><span class="p">];</span><span class="nx">B</span><span class="o">++</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="o">=</span><span class="nx">D</span><span class="p">}</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">unmark</span><span class="o">:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">E</span><span class="o">=</span><span class="kc">false</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="s2">&quot;_countedByPrototype&quot;</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">;</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">===</span><span class="nx">C</span><span class="p">);</span><span class="nx">B</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">E</span><span class="p">})();</span><span class="k">return</span> <span class="nx">A</span><span class="o">?</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="s2">&quot;_countedByPrototype&quot;</span><span class="p">)}</span><span class="k">return</span> <span class="nx">B</span><span class="p">}</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="o">=</span><span class="k">void</span> <span class="mi">0</span><span class="p">}</span><span class="k">return</span> <span class="nx">B</span><span class="p">}})(),</span><span class="nx">index</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">G</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">E</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="nx">E</span><span class="o">--</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">G</span><span class="o">||</span><span class="nx">F</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="p">)){</span><span class="nx">F</span><span class="p">.</span><span class="nx">nodeIndex</span><span class="o">=</span><span class="nx">C</span><span class="o">++</span><span class="p">}}}</span><span class="k">else</span><span class="p">{</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="nx">E</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">G</span><span class="o">||</span><span class="nx">F</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="p">)){</span><span class="nx">F</span><span class="p">.</span><span class="nx">nodeIndex</span><span class="o">=</span><span class="nx">C</span><span class="o">++</span><span class="p">}}}},</span><span class="nx">unique</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">C</span><span class="o">&lt;</span><span class="nx">A</span><span class="p">;</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="p">(</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">]).</span><span class="nx">_countedByPrototype</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">E</span><span class="p">))}}</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">unmark</span><span class="p">(</span><span class="nx">D</span><span class="p">)},</span><span class="nx">descendant</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">B</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">E</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">))}</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">child</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="p">[],</span><span class="nx">F</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">G</span><span class="p">;</span><span class="nx">G</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">B</span><span class="p">];</span><span class="nx">B</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">G</span><span class="p">.</span><span class="nx">tagName</span><span class="o">!=</span><span class="s2">&quot;!&quot;</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">G</span><span class="p">)}}}</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="nx">adjacent</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">B</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">nextElementSibling</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">laterSibling</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">B</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">Element</span><span class="p">.</span><span class="nx">nextSiblings</span><span class="p">(</span><span class="nx">E</span><span class="p">))}</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">nextElementSibling</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">while</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}}</span><span class="k">return</span> <span class="kc">null</span><span class="p">},</span><span class="nx">previousElementSibling</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">while</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}}</span><span class="k">return</span> <span class="kc">null</span><span class="p">},</span><span class="nx">tagName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">H</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">I</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">[],</span><span class="nx">G</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;descendant&quot;</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">F</span><span class="p">];</span><span class="nx">F</span><span class="o">++</span><span class="p">){</span><span class="nx">G</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">D</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">C</span><span class="p">))}</span><span class="k">return</span> <span class="nx">E</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">B</span><span class="p">](</span><span class="nx">A</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;*&quot;</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">F</span><span class="p">];</span><span class="nx">F</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">===</span><span class="nx">I</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">E</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">return</span> <span class="nx">H</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">C</span><span class="p">)}},</span><span class="nx">id</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">I</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">G</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">I</span><span class="o">==</span><span class="nb">document</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">H</span><span class="p">){</span><span class="k">return</span><span class="p">[]}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">[</span><span class="nx">H</span><span class="p">]}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">I</span><span class="p">.</span><span class="nx">sourceIndex</span><span class="o">||</span><span class="nx">I</span><span class="p">.</span><span class="nx">sourceIndex</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">I</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="nx">E</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">id</span><span class="o">===</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span><span class="p">[</span><span class="nx">D</span><span class="p">]}}}}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;child&quot;</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">F</span><span class="p">];</span><span class="nx">F</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">H</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">==</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span><span class="p">[</span><span class="nx">H</span><span class="p">]}}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;descendant&quot;</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">F</span><span class="p">];</span><span class="nx">F</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">descendantOf</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">D</span><span class="p">)){</span><span class="k">return</span><span class="p">[</span><span class="nx">H</span><span class="p">]}}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">==</span><span class="s2">&quot;adjacent&quot;</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">F</span><span class="p">];</span><span class="nx">F</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">previousElementSibling</span><span class="p">(</span><span class="nx">H</span><span class="p">)</span><span class="o">==</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span><span class="p">[</span><span class="nx">H</span><span class="p">]}}}</span><span class="k">else</span><span class="p">{</span><span class="nx">A</span><span class="o">=</span><span class="nx">G</span><span class="p">[</span><span class="nx">C</span><span class="p">](</span><span class="nx">A</span><span class="p">)}}}}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">F</span><span class="p">];</span><span class="nx">F</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">==</span><span class="nx">H</span><span class="p">){</span><span class="k">return</span><span class="p">[</span><span class="nx">H</span><span class="p">]}}</span><span class="k">return</span><span class="p">[]}</span><span class="k">return</span><span class="p">(</span><span class="nx">H</span><span class="o">&amp;&amp;</span><span class="nx">Element</span><span class="p">.</span><span class="nx">descendantOf</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">I</span><span class="p">))</span><span class="o">?</span><span class="p">[</span><span class="nx">H</span><span class="p">]</span><span class="o">:</span><span class="p">[]},</span><span class="nx">className</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">&amp;&amp;</span><span class="nx">D</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">D</span><span class="p">](</span><span class="nx">B</span><span class="p">)}</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">byClassName</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">)},</span><span class="nx">byClassName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">descendant</span><span class="p">([</span><span class="nx">B</span><span class="p">])}</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">F</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="p">[],</span><span class="nx">G</span><span class="p">,</span><span class="nx">A</span><span class="p">;</span><span class="nx">G</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="nx">E</span><span class="o">++</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">className</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span><span class="k">continue</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">==</span><span class="nx">F</span><span class="o">||</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">include</span><span class="p">(</span><span class="nx">H</span><span class="p">)){</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">G</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">D</span><span class="p">},</span><span class="nx">attrPresence</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">G</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">&amp;&amp;</span><span class="nx">G</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">G</span><span class="p">](</span><span class="nx">C</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">F</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="p">)){</span><span class="nx">E</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">F</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">E</span><span class="p">},</span><span class="nx">attr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">I</span><span class="p">,</span><span class="nx">H</span><span class="p">,</span><span class="nx">J</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">I</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">B</span><span class="p">](</span><span class="nx">A</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">K</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">operators</span><span class="p">[</span><span class="nx">C</span><span class="p">],</span><span class="nx">F</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="nx">E</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">readAttribute</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">H</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="o">===</span><span class="kc">null</span><span class="p">){</span><span class="k">continue</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">K</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">J</span><span class="p">)){</span><span class="nx">F</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">F</span><span class="p">},</span><span class="nx">pseudo</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">E</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">&amp;&amp;</span><span class="nx">D</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">D</span><span class="p">](</span><span class="nx">B</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)}</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">[</span><span class="nx">C</span><span class="p">](</span><span class="nx">B</span><span class="p">,</span><span class="nx">E</span><span class="p">,</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">pseudos</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;first-child&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">previousElementSibling</span><span class="p">(</span><span class="nx">E</span><span class="p">)){</span><span class="k">continue</span><span class="p">}</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">E</span><span class="p">)}</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="s2">&quot;last-child&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">nextElementSibling</span><span class="p">(</span><span class="nx">E</span><span class="p">)){</span><span class="k">continue</span><span class="p">}</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">E</span><span class="p">)}</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="s2">&quot;only-child&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">G</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="p">[],</span><span class="nx">F</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">E</span><span class="p">.</span><span class="nx">previousElementSibling</span><span class="p">(</span><span class="nx">F</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">E</span><span class="p">.</span><span class="nx">nextElementSibling</span><span class="p">(</span><span class="nx">F</span><span class="p">)){</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">F</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="s2">&quot;nth-child&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;nth-last-child&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="kc">true</span><span class="p">)},</span><span class="s2">&quot;nth-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="kc">true</span><span class="p">)},</span><span class="s2">&quot;nth-last-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="kc">true</span><span class="p">,</span><span class="kc">true</span><span class="p">)},</span><span class="s2">&quot;first-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="kc">true</span><span class="p">)},</span><span class="s2">&quot;last-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="kc">true</span><span class="p">,</span><span class="kc">true</span><span class="p">)},</span><span class="s2">&quot;only-of-type&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">;</span><span class="k">return</span> <span class="nx">C</span><span class="p">[</span><span class="s2">&quot;last-of-type&quot;</span><span class="p">](</span><span class="nx">C</span><span class="p">[</span><span class="s2">&quot;first-of-type&quot;</span><span class="p">](</span><span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">),</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">getIndices</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">?</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">:</span><span class="p">[]}</span><span class="k">return</span> <span class="nx">$R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">C</span><span class="p">).</span><span class="nx">inject</span><span class="p">([],</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="mi">0</span><span class="o">==</span><span class="p">(</span><span class="nx">E</span><span class="o">-</span><span class="nx">A</span><span class="p">)</span><span class="o">%</span><span class="nx">B</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">E</span><span class="o">-</span><span class="nx">A</span><span class="p">)</span><span class="o">/</span><span class="nx">B</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">E</span><span class="p">)}</span><span class="k">return</span> <span class="nx">D</span><span class="p">})},</span><span class="nx">nth</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">L</span><span class="p">,</span><span class="nx">N</span><span class="p">,</span><span class="nx">K</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span><span class="k">return</span><span class="p">[]}</span><span class="k">if</span><span class="p">(</span><span class="nx">L</span><span class="o">==</span><span class="s2">&quot;even&quot;</span><span class="p">){</span><span class="nx">L</span><span class="o">=</span><span class="s2">&quot;2n+0&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">L</span><span class="o">==</span><span class="s2">&quot;odd&quot;</span><span class="p">){</span><span class="nx">L</span><span class="o">=</span><span class="s2">&quot;2n+1&quot;</span><span class="p">}</span><span class="kd">var</span> <span class="nx">J</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">,</span><span class="nx">I</span><span class="o">=</span><span class="p">[],</span><span class="nx">B</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">J</span><span class="p">.</span><span class="nx">mark</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">H</span><span class="p">];</span><span class="nx">H</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="p">){</span><span class="nx">J</span><span class="p">.</span><span class="nx">index</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">K</span><span class="p">,</span><span class="nx">C</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)}}</span><span class="k">if</span><span class="p">(</span><span class="nx">L</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^\d+$/</span><span class="p">)){</span><span class="nx">L</span><span class="o">=</span><span class="nb">Number</span><span class="p">(</span><span class="nx">L</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">H</span><span class="p">];</span><span class="nx">H</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">nodeIndex</span><span class="o">==</span><span class="nx">L</span><span class="p">){</span><span class="nx">I</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">=</span><span class="nx">L</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^(-?\d*)?n(([+-])(\d+))?/</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;-&quot;</span><span class="p">){</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">}</span><span class="kd">var</span> <span class="nx">O</span><span class="o">=</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="nb">Number</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span><span class="kd">var</span> <span class="nx">M</span><span class="o">=</span><span class="nx">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">?</span><span class="nb">Number</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="kd">var</span> <span class="nx">P</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">pseudos</span><span class="p">.</span><span class="nx">getIndices</span><span class="p">(</span><span class="nx">O</span><span class="p">,</span><span class="nx">M</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">F</span><span class="o">=</span><span class="nx">P</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">H</span><span class="p">];</span><span class="nx">H</span><span class="o">++</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">G</span><span class="o">&lt;</span><span class="nx">F</span><span class="p">;</span><span class="nx">G</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">nodeIndex</span><span class="o">==</span><span class="nx">P</span><span class="p">[</span><span class="nx">G</span><span class="p">]){</span><span class="nx">I</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}}}}</span><span class="nx">J</span><span class="p">.</span><span class="nx">unmark</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">J</span><span class="p">.</span><span class="nx">unmark</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">I</span><span class="p">},</span><span class="nx">empty</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">tagName</span><span class="o">==</span><span class="s2">&quot;!&quot;</span><span class="o">||</span><span class="nx">E</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">){</span><span class="k">continue</span><span class="p">}</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">E</span><span class="p">)}</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="nx">not</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">I</span><span class="p">){</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">,</span><span class="nx">J</span><span class="p">,</span><span class="nx">C</span><span class="p">;</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="k">new</span> <span class="nx">Selector</span><span class="p">(</span><span class="nx">D</span><span class="p">).</span><span class="nx">findElements</span><span class="p">(</span><span class="nx">I</span><span class="p">);</span><span class="nx">G</span><span class="p">.</span><span class="nx">mark</span><span class="p">(</span><span class="nx">H</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="p">[],</span><span class="nx">B</span><span class="p">;</span><span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">F</span><span class="p">];</span><span class="nx">F</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">B</span><span class="p">)}}</span><span class="nx">G</span><span class="p">.</span><span class="nx">unmark</span><span class="p">(</span><span class="nx">H</span><span class="p">);</span><span class="k">return</span> <span class="nx">E</span><span class="p">},</span><span class="nx">enabled</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">E</span><span class="p">.</span><span class="nx">disabled</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">E</span><span class="p">.</span><span class="nx">type</span><span class="o">||</span><span class="nx">E</span><span class="p">.</span><span class="nx">type</span><span class="o">!==</span><span class="s2">&quot;hidden&quot;</span><span class="p">)){</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">E</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="nx">disabled</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">disabled</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">E</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="nx">checked</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="p">[],</span><span class="nx">E</span><span class="p">;</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">checked</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">E</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">C</span><span class="p">}},</span><span class="nx">operators</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;=&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="o">==</span><span class="nx">A</span><span class="p">},</span><span class="s2">&quot;!=&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="o">!=</span><span class="nx">A</span><span class="p">},</span><span class="s2">&quot;^=&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="o">==</span><span class="nx">A</span><span class="o">||</span><span class="nx">B</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;$=&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="o">==</span><span class="nx">A</span><span class="o">||</span><span class="nx">B</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;*=&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="o">==</span><span class="nx">A</span><span class="o">||</span><span class="nx">B</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="s2">&quot;~=&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">B</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">)},</span><span class="s2">&quot;|=&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">B</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="p">).</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">A</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="p">)}},</span><span class="nx">split</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">[];</span><span class="nx">B</span><span class="p">.</span><span class="nx">scan</span><span class="p">(</span><span class="sr">/(([\w#:.~&gt;+()\s-]+|\*|\[.*?\])+)\s*(,|$)/</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">strip</span><span class="p">())});</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">matchElements</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">G</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nx">$$</span><span class="p">(</span><span class="nx">G</span><span class="p">),</span><span class="nx">D</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">mark</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">B</span><span class="o">=</span><span class="p">[],</span><span class="nx">A</span><span class="p">;</span><span class="nx">A</span><span class="o">=</span><span class="nx">F</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">_countedByPrototype</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">A</span><span class="p">)}}</span><span class="nx">D</span><span class="p">.</span><span class="nx">unmark</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="k">return</span> <span class="nx">B</span><span class="p">},</span><span class="nx">findElement</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="nx">A</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="nx">C</span><span class="o">=</span><span class="kc">false</span><span class="p">}</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">matchElements</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="o">||</span><span class="s2">&quot;*&quot;</span><span class="p">)[</span><span class="nx">A</span><span class="o">||</span><span class="mi">0</span><span class="p">]},</span><span class="nx">findChildElements</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">G</span><span class="p">){</span><span class="nx">G</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">G</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">));</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">[],</span><span class="nx">F</span><span class="o">=</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">B</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">A</span><span class="p">;</span><span class="nx">C</span><span class="o">&lt;</span><span class="nx">B</span><span class="p">;</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="k">new</span> <span class="nx">Selector</span><span class="p">(</span><span class="nx">G</span><span class="p">[</span><span class="nx">C</span><span class="p">].</span><span class="nx">strip</span><span class="p">());</span><span class="nx">F</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">findElements</span><span class="p">(</span><span class="nx">E</span><span class="p">))}</span><span class="k">return</span><span class="p">(</span><span class="nx">B</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">?</span><span class="nx">F</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">:</span><span class="nx">D</span><span class="p">}});</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">handlers</span><span class="p">,{</span><span class="nx">concat</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">tagName</span><span class="o">!==</span><span class="s2">&quot;!&quot;</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">B</span><span class="p">}})}</span><span class="kd">function</span> <span class="nx">$$</span><span class="p">(){</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">findChildElements</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="nx">$A</span><span class="p">(</span><span class="nx">arguments</span><span class="p">))}</span><span class="kd">var</span> <span class="nx">Form</span><span class="o">=</span><span class="p">{</span><span class="nx">reset</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">serializeElements</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">B</span><span class="o">!=</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="p">{</span><span class="nx">hash</span><span class="o">:!!</span><span class="nx">B</span><span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">hash</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">hash</span><span class="o">=</span><span class="kc">true</span><span class="p">}}</span><span class="kd">var</span> <span class="nx">C</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="kc">false</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">submit</span><span class="p">;</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">inject</span><span class="p">({},</span><span class="kd">function</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">I</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">I</span><span class="p">.</span><span class="nx">disabled</span><span class="o">&amp;&amp;</span><span class="nx">I</span><span class="p">.</span><span class="nx">name</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">I</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">I</span><span class="p">).</span><span class="nx">getValue</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="nx">I</span><span class="p">.</span><span class="nx">type</span><span class="o">!=</span><span class="s2">&quot;file&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">I</span><span class="p">.</span><span class="nx">type</span><span class="o">!=</span><span class="s2">&quot;submit&quot;</span><span class="o">||</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nx">E</span><span class="o">!==</span><span class="kc">false</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">E</span><span class="o">||</span><span class="nx">C</span><span class="o">==</span><span class="nx">E</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">A</span><span class="o">=</span><span class="kc">true</span><span class="p">)))){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span> <span class="k">in</span> <span class="nx">H</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">H</span><span class="p">[</span><span class="nx">C</span><span class="p">])){</span><span class="nx">H</span><span class="p">[</span><span class="nx">C</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="nx">H</span><span class="p">[</span><span class="nx">C</span><span class="p">]]}</span><span class="nx">H</span><span class="p">[</span><span class="nx">C</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">F</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">H</span><span class="p">[</span><span class="nx">C</span><span class="p">]</span><span class="o">=</span><span class="nx">F</span><span class="p">}}}</span><span class="k">return</span> <span class="nx">H</span><span class="p">});</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">hash</span><span class="o">?</span><span class="nx">D</span><span class="o">:</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toQueryString</span><span class="p">(</span><span class="nx">D</span><span class="p">)}};</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Methods</span><span class="o">=</span><span class="p">{</span><span class="nx">serialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">serializeElements</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">getElements</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">A</span><span class="p">)},</span><span class="nx">getElements</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">E</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">),</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="p">[],</span><span class="nx">C</span><span class="o">=</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Serializers</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">F</span><span class="p">[</span><span class="nx">B</span><span class="p">];</span><span class="nx">B</span><span class="o">++</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">D</span><span class="p">)}</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">inject</span><span class="p">([],</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">H</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">H</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()]){</span><span class="nx">G</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">H</span><span class="p">))}</span><span class="k">return</span> <span class="nx">G</span><span class="p">})},</span><span class="nx">getInputs</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="nx">G</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">G</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="o">&amp;&amp;!</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">$A</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">)}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">H</span><span class="o">=</span><span class="p">[],</span><span class="nx">F</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">E</span><span class="o">&lt;</span><span class="nx">F</span><span class="p">;</span><span class="nx">E</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="k">if</span><span class="p">((</span><span class="nx">C</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">type</span><span class="o">!=</span><span class="nx">C</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">D</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">name</span><span class="o">!=</span><span class="nx">D</span><span class="p">)){</span><span class="k">continue</span><span class="p">}</span><span class="nx">H</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">B</span><span class="p">))}</span><span class="k">return</span> <span class="nx">H</span><span class="p">},</span><span class="nx">disable</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">Form</span><span class="p">.</span><span class="nx">getElements</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">invoke</span><span class="p">(</span><span class="s2">&quot;disable&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">enable</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">Form</span><span class="p">.</span><span class="nx">getElements</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">invoke</span><span class="p">(</span><span class="s2">&quot;enable&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">findFirstElement</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">).</span><span class="nx">getElements</span><span class="p">().</span><span class="nx">findAll</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;hidden&quot;</span><span class="o">!=</span><span class="nx">D</span><span class="p">.</span><span class="nx">type</span><span class="o">&amp;&amp;!</span><span class="nx">D</span><span class="p">.</span><span class="nx">disabled</span><span class="p">});</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="s2">&quot;tabIndex&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">D</span><span class="p">.</span><span class="nx">tabIndex</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">}).</span><span class="nx">sortBy</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">tabIndex</span><span class="p">}).</span><span class="nx">first</span><span class="p">();</span><span class="k">return</span> <span class="nx">A</span><span class="o">?</span><span class="nx">A</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span><span class="sr">/^(?:input|select|textarea)$/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">tagName</span><span class="p">)})},</span><span class="nx">focusFirstElement</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">findFirstElement</span><span class="p">().</span><span class="nx">activate</span><span class="p">();</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">request</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">A</span><span class="o">||</span><span class="p">{});</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">parameters</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">readAttribute</span><span class="p">(</span><span class="s2">&quot;action&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">blank</span><span class="p">()){</span><span class="nx">C</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">}</span><span class="nx">A</span><span class="p">.</span><span class="nx">parameters</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">D</span><span class="p">)){</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">toQueryParams</span><span class="p">()}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">parameters</span><span class="p">,</span><span class="nx">D</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">A</span><span class="p">.</span><span class="nx">method</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">method</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">method</span><span class="p">}</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)}};</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="o">=</span><span class="p">{</span><span class="nx">focus</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">focus</span><span class="p">();</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">select</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">select</span><span class="p">();</span><span class="k">return</span> <span class="nx">A</span><span class="p">}};</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="o">=</span><span class="p">{</span><span class="nx">serialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">.</span><span class="nx">disabled</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">name</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">!=</span><span class="kc">undefined</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="p">{};</span><span class="nx">C</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">toQueryString</span><span class="p">(</span><span class="nx">C</span><span class="p">)}}</span><span class="k">return</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="nx">getValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Serializers</span><span class="p">[</span><span class="nx">B</span><span class="p">](</span><span class="nx">A</span><span class="p">)},</span><span class="nx">setValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Serializers</span><span class="p">[</span><span class="nx">C</span><span class="p">](</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">clear</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">present</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">value</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="nx">activate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="nx">A</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">select</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">!=</span><span class="s2">&quot;input&quot;</span><span class="o">||!</span><span class="p">(</span><span class="sr">/^(?:button|reset|submit)$/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">type</span><span class="p">)))){</span><span class="nx">A</span><span class="p">.</span><span class="nx">select</span><span class="p">()}}</span><span class="k">catch</span><span class="p">(</span><span class="nx">B</span><span class="p">){}</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">disable</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">enable</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="p">}};</span><span class="kd">var</span> <span class="nx">Field</span><span class="o">=</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">;</span><span class="kd">var</span> <span class="nx">$F</span><span class="o">=</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">getValue</span><span class="p">;</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Serializers</span><span class="o">=</span><span class="p">{</span><span class="nx">input</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">switch</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()){</span><span class="k">case</span><span class="s2">&quot;checkbox&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;radio&quot;</span><span class="o">:</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Serializers</span><span class="p">.</span><span class="nx">inputSelector</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">default</span><span class="o">:</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Serializers</span><span class="p">.</span><span class="nx">textarea</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">)}},</span><span class="nx">inputSelector</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">B</span><span class="p">)){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">checked</span><span class="o">?</span><span class="nx">A</span><span class="p">.</span><span class="nx">value</span><span class="o">:</span><span class="kc">null</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">A</span><span class="p">.</span><span class="nx">checked</span><span class="o">=!!</span><span class="nx">B</span><span class="p">}},</span><span class="nx">textarea</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">B</span><span class="p">)){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">value</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">A</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">B</span><span class="p">}},</span><span class="nx">select</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">F</span><span class="p">)){</span><span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="nx">C</span><span class="p">.</span><span class="nx">type</span><span class="o">==</span><span class="s2">&quot;select-one&quot;</span><span class="o">?</span><span class="s2">&quot;selectOne&quot;</span><span class="o">:</span><span class="s2">&quot;selectMany&quot;</span><span class="p">](</span><span class="nx">C</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="kd">var</span> <span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">G</span><span class="o">=!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">F</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">A</span><span class="o">&lt;</span><span class="nx">E</span><span class="p">;</span><span class="nx">A</span><span class="o">++</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">A</span><span class="p">];</span><span class="nx">D</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">optionValue</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">==</span><span class="nx">F</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">selected</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">return</span> <span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="nx">B</span><span class="p">.</span><span class="nx">selected</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}}},</span><span class="nx">selectOne</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">optionValue</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">A</span><span class="p">])</span><span class="o">:</span><span class="kc">null</span><span class="p">},</span><span class="nx">selectMany</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">E</span><span class="p">){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="p">[];</span><span class="nx">C</span><span class="o">&lt;</span><span class="nx">E</span><span class="p">;</span><span class="nx">C</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">C</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">selected</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">optionValue</span><span class="p">(</span><span class="nx">B</span><span class="p">))}}</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">optionValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">?</span><span class="nx">A</span><span class="p">.</span><span class="nx">value</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">text</span><span class="p">}};</span><span class="nx">Abstract</span><span class="p">.</span><span class="nx">TimedObserver</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">PeriodicalExecuter</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">$super</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="nx">$super</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()},</span><span class="nx">execute</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">!=</span><span class="nx">A</span><span class="o">:</span><span class="nb">String</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="p">)</span><span class="o">!=</span><span class="nb">String</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">=</span><span class="nx">A</span><span class="p">}}});</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Observer</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Abstract</span><span class="p">.</span><span class="nx">TimedObserver</span><span class="p">,{</span><span class="nx">getValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}});</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Observer</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Abstract</span><span class="p">.</span><span class="nx">TimedObserver</span><span class="p">,{</span><span class="nx">getValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}});</span><span class="nx">Abstract</span><span class="p">.</span><span class="nx">EventObserver</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;form&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">registerFormCallbacks</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">registerCallback</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}},</span><span class="nx">onElementEvent</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">!=</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">=</span><span class="nx">A</span><span class="p">}},</span><span class="nx">registerFormCallbacks</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Form</span><span class="p">.</span><span class="nx">getElements</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">registerCallback</span><span class="p">,</span><span class="k">this</span><span class="p">)},</span><span class="nx">registerCallback</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">type</span><span class="p">){</span><span class="k">switch</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()){</span><span class="k">case</span><span class="s2">&quot;checkbox&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;radio&quot;</span><span class="o">:</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">onElementEvent</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">break</span><span class="p">;</span><span class="k">default</span><span class="o">:</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;change&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">onElementEvent</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">break</span><span class="p">}}}});</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">EventObserver</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Abstract</span><span class="p">.</span><span class="nx">EventObserver</span><span class="p">,{</span><span class="nx">getValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}});</span><span class="nx">Form</span><span class="p">.</span><span class="nx">EventObserver</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Abstract</span><span class="p">.</span><span class="nx">EventObserver</span><span class="p">,{</span><span class="nx">getValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}});(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">V</span><span class="o">=</span><span class="p">{</span><span class="nx">KEY_BACKSPACE</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span><span class="nx">KEY_TAB</span><span class="o">:</span><span class="mi">9</span><span class="p">,</span><span class="nx">KEY_RETURN</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="nx">KEY_ESC</span><span class="o">:</span><span class="mi">27</span><span class="p">,</span><span class="nx">KEY_LEFT</span><span class="o">:</span><span class="mi">37</span><span class="p">,</span><span class="nx">KEY_UP</span><span class="o">:</span><span class="mi">38</span><span class="p">,</span><span class="nx">KEY_RIGHT</span><span class="o">:</span><span class="mi">39</span><span class="p">,</span><span class="nx">KEY_DOWN</span><span class="o">:</span><span class="mi">40</span><span class="p">,</span><span class="nx">KEY_DELETE</span><span class="o">:</span><span class="mi">46</span><span class="p">,</span><span class="nx">KEY_HOME</span><span class="o">:</span><span class="mi">36</span><span class="p">,</span><span class="nx">KEY_END</span><span class="o">:</span><span class="mi">35</span><span class="p">,</span><span class="nx">KEY_PAGEUP</span><span class="o">:</span><span class="mi">33</span><span class="p">,</span><span class="nx">KEY_PAGEDOWN</span><span class="o">:</span><span class="mi">34</span><span class="p">,</span><span class="nx">KEY_INSERT</span><span class="o">:</span><span class="mi">45</span><span class="p">,</span><span class="nx">cache</span><span class="o">:</span><span class="p">{}};</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span><span class="kd">var</span> <span class="nx">W</span><span class="o">=</span><span class="s2">&quot;onmouseenter&quot;</span> <span class="k">in</span> <span class="nx">E</span><span class="o">&amp;&amp;</span><span class="s2">&quot;onmouseleave&quot;</span> <span class="k">in</span> <span class="nx">E</span><span class="p">;</span><span class="kd">var</span> <span class="nx">O</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">){</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="p">};</span><span class="nx">O</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">button</span><span class="o">===</span><span class="nx">H</span><span class="p">[</span><span class="nx">X</span><span class="p">]}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="p">){</span><span class="nx">O</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="k">switch</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="k">case</span> <span class="mi">0</span><span class="o">:</span><span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">which</span><span class="o">==</span><span class="mi">1</span><span class="o">&amp;&amp;!</span><span class="nx">Y</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span><span class="k">case</span> <span class="mi">1</span><span class="o">:</span><span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">which</span><span class="o">==</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">Y</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span><span class="k">default</span><span class="o">:</span><span class="k">return</span> <span class="kc">false</span><span class="p">}}}</span><span class="k">else</span><span class="p">{</span><span class="nx">O</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">which</span><span class="o">?</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">which</span><span class="o">===</span><span class="nx">X</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">button</span><span class="o">===</span><span class="nx">X</span><span class="p">)}}}</span><span class="kd">function</span> <span class="nx">R</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="k">return</span> <span class="nx">O</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">Q</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="k">return</span> <span class="nx">O</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">K</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="k">return</span> <span class="nx">O</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">Z</span><span class="p">){</span><span class="nx">Z</span><span class="o">=</span><span class="nx">V</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Z</span><span class="p">);</span><span class="kd">var</span> <span class="nx">Y</span><span class="o">=</span><span class="nx">Z</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span><span class="nx">X</span><span class="o">=</span><span class="nx">Z</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="nx">Z</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">tagName</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">X</span><span class="o">===</span><span class="s2">&quot;load&quot;</span><span class="o">||</span><span class="nx">X</span><span class="o">===</span><span class="s2">&quot;error&quot;</span><span class="o">||</span><span class="p">(</span><span class="nx">X</span><span class="o">===</span><span class="s2">&quot;click&quot;</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">===</span><span class="s2">&quot;radio&quot;</span><span class="p">)){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">a</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="nx">Node</span><span class="p">.</span><span class="nx">TEXT_NODE</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="nx">Y</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Y</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">M</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="nx">V</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">Y</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">X</span><span class="p">}</span><span class="kd">var</span> <span class="nx">Z</span><span class="o">=</span><span class="p">[</span><span class="nx">X</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">X</span><span class="p">.</span><span class="nx">ancestors</span><span class="p">());</span><span class="k">return</span> <span class="nx">Selector</span><span class="p">.</span><span class="nx">findElement</span><span class="p">(</span><span class="nx">Z</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">P</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="k">return</span><span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="nx">B</span><span class="p">(</span><span class="nx">X</span><span class="p">),</span><span class="nx">y</span><span class="o">:</span><span class="nx">A</span><span class="p">(</span><span class="nx">X</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">Z</span><span class="p">){</span><span class="kd">var</span> <span class="nx">Y</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span><span class="nx">X</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="o">||</span><span class="p">{</span><span class="nx">scrollLeft</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span><span class="k">return</span> <span class="nx">Z</span><span class="p">.</span><span class="nx">pageX</span><span class="o">||</span><span class="p">(</span><span class="nx">Z</span><span class="p">.</span><span class="nx">clientX</span><span class="o">+</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="nx">X</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">clientLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">))}</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">Z</span><span class="p">){</span><span class="kd">var</span> <span class="nx">Y</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span><span class="nx">X</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="o">||</span><span class="p">{</span><span class="nx">scrollTop</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span><span class="k">return</span> <span class="nx">Z</span><span class="p">.</span><span class="nx">pageY</span><span class="o">||</span><span class="p">(</span><span class="nx">Z</span><span class="p">.</span><span class="nx">clientY</span><span class="o">+</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="nx">X</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">clientTop</span><span class="o">||</span><span class="mi">0</span><span class="p">))}</span><span class="kd">function</span> <span class="nx">N</span><span class="p">(</span><span class="nx">X</span><span class="p">){</span><span class="nx">V</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">X</span><span class="p">);</span><span class="nx">X</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span><span class="nx">X</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span><span class="nx">X</span><span class="p">.</span><span class="nx">stopped</span><span class="o">=</span><span class="kc">true</span><span class="p">}</span><span class="nx">V</span><span class="p">.</span><span class="nx">Methods</span><span class="o">=</span><span class="p">{</span><span class="nx">isLeftClick</span><span class="o">:</span><span class="nx">R</span><span class="p">,</span><span class="nx">isMiddleClick</span><span class="o">:</span><span class="nx">Q</span><span class="p">,</span><span class="nx">isRightClick</span><span class="o">:</span><span class="nx">K</span><span class="p">,</span><span class="nx">element</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">findElement</span><span class="o">:</span><span class="nx">M</span><span class="p">,</span><span class="nx">pointer</span><span class="o">:</span><span class="nx">P</span><span class="p">,</span><span class="nx">pointerX</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">pointerY</span><span class="o">:</span><span class="nx">A</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">N</span><span class="p">};</span><span class="kd">var</span> <span class="nx">T</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">V</span><span class="p">.</span><span class="nx">Methods</span><span class="p">).</span><span class="nx">inject</span><span class="p">({},</span><span class="kd">function</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">Y</span><span class="p">){</span><span class="nx">X</span><span class="p">[</span><span class="nx">Y</span><span class="p">]</span><span class="o">=</span><span class="nx">V</span><span class="p">.</span><span class="nx">Methods</span><span class="p">[</span><span class="nx">Y</span><span class="p">].</span><span class="nx">methodize</span><span class="p">();</span><span class="k">return</span> <span class="nx">X</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">){</span><span class="kd">function</span> <span class="nx">G</span><span class="p">(</span><span class="nx">Y</span><span class="p">){</span><span class="kd">var</span> <span class="nx">X</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">type</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;mouseover&quot;</span><span class="o">:</span><span class="nx">X</span><span class="o">=</span><span class="nx">Y</span><span class="p">.</span><span class="nx">fromElement</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;mouseout&quot;</span><span class="o">:</span><span class="nx">X</span><span class="o">=</span><span class="nx">Y</span><span class="p">.</span><span class="nx">toElement</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">default</span><span class="o">:</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">X</span><span class="p">)}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">T</span><span class="p">,{</span><span class="nx">stopPropagation</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">cancelBubble</span><span class="o">=</span><span class="kc">true</span><span class="p">},</span><span class="nx">preventDefault</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">returnValue</span><span class="o">=</span><span class="kc">false</span><span class="p">},</span><span class="nx">inspect</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="s2">&quot;[object Event]&quot;</span><span class="p">}});</span><span class="nx">V</span><span class="p">.</span><span class="nx">extend</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Y</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">_extendedByPrototype</span><span class="p">){</span><span class="k">return</span> <span class="nx">Y</span><span class="p">}</span><span class="nx">Y</span><span class="p">.</span><span class="nx">_extendedByPrototype</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">;</span><span class="kd">var</span> <span class="nx">Z</span><span class="o">=</span><span class="nx">V</span><span class="p">.</span><span class="nx">pointer</span><span class="p">(</span><span class="nx">Y</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Y</span><span class="p">,{</span><span class="nx">target</span><span class="o">:</span><span class="nx">Y</span><span class="p">.</span><span class="nx">srcElement</span><span class="o">||</span><span class="nx">X</span><span class="p">,</span><span class="nx">relatedTarget</span><span class="o">:</span><span class="nx">G</span><span class="p">(</span><span class="nx">Y</span><span class="p">),</span><span class="nx">pageX</span><span class="o">:</span><span class="nx">Z</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span><span class="nx">pageY</span><span class="o">:</span><span class="nx">Z</span><span class="p">.</span><span class="nx">y</span><span class="p">});</span><span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="nx">T</span><span class="p">)}}</span><span class="k">else</span><span class="p">{</span><span class="nx">V</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">prototype</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">(</span><span class="s2">&quot;HTMLEvents&quot;</span><span class="p">).</span><span class="nx">__proto__</span><span class="p">;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">V</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span><span class="nx">T</span><span class="p">);</span><span class="nx">V</span><span class="p">.</span><span class="nx">extend</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">}</span><span class="kd">function</span> <span class="nx">L</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">Z</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="s2">&quot;prototype_event_registry&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">Z</span><span class="p">)){</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="nx">Z</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="s2">&quot;prototype_event_registry&quot;</span><span class="p">,</span><span class="nx">$H</span><span class="p">())}</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="nx">Z</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">X</span><span class="p">)){</span><span class="nx">X</span><span class="o">=</span><span class="p">[];</span><span class="nx">Z</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">X</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">X</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s2">&quot;handler&quot;</span><span class="p">).</span><span class="nx">include</span><span class="p">(</span><span class="nx">c</span><span class="p">)){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="kd">var</span> <span class="nx">Y</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)){</span><span class="nx">Y</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">eventName</span><span class="p">)){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">eventName</span><span class="o">!==</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="nx">V</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">)}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">W</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="s2">&quot;mouseenter&quot;</span><span class="o">||</span><span class="nx">a</span><span class="o">===</span><span class="s2">&quot;mouseleave&quot;</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="s2">&quot;mouseenter&quot;</span><span class="o">||</span><span class="nx">a</span><span class="o">===</span><span class="s2">&quot;mouseleave&quot;</span><span class="p">){</span><span class="nx">Y</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">){</span><span class="nx">V</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">relatedTarget</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="o">!==</span><span class="nx">b</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="nx">d</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">f</span><span class="p">)}}}</span><span class="k">else</span><span class="p">{</span><span class="nx">Y</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="nx">V</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">)}}}</span><span class="nx">Y</span><span class="p">.</span><span class="nx">handler</span><span class="o">=</span><span class="nx">c</span><span class="p">;</span><span class="nx">X</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Y</span><span class="p">);</span><span class="k">return</span> <span class="nx">Y</span><span class="p">}</span><span class="kd">function</span> <span class="nx">F</span><span class="p">(){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">Y</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">X</span><span class="o">&lt;</span><span class="nx">Y</span><span class="p">;</span><span class="nx">X</span><span class="o">++</span><span class="p">){</span><span class="nx">V</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nx">D</span><span class="p">[</span><span class="nx">X</span><span class="p">]);</span><span class="nx">D</span><span class="p">[</span><span class="nx">X</span><span class="p">]</span><span class="o">=</span><span class="kc">null</span><span class="p">}}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;onunload&quot;</span><span class="p">,</span><span class="nx">F</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;unload&quot;</span><span class="p">,</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">,</span><span class="kc">false</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">J</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">W</span><span class="p">){</span><span class="nx">J</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">){</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="p">{</span><span class="nx">mouseenter</span><span class="o">:</span><span class="s2">&quot;mouseover&quot;</span><span class="p">,</span><span class="nx">mouseleave</span><span class="o">:</span><span class="s2">&quot;mouseout&quot;</span><span class="p">};</span><span class="k">return</span> <span class="nx">Y</span> <span class="k">in</span> <span class="nx">X</span><span class="o">?</span><span class="nx">X</span><span class="p">[</span><span class="nx">Y</span><span class="p">]</span><span class="o">:</span><span class="nx">Y</span><span class="p">}}</span><span class="kd">function</span> <span class="nx">S</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="kd">var</span> <span class="nx">Y</span><span class="o">=</span><span class="nx">L</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Y</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">Z</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;dataavailable&quot;</span><span class="p">,</span><span class="nx">Y</span><span class="p">,</span><span class="kc">false</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">a</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;ondataavailable&quot;</span><span class="p">,</span><span class="nx">Y</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;onfilterchange&quot;</span><span class="p">,</span><span class="nx">Y</span><span class="p">)}}</span><span class="k">else</span><span class="p">{</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="nx">J</span><span class="p">(</span><span class="nx">Z</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">Y</span><span class="p">,</span><span class="kc">false</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">a</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">X</span><span class="p">,</span><span class="nx">Y</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">a</span><span class="p">}</span><span class="kd">function</span> <span class="nx">I</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span><span class="kd">var</span> <span class="nx">Z</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;prototype_event_registry&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">Z</span><span class="p">)){</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;!</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">Z</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">b</span><span class="p">)){</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="nx">b</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">handler</span><span class="p">)});</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="p">){</span><span class="nx">Z</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">h</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">h</span><span class="p">.</span><span class="nx">handler</span><span class="p">)})});</span><span class="k">return</span> <span class="nx">c</span><span class="p">}}</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">Z</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">Y</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">handler</span><span class="o">===</span><span class="nx">d</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Y</span><span class="p">){</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="kd">var</span> <span class="nx">X</span><span class="o">=</span><span class="nx">J</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">){</span><span class="nx">c</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;dataavailable&quot;</span><span class="p">,</span><span class="nx">Y</span><span class="p">,</span><span class="kc">false</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">c</span><span class="p">.</span><span class="nx">detachEvent</span><span class="p">(</span><span class="s2">&quot;ondataavailable&quot;</span><span class="p">,</span><span class="nx">Y</span><span class="p">);</span><span class="nx">c</span><span class="p">.</span><span class="nx">detachEvent</span><span class="p">(</span><span class="s2">&quot;onfilterchange&quot;</span><span class="p">,</span><span class="nx">Y</span><span class="p">)}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">){</span><span class="nx">c</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span><span class="nx">Y</span><span class="p">,</span><span class="kc">false</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">c</span><span class="p">.</span><span class="nx">detachEvent</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">X</span><span class="p">,</span><span class="nx">Y</span><span class="p">)}}</span><span class="nx">Z</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">without</span><span class="p">(</span><span class="nx">Y</span><span class="p">));</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="kd">function</span> <span class="nx">U</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">Z</span><span class="p">,</span><span class="nx">Y</span><span class="p">,</span><span class="nx">X</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">X</span><span class="p">)){</span><span class="nx">X</span><span class="o">=</span><span class="kc">true</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">==</span><span class="nb">document</span><span class="o">&amp;&amp;</span><span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="o">&amp;&amp;!</span><span class="nx">a</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">}</span><span class="kd">var</span> <span class="nx">b</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">){</span><span class="nx">b</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">(</span><span class="s2">&quot;HTMLEvents&quot;</span><span class="p">);</span><span class="nx">b</span><span class="p">.</span><span class="nx">initEvent</span><span class="p">(</span><span class="s2">&quot;dataavailable&quot;</span><span class="p">,</span><span class="kc">true</span><span class="p">,</span><span class="kc">true</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">b</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createEventObject</span><span class="p">();</span><span class="nx">b</span><span class="p">.</span><span class="nx">eventType</span><span class="o">=</span><span class="nx">X</span><span class="o">?</span><span class="s2">&quot;ondataavailable&quot;</span><span class="o">:</span><span class="s2">&quot;onfilterchange&quot;</span><span class="p">}</span><span class="nx">b</span><span class="p">.</span><span class="nx">eventName</span><span class="o">=</span><span class="nx">Z</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">memo</span><span class="o">=</span><span class="nx">Y</span><span class="o">||</span><span class="p">{};</span><span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">b</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">a</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">eventType</span><span class="p">,</span><span class="nx">b</span><span class="p">)}</span><span class="k">return</span> <span class="nx">V</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">b</span><span class="p">)}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">V</span><span class="p">,</span><span class="nx">V</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">V</span><span class="p">,{</span><span class="nx">fire</span><span class="o">:</span><span class="nx">U</span><span class="p">,</span><span class="nx">observe</span><span class="o">:</span><span class="nx">S</span><span class="p">,</span><span class="nx">stopObserving</span><span class="o">:</span><span class="nx">I</span><span class="p">});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">addMethods</span><span class="p">({</span><span class="nx">fire</span><span class="o">:</span><span class="nx">U</span><span class="p">,</span><span class="nx">observe</span><span class="o">:</span><span class="nx">S</span><span class="p">,</span><span class="nx">stopObserving</span><span class="o">:</span><span class="nx">I</span><span class="p">});</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">document</span><span class="p">,{</span><span class="nx">fire</span><span class="o">:</span><span class="nx">U</span><span class="p">.</span><span class="nx">methodize</span><span class="p">(),</span><span class="nx">observe</span><span class="o">:</span><span class="nx">S</span><span class="p">.</span><span class="nx">methodize</span><span class="p">(),</span><span class="nx">stopObserving</span><span class="o">:</span><span class="nx">I</span><span class="p">.</span><span class="nx">methodize</span><span class="p">(),</span><span class="nx">loaded</span><span class="o">:</span><span class="kc">false</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">Event</span><span class="p">){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">Event</span><span class="p">,</span><span class="nx">V</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nb">window</span><span class="p">.</span><span class="nx">Event</span><span class="o">=</span><span class="nx">V</span><span class="p">}})();(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">D</span><span class="p">;</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">loaded</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">D</span><span class="p">)}</span><span class="nb">document</span><span class="p">.</span><span class="nx">loaded</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="nb">document</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s2">&quot;dom:loaded&quot;</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">readyState</span><span class="o">===</span><span class="s2">&quot;complete&quot;</span><span class="p">){</span><span class="nb">document</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="s2">&quot;readystatechange&quot;</span><span class="p">,</span><span class="nx">C</span><span class="p">);</span><span class="nx">A</span><span class="p">()}}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">doScroll</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">defer</span><span class="p">();</span><span class="k">return</span> <span class="p">}</span><span class="nx">A</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">){</span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;DOMContentLoaded&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="kc">false</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nb">document</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s2">&quot;readystatechange&quot;</span><span class="p">,</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="o">==</span><span class="nx">top</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">defer</span><span class="p">()}}</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nb">window</span><span class="p">,</span><span class="s2">&quot;load&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">)})();</span><span class="nx">Element</span><span class="p">.</span><span class="nx">addMethods</span><span class="p">();</span><span class="nx">Hash</span><span class="p">.</span><span class="nx">toQueryString</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toQueryString</span><span class="p">;</span><span class="kd">var</span> <span class="nx">Toggle</span><span class="o">=</span><span class="p">{</span><span class="nx">display</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">toggle</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">childOf</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">descendantOf</span><span class="p">;</span><span class="kd">var</span> <span class="nx">Insertion</span><span class="o">=</span><span class="p">{</span><span class="nx">Before</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">before</span><span class="o">:</span><span class="nx">B</span><span class="p">})},</span><span class="nx">Top</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">top</span><span class="o">:</span><span class="nx">B</span><span class="p">})},</span><span class="nx">Bottom</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">bottom</span><span class="o">:</span><span class="nx">B</span><span class="p">})},</span><span class="nx">After</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">after</span><span class="o">:</span><span class="nx">B</span><span class="p">})}};</span><span class="kd">var</span> <span class="nx">$continue</span><span class="o">=</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;&quot;throw $continue&quot; is deprecated, use &quot;return&quot; instead&#39;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">Position</span><span class="o">=</span><span class="p">{</span><span class="nx">includeScrollOffsets</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">prepare</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">deltaX</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">pageXOffset</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">deltaY</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">pageYOffset</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="mi">0</span><span class="p">},</span><span class="nx">within</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">includeScrollOffsets</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">withinIncludingScrolloffsets</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">xcomp</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">ycomp</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span><span class="p">(</span><span class="nx">C</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">C</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">)},</span><span class="nx">withinIncludingScrolloffsets</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cumulativeScrollOffset</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">xcomp</span><span class="o">=</span><span class="nx">A</span><span class="o">+</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">deltaX</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">ycomp</span><span class="o">=</span><span class="nx">D</span><span class="o">+</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">deltaY</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">ycomp</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">ycomp</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">xcomp</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">xcomp</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">)},</span><span class="nx">overlap</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="mi">0</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;vertical&quot;</span><span class="p">){</span><span class="k">return</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">)</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">ycomp</span><span class="p">)</span><span class="o">/</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;horizontal&quot;</span><span class="p">){</span><span class="k">return</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">)</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">xcomp</span><span class="p">)</span><span class="o">/</span><span class="nx">A</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">}},</span><span class="nx">cumulativeOffset</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">,</span><span class="nx">positionedOffset</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">positionedOffset</span><span class="p">,</span><span class="nx">absolutize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">prepare</span><span class="p">();</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">absolutize</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">relativize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">prepare</span><span class="p">();</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">relativize</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">realOffset</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">cumulativeScrollOffset</span><span class="p">,</span><span class="nx">offsetParent</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">getOffsetParent</span><span class="p">,</span><span class="nx">page</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">.</span><span class="nx">viewportOffset</span><span class="p">,</span><span class="nx">clone</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="o">||</span><span class="p">{};</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">clonePosition</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">)}};</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">){</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">return</span> <span class="nx">C</span><span class="p">.</span><span class="nx">blank</span><span class="p">()</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="s2">&quot;[contains(concat(&#39; &#39;, @class, &#39; &#39;), &#39; &quot;</span><span class="o">+</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot; &#39;)]&quot;</span><span class="p">}</span><span class="nx">B</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="o">=</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">BrowserFeatures</span><span class="p">.</span><span class="nx">XPath</span><span class="o">?</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">strip</span><span class="p">();</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="sr">/\s/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">E</span><span class="p">)</span><span class="o">?</span><span class="nx">$w</span><span class="p">(</span><span class="nx">E</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">A</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="k">return</span> <span class="nx">D</span><span class="o">?</span><span class="nb">document</span><span class="p">.</span><span class="nx">_getElementsByXPath</span><span class="p">(</span><span class="s2">&quot;.//*&quot;</span><span class="o">+</span><span class="nx">D</span><span class="p">,</span><span class="nx">C</span><span class="p">)</span><span class="o">:</span><span class="p">[]}</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="nx">F</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">strip</span><span class="p">();</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="p">[],</span><span class="nx">H</span><span class="o">=</span><span class="p">(</span><span class="sr">/\s/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">F</span><span class="p">)</span><span class="o">?</span><span class="nx">$w</span><span class="p">(</span><span class="nx">F</span><span class="p">)</span><span class="o">:</span><span class="kc">null</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">H</span><span class="o">&amp;&amp;!</span><span class="nx">F</span><span class="p">){</span><span class="k">return</span> <span class="nx">G</span><span class="p">}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">E</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">);</span><span class="nx">F</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">F</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">J</span><span class="p">,</span><span class="nx">I</span><span class="p">;</span><span class="nx">J</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="nx">D</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">J</span><span class="p">.</span><span class="nx">className</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">I</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">J</span><span class="p">.</span><span class="nx">className</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">I</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">F</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">H</span><span class="o">&amp;&amp;</span><span class="nx">H</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">K</span><span class="p">){</span><span class="k">return</span> <span class="o">!</span><span class="nx">K</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">blank</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="nx">I</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">K</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">)})))){</span><span class="nx">G</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">J</span><span class="p">))}}</span><span class="k">return</span> <span class="nx">G</span><span class="p">};</span><span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="o">||</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">D</span><span class="p">)}}(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="p">)}</span><span class="nx">Element</span><span class="p">.</span><span class="nx">ClassNames</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span><span class="nx">Element</span><span class="p">.</span><span class="nx">ClassNames</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="p">{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">_each</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">}).</span><span class="nx">_each</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="nx">A</span><span class="p">},</span><span class="nx">add</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">$A</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))},</span><span class="nx">remove</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">$A</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">without</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))},</span><span class="nx">toString</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">$A</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)}};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">ClassNames</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span><span class="nx">Enumerable</span><span class="p">);</span><span class="kd">var</span> <span class="nx">Scriptaculous</span><span class="o">=</span><span class="p">{</span><span class="nx">Version</span><span class="o">:</span><span class="s2">&quot;1.8.3&quot;</span><span class="p">,</span><span class="nx">require</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;&lt;script type=&quot;text/javascript&quot; src=&quot;&#39;</span><span class="o">+</span><span class="nx">B</span><span class="o">+</span><span class="s1">&#39;&quot;&gt;&lt;\/script&gt;&#39;</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;head&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">REQUIRED_PROTOTYPE</span><span class="o">:</span><span class="s2">&quot;1.6.0.3&quot;</span><span class="p">,</span><span class="nx">load</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/_.*|\./g</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="nx">C</span><span class="o">=</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;0&quot;</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="p">));</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="o">?</span><span class="nx">C</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span><span class="nx">C</span><span class="p">}</span><span class="k">if</span><span class="p">((</span><span class="k">typeof</span> <span class="nx">Prototype</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">Element</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">Methods</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">A</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Version</span><span class="p">)</span><span class="o">&lt;</span><span class="nx">A</span><span class="p">(</span><span class="nx">Scriptaculous</span><span class="p">.</span><span class="nx">REQUIRED_PROTOTYPE</span><span class="p">))){</span><span class="k">throw</span> <span class="p">(</span><span class="s2">&quot;script.aculo.us requires the Prototype JavaScript framework &gt;= &quot;</span><span class="o">+</span><span class="nx">Scriptaculous</span><span class="p">.</span><span class="nx">REQUIRED_PROTOTYPE</span><span class="p">)}}};</span><span class="nx">Scriptaculous</span><span class="p">.</span><span class="nx">load</span><span class="p">();</span><span class="kd">var</span> <span class="nx">Builder</span><span class="o">=</span><span class="p">{</span><span class="nx">NODEMAP</span><span class="o">:</span><span class="p">{</span><span class="nx">AREA</span><span class="o">:</span><span class="s2">&quot;map&quot;</span><span class="p">,</span><span class="nx">CAPTION</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">,</span><span class="nx">COL</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">,</span><span class="nx">COLGROUP</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">,</span><span class="nx">LEGEND</span><span class="o">:</span><span class="s2">&quot;fieldset&quot;</span><span class="p">,</span><span class="nx">OPTGROUP</span><span class="o">:</span><span class="s2">&quot;select&quot;</span><span class="p">,</span><span class="nx">OPTION</span><span class="o">:</span><span class="s2">&quot;select&quot;</span><span class="p">,</span><span class="nx">PARAM</span><span class="o">:</span><span class="s2">&quot;object&quot;</span><span class="p">,</span><span class="nx">TBODY</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">,</span><span class="nx">TD</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">,</span><span class="nx">TFOOT</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">,</span><span class="nx">TH</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">,</span><span class="nx">THEAD</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">,</span><span class="nx">TR</span><span class="o">:</span><span class="s2">&quot;table&quot;</span><span class="p">},</span><span class="nx">node</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">NODEMAP</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;div&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">F</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="nx">B</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="o">+</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot;&gt;&lt;/&quot;</span><span class="o">+</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot;&gt;&quot;</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">E</span><span class="p">){}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">||</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">!=</span><span class="nx">A</span><span class="p">)){</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">A</span><span class="p">)[</span><span class="mi">0</span><span class="p">]}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isStringOrNumber</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">||</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">)</span><span class="o">||</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">tagName</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_children</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span><span class="k">else</span><span class="p">{</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_attributes</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="nx">B</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="o">+</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;&gt;&lt;/&quot;</span><span class="o">+</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot;&gt;&quot;</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">E</span><span class="p">){}</span><span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">||</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">attr</span> <span class="k">in</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]){</span><span class="nx">D</span><span class="p">[</span><span class="nx">attr</span><span class="o">==</span><span class="s2">&quot;class&quot;</span><span class="o">?</span><span class="s2">&quot;className&quot;</span><span class="o">:</span><span class="nx">attr</span><span class="p">]</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nx">attr</span><span class="p">]}}</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">!=</span><span class="nx">A</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">A</span><span class="p">)[</span><span class="mi">0</span><span class="p">]}}}}</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span><span class="k">this</span><span class="p">.</span><span class="nx">_children</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">])}</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">)},</span><span class="nx">_text</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">ATTR_MAP</span><span class="o">:</span><span class="p">{</span><span class="nx">className</span><span class="o">:</span><span class="s2">&quot;class&quot;</span><span class="p">,</span><span class="nx">htmlFor</span><span class="o">:</span><span class="s2">&quot;for&quot;</span><span class="p">},</span><span class="nx">_attributes</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="nx">attribute</span> <span class="k">in</span> <span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">push</span><span class="p">((</span><span class="nx">attribute</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">ATTR_MAP</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">ATTR_MAP</span><span class="p">[</span><span class="nx">attribute</span><span class="p">]</span><span class="o">:</span><span class="nx">attribute</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">+</span><span class="nx">A</span><span class="p">[</span><span class="nx">attribute</span><span class="p">].</span><span class="nx">toString</span><span class="p">().</span><span class="nx">escapeHTML</span><span class="p">().</span><span class="nx">gsub</span><span class="p">(</span><span class="sr">/&quot;/</span><span class="p">,</span><span class="s2">&quot;&amp;quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)}</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)},</span><span class="nx">_children</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">tagName</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">A</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">flatten</span><span class="p">().</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">C</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">C</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">Builder</span><span class="p">.</span><span class="nx">_isStringOrNumber</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">Builder</span><span class="p">.</span><span class="nx">_text</span><span class="p">(</span><span class="nx">C</span><span class="p">))}}})}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">Builder</span><span class="p">.</span><span class="nx">_isStringOrNumber</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">Builder</span><span class="p">.</span><span class="nx">_text</span><span class="p">(</span><span class="nx">A</span><span class="p">))}}},</span><span class="nx">_isStringOrNumber</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">A</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">A</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="p">)},</span><span class="nx">build</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">strip</span><span class="p">());</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">down</span><span class="p">()},</span><span class="nx">dump</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">B</span><span class="o">!=</span><span class="s2">&quot;object&quot;</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">B</span><span class="o">!=</span><span class="s2">&quot;function&quot;</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nb">window</span><span class="p">}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">Builder</span><span class="p">,[</span><span class="nx">C</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">$A</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)))}})}};</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">parseColor</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;rgb(&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="nx">A</span><span class="o">+=</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">B</span><span class="p">]).</span><span class="nx">toColorPart</span><span class="p">()}</span><span class="k">while</span><span class="p">(</span><span class="o">++</span><span class="nx">B</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;#&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">4</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">B</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="nx">B</span><span class="o">++</span><span class="p">){</span><span class="nx">A</span><span class="o">+=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">B</span><span class="p">)</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">B</span><span class="p">)).</span><span class="nx">toLowerCase</span><span class="p">()}}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">7</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()}}}</span><span class="k">return</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">7</span><span class="o">?</span><span class="nx">A</span><span class="o">:</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">||</span><span class="k">this</span><span class="p">))};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">collectTextNodes</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">$A</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">childNodes</span><span class="p">).</span><span class="nx">collect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">3</span><span class="o">?</span><span class="nx">B</span><span class="p">.</span><span class="nx">nodeValue</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">hasChildNodes</span><span class="p">()</span><span class="o">?</span><span class="nx">Element</span><span class="p">.</span><span class="nx">collectTextNodes</span><span class="p">(</span><span class="nx">B</span><span class="p">)</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">))}).</span><span class="nx">flatten</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">collectTextNodesIgnoreClass</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">$A</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">childNodes</span><span class="p">).</span><span class="nx">collect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">3</span><span class="o">?</span><span class="nx">C</span><span class="p">.</span><span class="nx">nodeValue</span><span class="o">:</span><span class="p">((</span><span class="nx">C</span><span class="p">.</span><span class="nx">hasChildNodes</span><span class="p">()</span><span class="o">&amp;&amp;!</span><span class="nx">Element</span><span class="p">.</span><span class="nx">hasClassName</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">))</span><span class="o">?</span><span class="nx">Element</span><span class="p">.</span><span class="nx">collectTextNodesIgnoreClass</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">)</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">))}).</span><span class="nx">flatten</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">setContentZoom</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">fontSize</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;em&quot;</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">scrollBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="k">return</span> <span class="nx">A</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getInlineOpacity</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">forceRerendering</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">C</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">B</span><span class="p">){}};</span><span class="kd">var</span> <span class="nx">Effect</span><span class="o">=</span><span class="p">{</span><span class="nx">_elementDoesNotExistError</span><span class="o">:</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;ElementDoesNotExistError&quot;</span><span class="p">,</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;The specified DOM element does not exist, but is required for this effect to operate&quot;</span><span class="p">},</span><span class="nx">Transitions</span><span class="o">:</span><span class="p">{</span><span class="nx">linear</span><span class="o">:</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">,</span><span class="nx">sinoidal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">A</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">},</span><span class="nx">reverse</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="nx">A</span><span class="p">},</span><span class="nx">flicker</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">A</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="mf">0.75</span><span class="p">)</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span><span class="k">return</span> <span class="nx">A</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="nx">A</span><span class="p">},</span><span class="nx">wobble</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">A</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">*</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="nx">A</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">},</span><span class="nx">pulse</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">((</span><span class="nx">B</span><span class="o">*</span><span class="p">((</span><span class="nx">A</span><span class="o">||</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">},</span><span class="nx">spring</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">A</span><span class="o">*</span><span class="mf">4.5</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">A</span><span class="o">*</span><span class="mi">6</span><span class="p">))},</span><span class="nx">none</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="mi">0</span><span class="p">},</span><span class="nx">full</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="mi">1</span><span class="p">}},</span><span class="nx">DefaultOptions</span><span class="o">:</span><span class="p">{</span><span class="nx">duration</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">fps</span><span class="o">:</span><span class="mi">100</span><span class="p">,</span><span class="nx">sync</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">from</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">delay</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">queue</span><span class="o">:</span><span class="s2">&quot;parallel&quot;</span><span class="p">},</span><span class="nx">tagifyText</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="s2">&quot;position:relative&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">){</span><span class="nx">B</span><span class="o">+=</span><span class="s2">&quot;;zoom:1&quot;</span><span class="p">}</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">$A</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">==</span><span class="mi">3</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="k">new</span> <span class="nx">Element</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,{</span><span class="nx">style</span><span class="o">:</span><span class="nx">B</span><span class="p">}).</span><span class="nx">update</span><span class="p">(</span><span class="nx">D</span><span class="o">==</span><span class="s2">&quot; &quot;</span><span class="o">?</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mi">160</span><span class="p">)</span><span class="o">:</span><span class="nx">D</span><span class="p">),</span><span class="nx">C</span><span class="p">)});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">C</span><span class="p">)}})},</span><span class="nx">multiple</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="p">;</span><span class="k">if</span><span class="p">(((</span><span class="k">typeof</span> <span class="nx">B</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">)</span><span class="o">||</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">B</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">length</span><span class="p">)){</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">E</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">).</span><span class="nx">childNodes</span><span class="p">}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">speed</span><span class="o">:</span><span class="mf">0.1</span><span class="p">,</span><span class="nx">delay</span><span class="o">:</span><span class="mi">0</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">delay</span><span class="p">;</span><span class="nx">$A</span><span class="p">(</span><span class="nx">E</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="k">new</span> <span class="nx">C</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">delay</span><span class="o">:</span><span class="nx">F</span><span class="o">*</span><span class="nx">A</span><span class="p">.</span><span class="nx">speed</span><span class="o">+</span><span class="nx">D</span><span class="p">}))})},</span><span class="nx">PAIRS</span><span class="o">:</span><span class="p">{</span><span class="nx">slide</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;SlideDown&quot;</span><span class="p">,</span><span class="s2">&quot;SlideUp&quot;</span><span class="p">],</span><span class="nx">blind</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;BlindDown&quot;</span><span class="p">,</span><span class="s2">&quot;BlindUp&quot;</span><span class="p">],</span><span class="nx">appear</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;Appear&quot;</span><span class="p">,</span><span class="s2">&quot;Fade&quot;</span><span class="p">]},</span><span class="nx">toggle</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="nx">C</span><span class="o">=</span><span class="p">(</span><span class="nx">C</span><span class="o">||</span><span class="s2">&quot;appear&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">return</span> <span class="nx">Effect</span><span class="p">[</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">PAIRS</span><span class="p">[</span><span class="nx">C</span><span class="p">][</span><span class="nx">B</span><span class="p">.</span><span class="nx">visible</span><span class="p">()</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">]](</span><span class="nx">B</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">queue</span><span class="o">:</span><span class="p">{</span><span class="nx">position</span><span class="o">:</span><span class="s2">&quot;end&quot;</span><span class="p">,</span><span class="nx">scope</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">id</span><span class="o">||</span><span class="s2">&quot;global&quot;</span><span class="p">),</span><span class="nx">limit</span><span class="o">:</span><span class="mi">1</span><span class="p">}},</span><span class="nx">A</span><span class="o">||</span><span class="p">{}))}};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">.</span><span class="nx">transition</span><span class="o">=</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">sinoidal</span><span class="p">;</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">ScopedQueue</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Enumerable</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">interval</span><span class="o">=</span><span class="kc">null</span><span class="p">},</span><span class="nx">_each</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">_each</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">add</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">)</span><span class="o">?</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;front&quot;</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">state</span><span class="o">==</span><span class="s2">&quot;idle&quot;</span><span class="p">}).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">startOn</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">finishOn</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">finishOn</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">finishOn</span><span class="p">});</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;with-last&quot;</span><span class="o">:</span><span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s2">&quot;startOn&quot;</span><span class="p">).</span><span class="nx">max</span><span class="p">()</span><span class="o">||</span><span class="nx">C</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;end&quot;</span><span class="o">:</span><span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s2">&quot;finishOn&quot;</span><span class="p">).</span><span class="nx">max</span><span class="p">()</span><span class="o">||</span><span class="nx">C</span><span class="p">;</span><span class="k">break</span><span class="p">}</span><span class="nx">B</span><span class="p">.</span><span class="nx">startOn</span><span class="o">+=</span><span class="nx">C</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">finishOn</span><span class="o">+=</span><span class="nx">C</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">limit</span><span class="o">||</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">length</span><span class="o">&lt;</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">limit</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">B</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">interval</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">interval</span><span class="o">=</span><span class="nx">setInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loop</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="mi">15</span><span class="p">)}},</span><span class="nx">remove</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="o">==</span><span class="nx">A</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span><span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">interval</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">interval</span><span class="o">=</span><span class="kc">null</span><span class="p">}},</span><span class="nx">loop</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">B</span><span class="o">&lt;</span><span class="nx">A</span><span class="p">;</span><span class="nx">B</span><span class="o">++</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="nx">B</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="nx">B</span><span class="p">].</span><span class="nx">loop</span><span class="p">(</span><span class="nx">C</span><span class="p">)}}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Queues</span><span class="o">=</span><span class="p">{</span><span class="nx">instances</span><span class="o">:</span><span class="nx">$H</span><span class="p">(),</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">instances</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">instances</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">ScopedQueue</span><span class="p">())}};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Queue</span><span class="o">=</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Queues</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">);</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">start</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">transition</span><span class="o">===</span><span class="kc">false</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">transition</span><span class="o">=</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">linear</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">),</span><span class="nx">A</span><span class="o">||</span><span class="p">{});</span><span class="k">this</span><span class="p">.</span><span class="nx">currentFrame</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="s2">&quot;idle&quot;</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">startOn</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">delay</span><span class="o">*</span><span class="mi">1000</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">finishOn</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">startOn</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">duration</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">fromToDelta</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">to</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">from</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">totalTime</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">finishOn</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">startOn</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">totalFrames</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">fps</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">duration</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="o">=</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;Internal&quot;</span><span class="p">]){</span><span class="nx">D</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;Internal&quot;</span><span class="p">](</span><span class="nx">D</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">C</span><span class="p">]){</span><span class="nx">D</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">C</span><span class="p">](</span><span class="nx">D</span><span class="p">)}}</span><span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">===</span><span class="s2">&quot;idle&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="s2">&quot;running&quot;</span><span class="p">;</span><span class="nx">B</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;beforeSetup&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">setup</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">setup</span><span class="p">()}</span><span class="nx">B</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;afterSetup&quot;</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">===</span><span class="s2">&quot;running&quot;</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">transition</span><span class="p">(</span><span class="nx">C</span><span class="p">)</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">fromToDelta</span><span class="p">)</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">from</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="nx">B</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;beforeUpdate&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">C</span><span class="p">)}</span><span class="nx">B</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;afterUpdate&quot;</span><span class="p">)}}})();</span><span class="k">this</span><span class="p">.</span><span class="nx">event</span><span class="p">(</span><span class="s2">&quot;beforeStart&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">sync</span><span class="p">){</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Queues</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;global&quot;</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">scope</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">)}},</span><span class="nx">loop</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">startOn</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">finishOn</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">cancel</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">event</span><span class="p">(</span><span class="s2">&quot;beforeFinish&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">finish</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">finish</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">event</span><span class="p">(</span><span class="s2">&quot;afterFinish&quot;</span><span class="p">);</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">(</span><span class="nx">C</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">startOn</span><span class="p">)</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">totalTime</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="p">(</span><span class="nx">B</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">totalFrames</span><span class="p">).</span><span class="nx">round</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">currentFrame</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">currentFrame</span><span class="o">=</span><span class="nx">A</span><span class="p">}}},</span><span class="nx">cancel</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">sync</span><span class="p">){</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Queues</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;global&quot;</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">scope</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="s2">&quot;finished&quot;</span><span class="p">},</span><span class="nx">event</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot;Internal&quot;</span><span class="p">]){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot;Internal&quot;</span><span class="p">](</span><span class="k">this</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">A</span><span class="p">]){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">A</span><span class="p">](</span><span class="k">this</span><span class="p">)}},</span><span class="nx">inspect</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">$H</span><span class="p">();</span><span class="k">for</span><span class="p">(</span><span class="nx">property</span> <span class="k">in</span> <span class="k">this</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">property</span><span class="p">])){</span><span class="nx">A</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">property</span><span class="p">,</span><span class="k">this</span><span class="p">[</span><span class="nx">property</span><span class="p">])}}</span><span class="k">return</span><span class="s2">&quot;#&lt;Effect:&quot;</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">inspect</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;,options:&quot;</span><span class="o">+</span><span class="nx">$H</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">).</span><span class="nx">inspect</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&gt;&quot;</span><span class="p">}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Parallel</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="o">=</span><span class="nx">A</span><span class="o">||</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">])},</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="s2">&quot;render&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">finish</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">cancel</span><span class="p">();</span><span class="nx">B</span><span class="p">.</span><span class="nx">event</span><span class="p">(</span><span class="s2">&quot;beforeFinish&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">finish</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">finish</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="nx">B</span><span class="p">.</span><span class="nx">event</span><span class="p">(</span><span class="s2">&quot;afterFinish&quot;</span><span class="p">)})}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Tween</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">F</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">C</span><span class="p">)</span><span class="o">?</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">)</span><span class="o">:</span><span class="nx">C</span><span class="p">;</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">$A</span><span class="p">(</span><span class="nx">arguments</span><span class="p">),</span><span class="nx">D</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">last</span><span class="p">(),</span><span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">5</span><span class="o">?</span><span class="nx">B</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">:</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">?</span><span class="nx">D</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">C</span><span class="p">)</span><span class="o">:</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">])</span><span class="o">?</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="nx">C</span><span class="p">)</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">=</span><span class="nx">G</span><span class="p">};</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">from</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="nx">E</span><span class="p">},</span><span class="nx">A</span><span class="o">||</span><span class="p">{}))},</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">method</span><span class="p">(</span><span class="nx">A</span><span class="p">)}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Event</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">duration</span><span class="o">:</span><span class="mi">0</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">||</span><span class="p">{}))},</span><span class="nx">update</span><span class="o">:</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">){</span><span class="k">throw</span> <span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">_elementDoesNotExistError</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">.</span><span class="nx">hasLayout</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">zoom</span><span class="o">:</span><span class="mi">1</span><span class="p">})}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">from</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getOpacity</span><span class="p">()</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="mi">1</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="nx">A</span><span class="p">)}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">){</span><span class="k">throw</span> <span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">_elementDoesNotExistError</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">mode</span><span class="o">:</span><span class="s2">&quot;relative&quot;</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">setup</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">originalLeft</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;0&quot;</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">originalTop</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;0&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">mode</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">x</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">x</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">originalLeft</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">y</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">y</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">originalTop</span><span class="p">}},</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">left</span><span class="o">:</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">x</span><span class="o">*</span><span class="nx">A</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">originalLeft</span><span class="p">).</span><span class="nx">round</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">,</span><span class="nx">top</span><span class="o">:</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">y</span><span class="o">*</span><span class="nx">A</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">originalTop</span><span class="p">).</span><span class="nx">round</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">})}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">MoveBy</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="nx">A</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">){</span><span class="k">throw</span> <span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">_elementDoesNotExistError</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">scaleX</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">scaleY</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">scaleFromCenter</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleMode</span><span class="o">:</span><span class="s2">&quot;box&quot;</span><span class="p">,</span><span class="nx">scaleFrom</span><span class="o">:</span><span class="mi">100</span><span class="p">,</span><span class="nx">scaleTo</span><span class="o">:</span><span class="nx">C</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">setup</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">restoreAfterFinish</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">restoreAfterFinish</span><span class="o">||</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">elementPositioning</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">originalStyle</span><span class="o">=</span><span class="p">{};[</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="s2">&quot;left&quot;</span><span class="p">,</span><span class="s2">&quot;width&quot;</span><span class="p">,</span><span class="s2">&quot;height&quot;</span><span class="p">,</span><span class="s2">&quot;fontSize&quot;</span><span class="p">].</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">originalStyle</span><span class="p">[</span><span class="nx">B</span><span class="p">]</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">B</span><span class="p">]}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">this</span><span class="p">.</span><span class="nx">originalTop</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">originalLeft</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;font-size&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;100%&quot;</span><span class="p">;[</span><span class="s2">&quot;em&quot;</span><span class="p">,</span><span class="s2">&quot;px&quot;</span><span class="p">,</span><span class="s2">&quot;%&quot;</span><span class="p">,</span><span class="s2">&quot;pt&quot;</span><span class="p">].</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">B</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">fontSize</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">fontSizeType</span><span class="o">=</span><span class="nx">B</span><span class="p">}}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">this</span><span class="p">.</span><span class="nx">factor</span><span class="o">=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleTo</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleFrom</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleMode</span><span class="o">==</span><span class="s2">&quot;box&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="o">=</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">]}</span><span class="k">if</span><span class="p">(</span><span class="sr">/^content/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleMode</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="o">=</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">scrollHeight</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">scrollWidth</span><span class="p">]}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="o">=</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleMode</span><span class="p">.</span><span class="nx">originalHeight</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleMode</span><span class="p">.</span><span class="nx">originalWidth</span><span class="p">]}},</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleFrom</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">factor</span><span class="o">*</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleContent</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">fontSize</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">fontSize</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">fontSize</span><span class="o">*</span><span class="nx">B</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">fontSizeType</span><span class="p">})}</span><span class="k">this</span><span class="p">.</span><span class="nx">setDimensions</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">B</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">B</span><span class="p">)},</span><span class="nx">finish</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">restoreAfterFinish</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">originalStyle</span><span class="p">)}},</span><span class="nx">setDimensions</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">{};</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleX</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">round</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleY</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">height</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">round</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleFromCenter</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="p">(</span><span class="nx">A</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">(</span><span class="nx">D</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elementPositioning</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleY</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">originalTop</span><span class="o">-</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleX</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">originalLeft</span><span class="o">-</span><span class="nx">B</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleY</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">top</span><span class="o">=-</span><span class="nx">C</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scaleX</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">left</span><span class="o">=-</span><span class="nx">B</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}}}</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">E</span><span class="p">)}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Highlight</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">){</span><span class="k">throw</span> <span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">_elementDoesNotExistError</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">startcolor</span><span class="o">:</span><span class="s2">&quot;#ffff99&quot;</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">setup</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;none&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">cancel</span><span class="p">();</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">oldStyle</span><span class="o">=</span><span class="p">{};</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">keepBackgroundImage</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">oldStyle</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;background-image&quot;</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">backgroundImage</span><span class="o">:</span><span class="s2">&quot;none&quot;</span><span class="p">})}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endcolor</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endcolor</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;background-color&quot;</span><span class="p">).</span><span class="nx">parseColor</span><span class="p">(</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">restorecolor</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">restorecolor</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;background-color&quot;</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">_base</span><span class="o">=</span><span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">startcolor</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">A</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">A</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="mi">16</span><span class="p">)}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">this</span><span class="p">.</span><span class="nx">_delta</span><span class="o">=</span><span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endcolor</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">A</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">A</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="mi">16</span><span class="p">)</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">_base</span><span class="p">[</span><span class="nx">A</span><span class="p">]}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))},</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">backgroundColor</span><span class="o">:</span><span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">).</span><span class="nx">inject</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="o">+</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">_base</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_delta</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">*</span><span class="nx">A</span><span class="p">)).</span><span class="nx">round</span><span class="p">().</span><span class="nx">toColorPart</span><span class="p">())}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))})},</span><span class="nx">finish</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">oldStyle</span><span class="p">,{</span><span class="nx">backgroundColor</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">restorecolor</span><span class="p">}))}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">ScrollTo</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{},</span><span class="nx">A</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">getScrollOffsets</span><span class="p">(),</span><span class="nx">D</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">cumulativeOffset</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">offset</span><span class="p">){</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="nx">B</span><span class="p">.</span><span class="nx">offset</span><span class="p">}</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Tween</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">B</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span><span class="nx">E</span><span class="p">.</span><span class="nx">round</span><span class="p">())})};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Fade</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">getInlineOpacity</span><span class="p">();</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">from</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">getOpacity</span><span class="p">()</span><span class="o">||</span><span class="mi">1</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">to</span><span class="o">!=</span><span class="mi">0</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">A</span><span class="p">})}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">)};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Appear</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">from</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;none&quot;</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">getOpacity</span><span class="p">()</span><span class="o">||</span><span class="mi">0</span><span class="p">),</span><span class="nx">to</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">forceRerendering</span><span class="p">()},</span><span class="nx">beforeSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">from</span><span class="p">).</span><span class="nx">show</span><span class="p">()}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">)};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Puff</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">getInlineOpacity</span><span class="p">(),</span><span class="nx">position</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">),</span><span class="nx">top</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span><span class="nx">width</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="nx">height</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="p">};</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Parallel</span><span class="p">([</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="mi">200</span><span class="p">,{</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">scaleFromCenter</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">}),</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">B</span><span class="p">,{</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="mi">0</span><span class="p">})],</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">duration</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">beforeSetupInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">absolutize</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">element</span><span class="p">)},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">BlindUp</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">makeClipping</span><span class="p">();</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleX</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">undoClipping</span><span class="p">()}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">BlindDown</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getDimensions</span><span class="p">();</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleX</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleFrom</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">scaleMode</span><span class="o">:</span><span class="p">{</span><span class="nx">originalHeight</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="nx">originalWidth</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">width</span><span class="p">},</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">afterSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makeClipping</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">height</span><span class="o">:</span><span class="s2">&quot;0px&quot;</span><span class="p">}).</span><span class="nx">show</span><span class="p">()},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">undoClipping</span><span class="p">()}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">SwitchOff</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getInlineOpacity</span><span class="p">();</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Appear</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.4</span><span class="p">,</span><span class="nx">from</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">transition</span><span class="o">:</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">flicker</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="mi">1</span><span class="p">,{</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.3</span><span class="p">,</span><span class="nx">scaleFromCenter</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">scaleX</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">beforeSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">().</span><span class="nx">makeClipping</span><span class="p">()},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">undoClipping</span><span class="p">().</span><span class="nx">undoPositioned</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">A</span><span class="p">})}})}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">DropOut</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">),</span><span class="nx">left</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">),</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">getInlineOpacity</span><span class="p">()};</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Parallel</span><span class="p">([</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">B</span><span class="p">,{</span><span class="nx">x</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">100</span><span class="p">,</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">}),</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">B</span><span class="p">,{</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="mi">0</span><span class="p">})],</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.5</span><span class="p">,</span><span class="nx">beforeSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">element</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">()},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">undoPositioned</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Shake</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">distance</span><span class="o">:</span><span class="mi">20</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.5</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">distance</span><span class="p">);</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">duration</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">D</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">),</span><span class="nx">left</span><span class="o">:</span><span class="nx">D</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)};</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">D</span><span class="p">,{</span><span class="nx">x</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">element</span><span class="p">,{</span><span class="nx">x</span><span class="o">:-</span><span class="nx">E</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="nx">C</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">G</span><span class="p">.</span><span class="nx">element</span><span class="p">,{</span><span class="nx">x</span><span class="o">:</span><span class="nx">E</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="nx">C</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">H</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">H</span><span class="p">.</span><span class="nx">element</span><span class="p">,{</span><span class="nx">x</span><span class="o">:-</span><span class="nx">E</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="nx">C</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">I</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">I</span><span class="p">.</span><span class="nx">element</span><span class="p">,{</span><span class="nx">x</span><span class="o">:</span><span class="nx">E</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="nx">C</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">J</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">J</span><span class="p">.</span><span class="nx">element</span><span class="p">,{</span><span class="nx">x</span><span class="o">:-</span><span class="nx">E</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">K</span><span class="p">){</span><span class="nx">K</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">undoPositioned</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">)}})}})}})}})}})}})};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">SlideDown</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">cleanWhitespace</span><span class="p">();</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">getDimensions</span><span class="p">();</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleX</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleFrom</span><span class="o">:</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">scaleMode</span><span class="o">:</span><span class="p">{</span><span class="nx">originalHeight</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="nx">originalWidth</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">width</span><span class="p">},</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">afterSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">();</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">makePositioned</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">top</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">})}</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makeClipping</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">height</span><span class="o">:</span><span class="s2">&quot;0px&quot;</span><span class="p">}).</span><span class="nx">show</span><span class="p">()},</span><span class="nx">afterUpdateInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">bottom</span><span class="o">:</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">})},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">undoClipping</span><span class="p">().</span><span class="nx">undoPositioned</span><span class="p">();</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">undoPositioned</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">bottom</span><span class="o">:</span><span class="nx">A</span><span class="p">})}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">SlideUp</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">cleanWhitespace</span><span class="p">();</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">getDimensions</span><span class="p">();</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleX</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleMode</span><span class="o">:</span><span class="s2">&quot;box&quot;</span><span class="p">,</span><span class="nx">scaleFrom</span><span class="o">:</span><span class="mi">100</span><span class="p">,</span><span class="nx">scaleMode</span><span class="o">:</span><span class="p">{</span><span class="nx">originalHeight</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="nx">originalWidth</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">width</span><span class="p">},</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">afterSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">();</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">makePositioned</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">top</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">})}</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makeClipping</span><span class="p">().</span><span class="nx">show</span><span class="p">()},</span><span class="nx">afterUpdateInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">bottom</span><span class="o">:</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">})},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">undoClipping</span><span class="p">().</span><span class="nx">undoPositioned</span><span class="p">();</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">undoPositioned</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">bottom</span><span class="o">:</span><span class="nx">A</span><span class="p">})}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Squish</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">,{</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">beforeSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makeClipping</span><span class="p">()},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">undoClipping</span><span class="p">()}})};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Grow</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">direction</span><span class="o">:</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="nx">moveTransition</span><span class="o">:</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">sinoidal</span><span class="p">,</span><span class="nx">scaleTransition</span><span class="o">:</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">sinoidal</span><span class="p">,</span><span class="nx">opacityTransition</span><span class="o">:</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">full</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span><span class="nx">height</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="nx">width</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">getInlineOpacity</span><span class="p">()};</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">getDimensions</span><span class="p">();</span><span class="kd">var</span> <span class="nx">H</span><span class="p">,</span><span class="nx">F</span><span class="p">;</span><span class="kd">var</span> <span class="nx">E</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">direction</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;top-left&quot;</span><span class="o">:</span><span class="nx">H</span><span class="o">=</span><span class="nx">F</span><span class="o">=</span><span class="nx">E</span><span class="o">=</span><span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;top-right&quot;</span><span class="o">:</span><span class="nx">H</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">E</span><span class="o">=-</span><span class="nx">G</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;bottom-left&quot;</span><span class="o">:</span><span class="nx">H</span><span class="o">=</span><span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span><span class="nx">D</span><span class="o">=-</span><span class="nx">G</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;bottom-right&quot;</span><span class="o">:</span><span class="nx">H</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span><span class="nx">E</span><span class="o">=-</span><span class="nx">G</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span><span class="nx">D</span><span class="o">=-</span><span class="nx">G</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;center&quot;</span><span class="o">:</span><span class="nx">H</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="nx">F</span><span class="o">=</span><span class="nx">G</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="nx">E</span><span class="o">=-</span><span class="nx">G</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="nx">D</span><span class="o">=-</span><span class="nx">G</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="k">break</span><span class="p">}</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">C</span><span class="p">,{</span><span class="nx">x</span><span class="o">:</span><span class="nx">H</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.01</span><span class="p">,</span><span class="nx">beforeSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">I</span><span class="p">){</span><span class="nx">I</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">makeClipping</span><span class="p">().</span><span class="nx">makePositioned</span><span class="p">()},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">I</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Parallel</span><span class="p">([</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">I</span><span class="p">.</span><span class="nx">element</span><span class="p">,{</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">from</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">transition</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">opacityTransition</span><span class="p">}),</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">I</span><span class="p">.</span><span class="nx">element</span><span class="p">,{</span><span class="nx">x</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">transition</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">moveTransition</span><span class="p">}),</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">I</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="mi">100</span><span class="p">,{</span><span class="nx">scaleMode</span><span class="o">:</span><span class="p">{</span><span class="nx">originalHeight</span><span class="o">:</span><span class="nx">G</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="nx">originalWidth</span><span class="o">:</span><span class="nx">G</span><span class="p">.</span><span class="nx">width</span><span class="p">},</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">scaleFrom</span><span class="o">:</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">transition</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">scaleTransition</span><span class="p">,</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">})],</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">beforeSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">J</span><span class="p">){</span><span class="nx">J</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">height</span><span class="o">:</span><span class="s2">&quot;0px&quot;</span><span class="p">}).</span><span class="nx">show</span><span class="p">()},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">J</span><span class="p">){</span><span class="nx">J</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">element</span><span class="p">.</span><span class="nx">undoClipping</span><span class="p">().</span><span class="nx">undoPositioned</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">B</span><span class="p">))}})};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Shrink</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">direction</span><span class="o">:</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="nx">moveTransition</span><span class="o">:</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">sinoidal</span><span class="p">,</span><span class="nx">scaleTransition</span><span class="o">:</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">sinoidal</span><span class="p">,</span><span class="nx">opacityTransition</span><span class="o">:</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">none</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span><span class="nx">height</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span><span class="nx">width</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">getInlineOpacity</span><span class="p">()};</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">getDimensions</span><span class="p">();</span><span class="kd">var</span> <span class="nx">E</span><span class="p">,</span><span class="nx">D</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">direction</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;top-left&quot;</span><span class="o">:</span><span class="nx">E</span><span class="o">=</span><span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;top-right&quot;</span><span class="o">:</span><span class="nx">E</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;bottom-left&quot;</span><span class="o">:</span><span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;bottom-right&quot;</span><span class="o">:</span><span class="nx">E</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;center&quot;</span><span class="o">:</span><span class="nx">E</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="nx">D</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="k">break</span><span class="p">}</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Parallel</span><span class="p">([</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">C</span><span class="p">,{</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">from</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">transition</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">opacityTransition</span><span class="p">}),</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">opera</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">,{</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">transition</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">scaleTransition</span><span class="p">,</span><span class="nx">restoreAfterFinish</span><span class="o">:</span><span class="kc">true</span><span class="p">}),</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">C</span><span class="p">,{</span><span class="nx">x</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">transition</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">moveTransition</span><span class="p">})],</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">beforeStartInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="nx">G</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">element</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">().</span><span class="nx">makeClipping</span><span class="p">()},</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="nx">G</span><span class="p">.</span><span class="nx">effects</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">undoClipping</span><span class="p">().</span><span class="nx">undoPositioned</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">B</span><span class="p">))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Pulsate</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{},</span><span class="nx">A</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">getInlineOpacity</span><span class="p">(),</span><span class="nx">E</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">transition</span><span class="o">||</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transitions</span><span class="p">.</span><span class="nx">linear</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="nx">E</span><span class="p">((</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">((</span><span class="nx">F</span><span class="o">*</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">pulses</span><span class="o">||</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)};</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">duration</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">from</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">F</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">A</span><span class="p">})}},</span><span class="nx">B</span><span class="p">),{</span><span class="nx">transition</span><span class="o">:</span><span class="nx">D</span><span class="p">}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Fold</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span><span class="nx">width</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span><span class="nx">height</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="p">};</span><span class="nx">B</span><span class="p">.</span><span class="nx">makeClipping</span><span class="p">();</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleX</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="mi">1</span><span class="p">,{</span><span class="nx">scaleContent</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scaleY</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">afterFinishInternal</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">undoClipping</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">A</span><span class="p">)}})}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{}))};</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Morph</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">){</span><span class="k">throw</span> <span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">_elementDoesNotExistError</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">style</span><span class="o">:</span><span class="p">{}},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="o">=</span><span class="nx">$H</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">parseStyle</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="o">=</span><span class="nx">$H</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyles</span><span class="p">());</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">removeClassName</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">style</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyles</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">.</span><span class="nx">value</span><span class="o">==</span><span class="nx">B</span><span class="p">[</span><span class="nx">D</span><span class="p">.</span><span class="nx">key</span><span class="p">]});</span><span class="nx">A</span><span class="p">.</span><span class="nx">afterFinishInternal</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">style</span><span class="p">);</span><span class="nx">D</span><span class="p">.</span><span class="nx">transforms</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">E</span><span class="p">.</span><span class="nx">style</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">})}}}</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">setup</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="o">||</span><span class="p">[</span><span class="s2">&quot;rgba(0, 0, 0, 0)&quot;</span><span class="p">,</span><span class="s2">&quot;transparent&quot;</span><span class="p">].</span><span class="nx">include</span><span class="p">(</span><span class="nx">B</span><span class="p">)){</span><span class="nx">B</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">}</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">parseColor</span><span class="p">();</span><span class="k">return</span> <span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">C</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">C</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="mi">16</span><span class="p">)})}</span><span class="k">this</span><span class="p">.</span><span class="nx">transforms</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">G</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">E</span><span class="o">=</span><span class="nx">G</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">D</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">parseColor</span><span class="p">(</span><span class="s2">&quot;#zzzzzz&quot;</span><span class="p">)</span><span class="o">!=</span><span class="s2">&quot;#zzzzzz&quot;</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">parseColor</span><span class="p">();</span><span class="nx">D</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">==</span><span class="s2">&quot;opacity&quot;</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">.</span><span class="nx">hasLayout</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">zoom</span><span class="o">:</span><span class="mi">1</span><span class="p">})}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">CSS_LENGTH</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">E</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^([\+\-]?[0-9\.]+)(.*)$/</span><span class="p">);</span><span class="nx">E</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="nx">D</span><span class="o">=</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="o">?</span><span class="nx">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:</span><span class="kc">null</span><span class="p">}}}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">F</span><span class="p">);</span><span class="k">return</span><span class="p">{</span><span class="nx">style</span><span class="o">:</span><span class="nx">F</span><span class="p">.</span><span class="nx">camelize</span><span class="p">(),</span><span class="nx">originalValue</span><span class="o">:</span><span class="nx">D</span><span class="o">==</span><span class="s2">&quot;color&quot;</span><span class="o">?</span><span class="nx">A</span><span class="p">(</span><span class="nx">B</span><span class="p">)</span><span class="o">:</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">B</span><span class="o">||</span><span class="mi">0</span><span class="p">),</span><span class="nx">targetValue</span><span class="o">:</span><span class="nx">D</span><span class="o">==</span><span class="s2">&quot;color&quot;</span><span class="o">?</span><span class="nx">A</span><span class="p">(</span><span class="nx">E</span><span class="p">)</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">unit</span><span class="o">:</span><span class="nx">D</span><span class="p">}}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)).</span><span class="nx">reject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span><span class="p">((</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="o">==</span><span class="nx">B</span><span class="p">.</span><span class="nx">targetValue</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">unit</span><span class="o">!=</span><span class="s2">&quot;color&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="p">)</span><span class="o">||</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">targetValue</span><span class="p">))))})},</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">{},</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">transforms</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">C</span><span class="o">--</span><span class="p">){</span><span class="nx">D</span><span class="p">[(</span><span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">transforms</span><span class="p">[</span><span class="nx">C</span><span class="p">]).</span><span class="nx">style</span><span class="p">]</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">unit</span><span class="o">==</span><span class="s2">&quot;color&quot;</span><span class="o">?</span><span class="s2">&quot;#&quot;</span><span class="o">+</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">targetValue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="nx">A</span><span class="p">)).</span><span class="nx">toColorPart</span><span class="p">()</span><span class="o">+</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">targetValue</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="nx">A</span><span class="p">)).</span><span class="nx">toColorPart</span><span class="p">()</span><span class="o">+</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">targetValue</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="nx">A</span><span class="p">)).</span><span class="nx">toColorPart</span><span class="p">()</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="o">+</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">targetValue</span><span class="o">-</span><span class="nx">B</span><span class="p">.</span><span class="nx">originalValue</span><span class="p">)</span><span class="o">*</span><span class="nx">A</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">unit</span><span class="o">===</span><span class="kc">null</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">unit</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="kc">true</span><span class="p">)}});</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Transform</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{};</span><span class="k">this</span><span class="p">.</span><span class="nx">addTracks</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">addTracks</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$H</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">values</span><span class="p">().</span><span class="nx">first</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$H</span><span class="p">({</span><span class="nx">ids</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">keys</span><span class="p">().</span><span class="nx">first</span><span class="p">(),</span><span class="nx">effect</span><span class="o">:</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Morph</span><span class="p">,</span><span class="nx">options</span><span class="o">:</span><span class="p">{</span><span class="nx">style</span><span class="o">:</span><span class="nx">C</span><span class="p">}}))}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">play</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Parallel</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;ids&quot;</span><span class="p">),</span><span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;effect&quot;</span><span class="p">),</span><span class="nx">B</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">[</span><span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">||</span><span class="nx">$$</span><span class="p">(</span><span class="nx">D</span><span class="p">)].</span><span class="nx">flatten</span><span class="p">();</span><span class="k">return</span> <span class="nx">E</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">C</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">sync</span><span class="o">:</span><span class="kc">true</span><span class="p">},</span><span class="nx">B</span><span class="p">))})}).</span><span class="nx">flatten</span><span class="p">(),</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">)}});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">CSS_PROPERTIES</span><span class="o">=</span><span class="nx">$w</span><span class="p">(</span><span class="s2">&quot;backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex&quot;</span><span class="p">);</span><span class="nx">Element</span><span class="p">.</span><span class="nx">CSS_LENGTH</span><span class="o">=</span><span class="sr">/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/</span><span class="p">;</span><span class="nb">String</span><span class="p">.</span><span class="nx">__parseStyleElement</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">parseStyle</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="nx">$H</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="k">new</span> <span class="nx">Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,{</span><span class="nx">style</span><span class="o">:</span><span class="k">this</span><span class="p">}).</span><span class="nx">style</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nb">String</span><span class="p">.</span><span class="nx">__parseStyleElement</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s1">&#39;&lt;div style=&quot;&#39;</span><span class="o">+</span><span class="k">this</span><span class="o">+</span><span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">;</span><span class="nx">B</span><span class="o">=</span><span class="nb">String</span><span class="p">.</span><span class="nx">__parseStyleElement</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">style</span><span class="p">}</span><span class="nx">Element</span><span class="p">.</span><span class="nx">CSS_PROPERTIES</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">]){</span><span class="nx">A</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">[</span><span class="nx">C</span><span class="p">])}});</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">)){</span><span class="nx">A</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/opacity:\s*((?:0|1)?(?:\.\d*)?)/</span><span class="p">)[</span><span class="mi">1</span><span class="p">])}</span><span class="k">return</span> <span class="nx">A</span><span class="p">};</span><span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">defaultView</span><span class="o">&amp;&amp;</span><span class="nb">document</span><span class="p">.</span><span class="nx">defaultView</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyles</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">defaultView</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="kc">null</span><span class="p">);</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">CSS_PROPERTIES</span><span class="p">.</span><span class="nx">inject</span><span class="p">({},</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="nx">C</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">D</span><span class="p">];</span><span class="k">return</span> <span class="nx">C</span><span class="p">})}}</span><span class="k">else</span><span class="p">{</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyles</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">,</span><span class="nx">C</span><span class="p">;</span><span class="nx">C</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">CSS_PROPERTIES</span><span class="p">.</span><span class="nx">inject</span><span class="p">({},</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="nx">D</span><span class="p">[</span><span class="nx">E</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="k">return</span> <span class="nx">D</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="p">.</span><span class="nx">opacity</span><span class="p">){</span><span class="nx">C</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getOpacity</span><span class="p">()}</span><span class="k">return</span> <span class="nx">C</span><span class="p">}}</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Methods</span><span class="o">=</span><span class="p">{</span><span class="nx">morph</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Morph</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">style</span><span class="o">:</span><span class="nx">B</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="p">{}));</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">visualEffect</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">E</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">dasherize</span><span class="p">().</span><span class="nx">camelize</span><span class="p">(),</span><span class="nx">A</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">+</span><span class="nx">D</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">[</span><span class="nx">A</span><span class="p">](</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">C</span><span class="p">},</span><span class="nx">highlight</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Highlight</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="k">return</span> <span class="nx">B</span><span class="p">}};</span><span class="nx">$w</span><span class="p">(</span><span class="s2">&quot;fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut&quot;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Methods</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="nx">Effect</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">)](</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="nx">C</span><span class="p">}});</span><span class="nx">$w</span><span class="p">(</span><span class="s2">&quot;getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles&quot;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Methods</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">=</span><span class="nx">Element</span><span class="p">[</span><span class="nx">A</span><span class="p">]});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">addMethods</span><span class="p">(</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Methods</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">Effect</span><span class="p">)){</span><span class="k">throw</span> <span class="p">(</span><span class="s2">&quot;dragdrop.js requires including script.aculo.us&#39; effects.js library&quot;</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">Droppables</span><span class="o">=</span><span class="p">{</span><span class="nx">drops</span><span class="o">:</span><span class="p">[],</span><span class="nx">remove</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">drops</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">drops</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="o">==</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">)})},</span><span class="nx">add</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">greedy</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">hoverclass</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">tree</span><span class="o">:</span><span class="kc">false</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">containment</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">_containers</span><span class="o">=</span><span class="p">[];</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">containment</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="nx">C</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">_containers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">))})}</span><span class="k">else</span><span class="p">{</span><span class="nx">A</span><span class="p">.</span><span class="nx">_containers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">))}}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">accept</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">accept</span><span class="o">=</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">accept</span><span class="p">].</span><span class="nx">flatten</span><span class="p">()}</span><span class="nx">Element</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">drops</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">findDeepestChild</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">deepest</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">isParent</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">element</span><span class="p">,</span><span class="nx">deepest</span><span class="p">.</span><span class="nx">element</span><span class="p">)){</span><span class="nx">deepest</span><span class="o">=</span><span class="nx">A</span><span class="p">[</span><span class="nx">i</span><span class="p">]}}</span><span class="k">return</span> <span class="nx">deepest</span><span class="p">},</span><span class="nx">isContained</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">tree</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">treeNode</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">}</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">_containers</span><span class="p">.</span><span class="nx">detect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">C</span><span class="o">==</span><span class="nx">D</span><span class="p">})},</span><span class="nx">isAffected</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span><span class="p">((</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="o">!=</span><span class="nx">C</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">((</span><span class="o">!</span><span class="nx">B</span><span class="p">.</span><span class="nx">_containers</span><span class="p">)</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">isContained</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">((</span><span class="o">!</span><span class="nx">B</span><span class="p">.</span><span class="nx">accept</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">classNames</span><span class="p">(</span><span class="nx">C</span><span class="p">).</span><span class="nx">detect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">accept</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">D</span><span class="p">)})))</span><span class="o">&amp;&amp;</span><span class="nx">Position</span><span class="p">.</span><span class="nx">within</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]))},</span><span class="nx">deactivate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">hoverclass</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">removeClassName</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">hoverclass</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="o">=</span><span class="kc">null</span><span class="p">},</span><span class="nx">activate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">hoverclass</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">hoverclass</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="o">=</span><span class="nx">A</span><span class="p">},</span><span class="nx">show</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">drops</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">drops</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">isAffected</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">E</span><span class="p">)){</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">E</span><span class="p">)}});</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">findDeepestChild</span><span class="p">(</span><span class="nx">D</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="o">!=</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">deactivate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">within</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">onHover</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">onHover</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">Position</span><span class="p">.</span><span class="nx">overlap</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">overlap</span><span class="p">,</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">))}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="o">!=</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">){</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">activate</span><span class="p">(</span><span class="nx">B</span><span class="p">)}}},</span><span class="nx">fire</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="nx">Position</span><span class="p">.</span><span class="nx">prepare</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isAffected</span><span class="p">([</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerX</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerY</span><span class="p">(</span><span class="nx">B</span><span class="p">)],</span><span class="nx">A</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">.</span><span class="nx">onDrop</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">.</span><span class="nx">onDrop</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">return</span> <span class="kc">true</span><span class="p">}}},</span><span class="nx">reset</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">deactivate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">last_active</span><span class="p">)}}};</span><span class="kd">var</span> <span class="nx">Draggables</span><span class="o">=</span><span class="p">{</span><span class="nx">drags</span><span class="o">:</span><span class="p">[],</span><span class="nx">observers</span><span class="o">:</span><span class="p">[],</span><span class="nx">register</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">drags</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseUp</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">endDrag</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseMove</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">updateDrag</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">eventKeypress</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">keyPress</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="s2">&quot;mouseup&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseUp</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="s2">&quot;mousemove&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseMove</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="s2">&quot;keypress&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventKeypress</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">drags</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">unregister</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">drags</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">drags</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="o">==</span><span class="nx">A</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">drags</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="s2">&quot;mouseup&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseUp</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="s2">&quot;mousemove&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseMove</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="s2">&quot;keypress&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventKeypress</span><span class="p">)}},</span><span class="nx">activate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">delay</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_timeout</span><span class="o">=</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_timeout</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="nb">window</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="o">=</span><span class="nx">A</span><span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">A</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">delay</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nb">window</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="o">=</span><span class="nx">A</span><span class="p">}},</span><span class="nx">deactivate</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="o">=</span><span class="kc">null</span><span class="p">},</span><span class="nx">updateDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">[</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerX</span><span class="p">(</span><span class="nx">A</span><span class="p">),</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerY</span><span class="p">(</span><span class="nx">A</span><span class="p">)];</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_lastPointer</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_lastPointer</span><span class="p">.</span><span class="nx">inspect</span><span class="p">()</span><span class="o">==</span><span class="nx">B</span><span class="p">.</span><span class="nx">inspect</span><span class="p">())){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">_lastPointer</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="p">.</span><span class="nx">updateDrag</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">)},</span><span class="nx">endDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_timeout</span><span class="p">){</span><span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_timeout</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_timeout</span><span class="o">=</span><span class="kc">null</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">_lastPointer</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="p">.</span><span class="nx">endDrag</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="o">=</span><span class="kc">null</span><span class="p">},</span><span class="nx">keyPress</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">activeDraggable</span><span class="p">.</span><span class="nx">keyPress</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">addObserver</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_cacheObserverCallbacks</span><span class="p">()},</span><span class="nx">removeObserver</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="o">==</span><span class="nx">A</span><span class="p">});</span><span class="k">this</span><span class="p">.</span><span class="nx">_cacheObserverCallbacks</span><span class="p">()},</span><span class="nx">notify</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">B</span><span class="o">+</span><span class="s2">&quot;Count&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">[</span><span class="nx">B</span><span class="p">]){</span><span class="nx">D</span><span class="p">[</span><span class="nx">B</span><span class="p">](</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">)}})}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">B</span><span class="p">]){</span><span class="nx">A</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">B</span><span class="p">](</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">)}},</span><span class="nx">_cacheObserverCallbacks</span><span class="o">:</span><span class="kd">function</span><span class="p">(){[</span><span class="s2">&quot;onStart&quot;</span><span class="p">,</span><span class="s2">&quot;onEnd&quot;</span><span class="p">,</span><span class="s2">&quot;onDrag&quot;</span><span class="p">].</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Draggables</span><span class="p">[</span><span class="nx">A</span><span class="o">+</span><span class="s2">&quot;Count&quot;</span><span class="p">]</span><span class="o">=</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">[</span><span class="nx">A</span><span class="p">]}).</span><span class="nx">length</span><span class="p">})}};</span><span class="kd">var</span> <span class="nx">Draggable</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="p">{</span><span class="nx">handle</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">reverteffect</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">E</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">E</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">D</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mf">0.02</span><span class="p">;</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Move</span><span class="p">(</span><span class="nx">F</span><span class="p">,{</span><span class="nx">x</span><span class="o">:-</span><span class="nx">D</span><span class="p">,</span><span class="nx">y</span><span class="o">:-</span><span class="nx">E</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="nx">G</span><span class="p">,</span><span class="nx">queue</span><span class="o">:</span><span class="p">{</span><span class="nx">scope</span><span class="o">:</span><span class="s2">&quot;_draggable&quot;</span><span class="p">,</span><span class="nx">position</span><span class="o">:</span><span class="s2">&quot;end&quot;</span><span class="p">}})},</span><span class="nx">endeffect</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">_opacity</span><span class="p">)</span><span class="o">?</span><span class="nx">E</span><span class="p">.</span><span class="nx">_opacity</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">E</span><span class="p">,{</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.2</span><span class="p">,</span><span class="nx">from</span><span class="o">:</span><span class="mf">0.7</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">queue</span><span class="o">:</span><span class="p">{</span><span class="nx">scope</span><span class="o">:</span><span class="s2">&quot;_draggable&quot;</span><span class="p">,</span><span class="nx">position</span><span class="o">:</span><span class="s2">&quot;end&quot;</span><span class="p">},</span><span class="nx">afterFinish</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Draggable</span><span class="p">.</span><span class="nx">_dragging</span><span class="p">[</span><span class="nx">E</span><span class="p">]</span><span class="o">=</span><span class="kc">false</span><span class="p">}})},</span><span class="nx">zindex</span><span class="o">:</span><span class="mi">1000</span><span class="p">,</span><span class="nx">revert</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">quiet</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scroll</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scrollSensitivity</span><span class="o">:</span><span class="mi">20</span><span class="p">,</span><span class="nx">scrollSpeed</span><span class="o">:</span><span class="mi">15</span><span class="p">,</span><span class="nx">snap</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">delay</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">endeffect</span><span class="p">)){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">C</span><span class="p">,{</span><span class="nx">starteffect</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">_opacity</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getOpacity</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="nx">Draggable</span><span class="p">.</span><span class="nx">_dragging</span><span class="p">[</span><span class="nx">D</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Opacity</span><span class="p">(</span><span class="nx">D</span><span class="p">,{</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.2</span><span class="p">,</span><span class="nx">from</span><span class="o">:</span><span class="nx">D</span><span class="p">.</span><span class="nx">_opacity</span><span class="p">,</span><span class="nx">to</span><span class="o">:</span><span class="mf">0.7</span><span class="p">})}})}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">handle</span><span class="o">&amp;&amp;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">handle</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">down</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">handle</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">handle</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">scroll</span><span class="o">&amp;&amp;!</span><span class="nx">A</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollTo</span><span class="o">&amp;&amp;!</span><span class="nx">A</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">outerHTML</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">scroll</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">scroll</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_isScrollChild</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">childOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">scroll</span><span class="p">)}</span><span class="nx">Element</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseDown</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">initDrag</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="p">,</span><span class="s2">&quot;mousedown&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseDown</span><span class="p">);</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="k">this</span><span class="p">)},</span><span class="nx">destroy</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="p">,</span><span class="s2">&quot;mousedown&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseDown</span><span class="p">);</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">unregister</span><span class="p">(</span><span class="k">this</span><span class="p">)},</span><span class="nx">currentDelta</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="p">([</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;0&quot;</span><span class="p">),</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="s2">&quot;top&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;0&quot;</span><span class="p">)])},</span><span class="nx">initDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">Draggable</span><span class="p">.</span><span class="nx">_dragging</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="nx">Draggable</span><span class="p">.</span><span class="nx">_dragging</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">]){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">Event</span><span class="p">.</span><span class="nx">isLeftClick</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Event</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">((</span><span class="nx">tag_name</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">())</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">tag_name</span><span class="o">==</span><span class="s2">&quot;INPUT&quot;</span><span class="o">||</span><span class="nx">tag_name</span><span class="o">==</span><span class="s2">&quot;SELECT&quot;</span><span class="o">||</span><span class="nx">tag_name</span><span class="o">==</span><span class="s2">&quot;OPTION&quot;</span><span class="o">||</span><span class="nx">tag_name</span><span class="o">==</span><span class="s2">&quot;BUTTON&quot;</span><span class="o">||</span><span class="nx">tag_name</span><span class="o">==</span><span class="s2">&quot;TEXTAREA&quot;</span><span class="p">)){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">[</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerX</span><span class="p">(</span><span class="nx">A</span><span class="p">),</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerY</span><span class="p">(</span><span class="nx">A</span><span class="p">)];</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">B</span><span class="p">[</span><span class="nx">E</span><span class="p">]</span><span class="o">-</span><span class="nx">D</span><span class="p">[</span><span class="nx">E</span><span class="p">])});</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">activate</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">startDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">delta</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">delta</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">currentDelta</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">zindex</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">originalZ</span><span class="o">=</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="s2">&quot;z-index&quot;</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zIndex</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">zindex</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ghosting</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_clone</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_originallyAbsolute</span><span class="o">=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_originallyAbsolute</span><span class="p">){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">absolutize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_clone</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="o">==</span><span class="nb">window</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_getWindowScroll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">originalScrollLeft</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">originalScrollTop</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">top</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">originalScrollLeft</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">originalScrollTop</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">}}</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s2">&quot;onStart&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">starteffect</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">starteffect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}},</span><span class="nx">updateDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span><span class="nx">pointer</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">startDrag</span><span class="p">(</span><span class="nx">event</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">quiet</span><span class="p">){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">prepare</span><span class="p">();</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">pointer</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s2">&quot;onDrag&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="nx">event</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">pointer</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">change</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">stopScrolling</span><span class="p">();</span><span class="kd">var</span> <span class="nx">p</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="o">==</span><span class="nb">window</span><span class="p">){</span><span class="kd">with</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_getWindowScroll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">)){</span><span class="nx">p</span><span class="o">=</span><span class="p">[</span><span class="nx">left</span><span class="p">,</span><span class="nx">top</span><span class="p">,</span><span class="nx">left</span><span class="o">+</span><span class="nx">width</span><span class="p">,</span><span class="nx">top</span><span class="o">+</span><span class="nx">height</span><span class="p">]}}</span><span class="k">else</span><span class="p">{</span><span class="nx">p</span><span class="o">=</span><span class="nx">Position</span><span class="p">.</span><span class="nx">page</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">);</span><span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">+</span><span class="nx">Position</span><span class="p">.</span><span class="nx">deltaX</span><span class="p">;</span><span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">+</span><span class="nx">Position</span><span class="p">.</span><span class="nx">deltaY</span><span class="p">;</span><span class="nx">p</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">);</span><span class="nx">p</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">speed</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">pointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">)){</span><span class="nx">speed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">pointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">pointer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">)){</span><span class="nx">speed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nx">pointer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">pointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">)){</span><span class="nx">speed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">pointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">pointer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">)){</span><span class="nx">speed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nx">pointer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">startScrolling</span><span class="p">(</span><span class="nx">speed</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">scrollBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">event</span><span class="p">)},</span><span class="nx">finishDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">quiet</span><span class="p">){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">prepare</span><span class="p">();</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">[</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerX</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerY</span><span class="p">(</span><span class="nx">B</span><span class="p">)];</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ghosting</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_originallyAbsolute</span><span class="p">){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">relativize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}</span><span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_originallyAbsolute</span><span class="p">;</span><span class="nx">Element</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_clone</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_clone</span><span class="o">=</span><span class="kc">null</span><span class="p">}</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="nx">F</span><span class="o">=</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">F</span><span class="p">){</span><span class="nx">F</span><span class="o">=</span><span class="kc">false</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onDropped</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onDropped</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s2">&quot;onEnd&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">revert</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">A</span><span class="p">)){</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">currentDelta</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">reverteffect</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="o">==</span><span class="mi">0</span><span class="o">||</span><span class="nx">A</span><span class="o">!=</span><span class="s2">&quot;failure&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">reverteffect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">delta</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">])}}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">delta</span><span class="o">=</span><span class="nx">C</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">zindex</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zIndex</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">originalZ</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endeffect</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endeffect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">deactivate</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">reset</span><span class="p">()},</span><span class="nx">keyPress</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">keyCode</span><span class="o">!=</span><span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_ESC</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">finishDrag</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">endDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">stopScrolling</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">finishDrag</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">draw</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ghosting</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Position</span><span class="p">.</span><span class="nx">realOffset</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">);</span><span class="nx">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">Position</span><span class="p">.</span><span class="nx">deltaX</span><span class="p">;</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nx">Position</span><span class="p">.</span><span class="nx">deltaY</span><span class="p">}</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">currentDelta</span><span class="p">();</span><span class="nx">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-=</span><span class="nx">E</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-=</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="o">!=</span><span class="nb">window</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">_isScrollChild</span><span class="p">)){</span><span class="nx">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">originalScrollLeft</span><span class="p">;</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">originalScrollTop</span><span class="p">}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="nx">G</span><span class="p">]</span><span class="o">-</span><span class="nx">F</span><span class="p">[</span><span class="nx">G</span><span class="p">]</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">[</span><span class="nx">G</span><span class="p">])}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">snap</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">snap</span><span class="p">)){</span><span class="nx">D</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">snap</span><span class="p">(</span><span class="nx">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="k">this</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">snap</span><span class="p">)){</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">H</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">G</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">snap</span><span class="p">[</span><span class="nx">H</span><span class="p">]).</span><span class="nx">round</span><span class="p">()</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">snap</span><span class="p">[</span><span class="nx">H</span><span class="p">]}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))}</span><span class="k">else</span><span class="p">{</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">G</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">snap</span><span class="p">).</span><span class="nx">round</span><span class="p">()</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">snap</span><span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))}}}</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">;</span><span class="k">if</span><span class="p">((</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">constraint</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">constraint</span><span class="o">==</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">((</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">constraint</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">constraint</span><span class="o">==</span><span class="s2">&quot;vertical&quot;</span><span class="p">)){</span><span class="nx">B</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">visibility</span><span class="o">==</span><span class="s2">&quot;hidden&quot;</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">visibility</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">}},</span><span class="nx">stopScrolling</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollInterval</span><span class="p">){</span><span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollInterval</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollInterval</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="o">=</span><span class="kc">null</span><span class="p">}},</span><span class="nx">startScrolling</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">||</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">])){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="o">=</span><span class="p">[</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">,</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">];</span><span class="k">this</span><span class="p">.</span><span class="nx">lastScrolled</span><span class="o">=</span><span class="k">new</span> <span class="nb">Date</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollInterval</span><span class="o">=</span><span class="nx">setInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="mi">10</span><span class="p">)},</span><span class="nx">scroll</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">current</span><span class="o">=</span><span class="k">new</span> <span class="nb">Date</span><span class="p">();</span><span class="kd">var</span> <span class="nx">delta</span><span class="o">=</span><span class="nx">current</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">lastScrolled</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">lastScrolled</span><span class="o">=</span><span class="nx">current</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="o">==</span><span class="nb">window</span><span class="p">){</span><span class="kd">with</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_getWindowScroll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">[</span><span class="mi">1</span><span class="p">]){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">delta</span><span class="o">/</span><span class="mi">1000</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">left</span><span class="o">+</span><span class="nx">d</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">top</span><span class="o">+</span><span class="nx">d</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">[</span><span class="mi">1</span><span class="p">])}}}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">+=</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">delta</span><span class="o">/</span><span class="mi">1000</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scroll</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">+=</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">delta</span><span class="o">/</span><span class="mi">1000</span><span class="p">}</span><span class="nx">Position</span><span class="p">.</span><span class="nx">prepare</span><span class="p">();</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastPointer</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">);</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s2">&quot;onDrag&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isScrollChild</span><span class="p">){</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="o">=</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="o">||</span><span class="nx">$A</span><span class="p">(</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastPointer</span><span class="p">);</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">delta</span><span class="o">/</span><span class="mi">1000</span><span class="p">;</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">delta</span><span class="o">/</span><span class="mi">1000</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">_lastScrollPointer</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">change</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="k">this</span><span class="p">)}},</span><span class="nx">_getWindowScroll</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">w</span><span class="p">){</span><span class="kd">var</span> <span class="nx">T</span><span class="p">,</span><span class="nx">L</span><span class="p">,</span><span class="nx">W</span><span class="p">,</span><span class="nx">H</span><span class="p">;</span><span class="kd">with</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nb">document</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="o">&amp;&amp;</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">){</span><span class="nx">T</span><span class="o">=</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span><span class="nx">L</span><span class="o">=</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">){</span><span class="nx">T</span><span class="o">=</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span><span class="nx">L</span><span class="o">=</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">){</span><span class="nx">W</span><span class="o">=</span><span class="nx">w</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">;</span><span class="nx">H</span><span class="o">=</span><span class="nx">w</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="o">&amp;&amp;</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">){</span><span class="nx">W</span><span class="o">=</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">;</span><span class="nx">H</span><span class="o">=</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">W</span><span class="o">=</span><span class="nx">body</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">;</span><span class="nx">H</span><span class="o">=</span><span class="nx">body</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">}}}</span><span class="k">return</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">T</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">L</span><span class="p">,</span><span class="nx">width</span><span class="o">:</span><span class="nx">W</span><span class="p">,</span><span class="nx">height</span><span class="o">:</span><span class="nx">H</span><span class="p">}}});</span><span class="nx">Draggable</span><span class="p">.</span><span class="nx">_dragging</span><span class="o">=</span><span class="p">{};</span><span class="kd">var</span> <span class="nx">SortableObserver</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)},</span><span class="nx">onStart</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)},</span><span class="nx">onEnd</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">unmark</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">!=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}}});</span><span class="kd">var</span> <span class="nx">Sortable</span><span class="o">=</span><span class="p">{</span><span class="nx">SERIALIZE_RULE</span><span class="o">:</span><span class="sr">/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/</span><span class="p">,</span><span class="nx">sortables</span><span class="o">:</span><span class="p">{},</span><span class="nx">_findRootElement</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">while</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">!=</span><span class="s2">&quot;BODY&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="o">&amp;&amp;</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">sortables</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="p">]){</span><span class="k">return</span> <span class="nx">A</span><span class="p">}</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">}},</span><span class="nx">options</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_findRootElement</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">return</span> <span class="nx">Sortable</span><span class="p">.</span><span class="nx">sortables</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="p">]},</span><span class="nx">destroy</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">sortables</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">removeObserver</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">droppables</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">C</span><span class="p">)});</span><span class="nx">B</span><span class="p">.</span><span class="nx">draggables</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="s2">&quot;destroy&quot;</span><span class="p">);</span><span class="k">delete</span> <span class="nx">Sortable</span><span class="p">.</span><span class="nx">sortables</span><span class="p">[</span><span class="nx">B</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">id</span><span class="p">]}},</span><span class="nx">create</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">element</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">tag</span><span class="o">:</span><span class="s2">&quot;li&quot;</span><span class="p">,</span><span class="nx">dropOnEmpty</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">tree</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">treeTag</span><span class="o">:</span><span class="s2">&quot;ul&quot;</span><span class="p">,</span><span class="nx">overlap</span><span class="o">:</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span><span class="nx">constraint</span><span class="o">:</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span><span class="nx">containment</span><span class="o">:</span><span class="nx">C</span><span class="p">,</span><span class="nx">handle</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">only</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">delay</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">hoverclass</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">ghosting</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">quiet</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scroll</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">scrollSensitivity</span><span class="o">:</span><span class="mi">20</span><span class="p">,</span><span class="nx">scrollSpeed</span><span class="o">:</span><span class="mi">15</span><span class="p">,</span><span class="nx">format</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">SERIALIZE_RULE</span><span class="p">,</span><span class="nx">elements</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">handles</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">onChange</span><span class="o">:</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">,</span><span class="nx">onUpdate</span><span class="o">:</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">this</span><span class="p">.</span><span class="nx">destroy</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{</span><span class="nx">revert</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">quiet</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">quiet</span><span class="p">,</span><span class="nx">scroll</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">scroll</span><span class="p">,</span><span class="nx">scrollSpeed</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">scrollSpeed</span><span class="p">,</span><span class="nx">scrollSensitivity</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">scrollSensitivity</span><span class="p">,</span><span class="nx">delay</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">delay</span><span class="p">,</span><span class="nx">ghosting</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">ghosting</span><span class="p">,</span><span class="nx">constraint</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">constraint</span><span class="p">,</span><span class="nx">handle</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">handle</span><span class="p">};</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">starteffect</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">starteffect</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">starteffect</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">reverteffect</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">reverteffect</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">reverteffect</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">ghosting</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">reverteffect</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">F</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">F</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="mi">0</span><span class="p">}}}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">endeffect</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">endeffect</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">endeffect</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">zindex</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">zindex</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">zindex</span><span class="p">}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">{</span><span class="nx">overlap</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">overlap</span><span class="p">,</span><span class="nx">containment</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">containment</span><span class="p">,</span><span class="nx">tree</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">tree</span><span class="p">,</span><span class="nx">hoverclass</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">hoverclass</span><span class="p">,</span><span class="nx">onHover</span><span class="o">:</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">onHover</span><span class="p">};</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">{</span><span class="nx">onHover</span><span class="o">:</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">onEmptyHover</span><span class="p">,</span><span class="nx">overlap</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">overlap</span><span class="p">,</span><span class="nx">containment</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">containment</span><span class="p">,</span><span class="nx">hoverclass</span><span class="o">:</span><span class="nx">B</span><span class="p">.</span><span class="nx">hoverclass</span><span class="p">};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cleanWhitespace</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">draggables</span><span class="o">=</span><span class="p">[];</span><span class="nx">B</span><span class="p">.</span><span class="nx">droppables</span><span class="o">=</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">dropOnEmpty</span><span class="o">||</span><span class="nx">B</span><span class="p">.</span><span class="nx">tree</span><span class="p">){</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">E</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">droppables</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">C</span><span class="p">)}(</span><span class="nx">B</span><span class="p">.</span><span class="nx">elements</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">findElements</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">)</span><span class="o">||</span><span class="p">[]).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">handles</span><span class="o">?</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="nx">F</span><span class="p">])</span><span class="o">:</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">handle</span><span class="o">?</span><span class="nx">$</span><span class="p">(</span><span class="nx">H</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">handle</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">:</span><span class="nx">H</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">draggables</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Draggable</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">handle</span><span class="o">:</span><span class="nx">G</span><span class="p">})));</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">D</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">tree</span><span class="p">){</span><span class="nx">H</span><span class="p">.</span><span class="nx">treeNode</span><span class="o">=</span><span class="nx">C</span><span class="p">}</span><span class="nx">B</span><span class="p">.</span><span class="nx">droppables</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">H</span><span class="p">)});</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">tree</span><span class="p">){(</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">findTreeElements</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">)</span><span class="o">||</span><span class="p">[]).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">Droppables</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">E</span><span class="p">);</span><span class="nx">F</span><span class="p">.</span><span class="nx">treeNode</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">droppables</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">F</span><span class="p">)})}</span><span class="k">this</span><span class="p">.</span><span class="nx">sortables</span><span class="p">[</span><span class="nx">C</span><span class="p">.</span><span class="nx">identify</span><span class="p">()]</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="nx">Draggables</span><span class="p">.</span><span class="nx">addObserver</span><span class="p">(</span><span class="k">new</span> <span class="nx">SortableObserver</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">.</span><span class="nx">onUpdate</span><span class="p">))},</span><span class="nx">findElements</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">findChildren</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">only</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">tree</span><span class="o">?</span><span class="kc">true</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">tag</span><span class="p">)},</span><span class="nx">findTreeElements</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">findChildren</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">only</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">tree</span><span class="o">?</span><span class="kc">true</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">treeTag</span><span class="p">)},</span><span class="nx">onHover</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">isParent</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">)){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&gt;</span><span class="mf">0.33</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="o">&lt;</span><span class="mf">0.66</span><span class="o">&amp;&amp;</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">D</span><span class="p">).</span><span class="nx">tree</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">){</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">mark</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="s2">&quot;before&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">previousSibling</span><span class="o">!=</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="nx">E</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">D</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">!=</span><span class="nx">B</span><span class="p">){</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">B</span><span class="p">).</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">E</span><span class="p">)}</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">).</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">E</span><span class="p">)}}</span><span class="k">else</span><span class="p">{</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">mark</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="s2">&quot;after&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">nextSibling</span><span class="o">||</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="o">!=</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="nx">E</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">!=</span><span class="nx">B</span><span class="p">){</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">B</span><span class="p">).</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">E</span><span class="p">)}</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">).</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">E</span><span class="p">)}}}},</span><span class="nx">onEmptyHover</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">G</span><span class="p">,</span><span class="nx">H</span><span class="p">){</span><span class="kd">var</span> <span class="nx">I</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">G</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Element</span><span class="p">.</span><span class="nx">isParent</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">E</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">F</span><span class="p">;</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">findElements</span><span class="p">(</span><span class="nx">G</span><span class="p">,{</span><span class="nx">tag</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">tag</span><span class="p">,</span><span class="nx">only</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">only</span><span class="p">});</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">offsetSize</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">overlap</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nx">H</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">F</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">F</span><span class="o">&lt;</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">F</span><span class="o">+=</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">-</span><span class="nx">Element</span><span class="p">.</span><span class="nx">offsetSize</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">F</span><span class="p">],</span><span class="nx">A</span><span class="p">.</span><span class="nx">overlap</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">){</span><span class="nx">D</span><span class="o">-=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">offsetSize</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">F</span><span class="p">],</span><span class="nx">A</span><span class="p">.</span><span class="nx">overlap</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">-</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">offsetSize</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">F</span><span class="p">],</span><span class="nx">A</span><span class="p">.</span><span class="nx">overlap</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">F</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="nx">C</span><span class="p">[</span><span class="nx">F</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="kc">null</span><span class="p">;</span><span class="k">break</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">[</span><span class="nx">F</span><span class="p">];</span><span class="k">break</span><span class="p">}}}}</span><span class="nx">G</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">B</span><span class="p">);</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">I</span><span class="p">).</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">E</span><span class="p">)}},</span><span class="nx">unmark</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="p">){</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="p">.</span><span class="nx">hide</span><span class="p">()}},</span><span class="nx">mark</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="o">&amp;&amp;!</span><span class="nx">D</span><span class="p">.</span><span class="nx">ghosting</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="p">){</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="o">=</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;dropmarker&quot;</span><span class="p">)</span><span class="o">||</span><span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;DIV&quot;</span><span class="p">))).</span><span class="nx">hide</span><span class="p">().</span><span class="nx">addClassName</span><span class="p">(</span><span class="s2">&quot;dropmarker&quot;</span><span class="p">).</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span><span class="s2">&quot;absolute&quot;</span><span class="p">});</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">();</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">left</span><span class="o">:</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">,</span><span class="nx">top</span><span class="o">:</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">==</span><span class="s2">&quot;after&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">overlap</span><span class="o">==</span><span class="s2">&quot;horizontal&quot;</span><span class="p">){</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">left</span><span class="o">:</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">})}</span><span class="k">else</span><span class="p">{</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">top</span><span class="o">:</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">})}}</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_marker</span><span class="p">.</span><span class="nx">show</span><span class="p">()},</span><span class="nx">_tree</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">F</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">findElements</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">B</span><span class="p">)</span><span class="o">||</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">C</span><span class="o">&lt;</span><span class="nx">D</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="o">++</span><span class="nx">C</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="nx">C</span><span class="p">].</span><span class="nx">id</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">format</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">){</span><span class="k">continue</span><span class="p">}</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">A</span><span class="o">?</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="kc">null</span><span class="p">),</span><span class="nx">element</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">parent</span><span class="o">:</span><span class="nx">F</span><span class="p">,</span><span class="nx">children</span><span class="o">:</span><span class="p">[],</span><span class="nx">position</span><span class="o">:</span><span class="nx">F</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">container</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">[</span><span class="nx">C</span><span class="p">]).</span><span class="nx">down</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">treeTag</span><span class="p">)};</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="p">.</span><span class="nx">container</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_tree</span><span class="p">(</span><span class="nx">G</span><span class="p">.</span><span class="nx">container</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">G</span><span class="p">)}</span><span class="nx">F</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">G</span><span class="p">)}</span><span class="k">return</span> <span class="nx">F</span><span class="p">},</span><span class="nx">tree</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">tag</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">tag</span><span class="p">,</span><span class="nx">treeTag</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">treeTag</span><span class="p">,</span><span class="nx">only</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">only</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="nx">D</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">format</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">format</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">parent</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">children</span><span class="o">:</span><span class="p">[],</span><span class="nx">container</span><span class="o">:</span><span class="nx">D</span><span class="p">,</span><span class="nx">position</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span><span class="k">return</span> <span class="nx">Sortable</span><span class="p">.</span><span class="nx">_tree</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">_constructIndex</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">id</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">position</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="o">+</span><span class="nx">A</span><span class="p">}}</span><span class="k">while</span><span class="p">((</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span><span class="o">!=</span><span class="kc">null</span><span class="p">);</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">sequence</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">findElements</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">)</span><span class="o">||</span><span class="p">[]).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">return</span> <span class="nx">C</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">format</span><span class="p">)</span><span class="o">?</span><span class="nx">C</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">format</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">})},</span><span class="nx">setSequence</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">{};</span><span class="k">this</span><span class="p">.</span><span class="nx">findElements</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">format</span><span class="p">)){</span><span class="nx">D</span><span class="p">[</span><span class="nx">E</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">format</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="p">[</span><span class="nx">E</span><span class="p">,</span><span class="nx">E</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">]}</span><span class="nx">E</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">E</span><span class="p">)});</span><span class="nx">C</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">D</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">F</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="k">delete</span> <span class="nx">D</span><span class="p">[</span><span class="nx">E</span><span class="p">]}})},</span><span class="nx">serialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">options</span><span class="p">(</span><span class="nx">C</span><span class="p">),</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">encodeURIComponent</span><span class="p">((</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">name</span><span class="p">)</span><span class="o">?</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">name</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">tree</span><span class="p">){</span><span class="k">return</span> <span class="nx">Sortable</span><span class="p">.</span><span class="nx">tree</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]).</span><span class="nx">children</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span><span class="p">[</span><span class="nx">A</span><span class="o">+</span><span class="nx">Sortable</span><span class="p">.</span><span class="nx">_constructIndex</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;[id]=&quot;</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">id</span><span class="p">)].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">))}).</span><span class="nx">flatten</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">return</span> <span class="nx">Sortable</span><span class="p">.</span><span class="nx">sequence</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="o">+</span><span class="s2">&quot;[]=&quot;</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">D</span><span class="p">)}).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)}}};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">isParent</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">||</span><span class="nx">B</span><span class="o">==</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">==</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="kc">true</span><span class="p">}</span><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">isParent</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">A</span><span class="p">)};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">findChildren</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">D</span><span class="p">.</span><span class="nx">hasChildNodes</span><span class="p">()){</span><span class="k">return</span> <span class="kc">null</span><span class="p">}</span><span class="nx">C</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="p">[</span><span class="nx">B</span><span class="p">].</span><span class="nx">flatten</span><span class="p">()}</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">[];</span><span class="nx">$A</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="p">.</span><span class="nx">tagName</span><span class="o">&amp;&amp;</span><span class="nx">G</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">==</span><span class="nx">C</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">B</span><span class="o">||</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">classNames</span><span class="p">(</span><span class="nx">G</span><span class="p">).</span><span class="nx">detect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">H</span><span class="p">){</span><span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">H</span><span class="p">)})))){</span><span class="nx">E</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">G</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">findChildren</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">F</span><span class="p">)}}});</span><span class="k">return</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">?</span><span class="nx">E</span><span class="p">.</span><span class="nx">flatten</span><span class="p">()</span><span class="o">:</span><span class="p">[])};</span><span class="nx">Element</span><span class="p">.</span><span class="nx">offsetSize</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="o">+</span><span class="p">((</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;vertical&quot;</span><span class="o">||</span><span class="nx">B</span><span class="o">==</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;Height&quot;</span><span class="o">:</span><span class="s2">&quot;Width&quot;</span><span class="p">)]};</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">Effect</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="k">throw</span> <span class="p">(</span><span class="s2">&quot;controls.js requires including script.aculo.us&#39; effects.js library&quot;</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">Autocompleter</span><span class="o">=</span><span class="p">{};</span><span class="nx">Autocompleter</span><span class="p">.</span><span class="nx">Base</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">baseInitialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">hasFocus</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">oldElementValue</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">setOptions</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">setOptions</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="nx">A</span><span class="o">||</span><span class="p">{}}</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">paramName</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">paramName</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="o">||</span><span class="p">[];</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">frequency</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">frequency</span><span class="o">||</span><span class="mf">0.4</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">minChars</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">minChars</span><span class="o">||</span><span class="mi">1</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onShow</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onShow</span><span class="o">||</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">E</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">||</span><span class="nx">E</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">){</span><span class="nx">E</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="s2">&quot;absolute&quot;</span><span class="p">;</span><span class="nx">Position</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">,{</span><span class="nx">setHeight</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">offsetTop</span><span class="o">:</span><span class="nx">D</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">})}</span><span class="nx">Effect</span><span class="p">.</span><span class="nx">Appear</span><span class="p">(</span><span class="nx">E</span><span class="p">,{</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.15</span><span class="p">})};</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onHide</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onHide</span><span class="o">||</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Fade</span><span class="p">(</span><span class="nx">E</span><span class="p">,{</span><span class="nx">duration</span><span class="o">:</span><span class="mf">0.15</span><span class="p">})};</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="o">=</span><span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;autocomplete&quot;</span><span class="p">,</span><span class="s2">&quot;off&quot;</span><span class="p">);</span><span class="nx">Element</span><span class="p">.</span><span class="nx">hide</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="s2">&quot;blur&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">onBlur</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="s2">&quot;keydown&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">onKeyPress</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">))},</span><span class="nx">show</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">,</span><span class="s2">&quot;display&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;none&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onShow</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">iefix</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;absolute&quot;</span><span class="p">)){</span><span class="k">new</span> <span class="nx">Insertion</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">,</span><span class="s1">&#39;&lt;iframe id=&quot;&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">id</span><span class="o">+</span><span class="s1">&#39;_iefix&quot; style=&quot;display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);&quot; src=&quot;javascript:false;&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot;&gt;&lt;/iframe&gt;&#39;</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">iefix</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">id</span><span class="o">+</span><span class="s2">&quot;_iefix&quot;</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iefix</span><span class="p">){</span><span class="nx">setTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fixIEOverlapping</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="mi">50</span><span class="p">)}},</span><span class="nx">fixIEOverlapping</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Position</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">iefix</span><span class="p">,{</span><span class="nx">setTop</span><span class="o">:</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="p">)});</span><span class="k">this</span><span class="p">.</span><span class="nx">iefix</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zIndex</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="nx">Element</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iefix</span><span class="p">)},</span><span class="nx">hide</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">stopIndicator</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">Element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">,</span><span class="s2">&quot;display&quot;</span><span class="p">)</span><span class="o">!=</span><span class="s2">&quot;none&quot;</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onHide</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iefix</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">hide</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iefix</span><span class="p">)}},</span><span class="nx">startIndicator</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">indicator</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">indicator</span><span class="p">)}},</span><span class="nx">stopIndicator</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">indicator</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">hide</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">indicator</span><span class="p">)}},</span><span class="nx">onKeyPress</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="p">){</span><span class="k">switch</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">){</span><span class="k">case</span> <span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_TAB</span><span class="o">:</span><span class="k">case</span> <span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_RETURN</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">selectEntry</span><span class="p">();</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">case</span> <span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_ESC</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">return</span> <span class="p">;</span><span class="k">case</span> <span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_LEFT</span><span class="o">:</span><span class="k">case</span> <span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_RIGHT</span><span class="o">:</span><span class="k">return</span> <span class="p">;</span><span class="k">case</span> <span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_UP</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">markPrevious</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">return</span> <span class="p">;</span><span class="k">case</span> <span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_DOWN</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">markNext</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">return</span> <span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">keyCode</span><span class="o">==</span><span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_TAB</span><span class="o">||</span><span class="nx">A</span><span class="p">.</span><span class="nx">keyCode</span><span class="o">==</span><span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_RETURN</span><span class="o">||</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">A</span><span class="p">.</span><span class="nx">keyCode</span><span class="o">==</span><span class="mi">0</span><span class="p">)){</span><span class="k">return</span> <span class="p">}}</span><span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">hasFocus</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="p">){</span><span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="o">=</span><span class="nx">setTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onObserverEvent</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">frequency</span><span class="o">*</span><span class="mi">1000</span><span class="p">)},</span><span class="nx">activate</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">hasFocus</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">getUpdatedChoices</span><span class="p">()},</span><span class="nx">onHover</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">Event</span><span class="p">.</span><span class="nx">findElement</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;LI&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">!=</span><span class="nx">A</span><span class="p">.</span><span class="nx">autocompleteIndex</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">autocompleteIndex</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">()}</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">B</span><span class="p">)},</span><span class="nx">onClick</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">Event</span><span class="p">.</span><span class="nx">findElement</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;LI&quot;</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">autocompleteIndex</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">selectEntry</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">hide</span><span class="p">()},</span><span class="nx">onBlur</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">setTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hide</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="mi">250</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">hasFocus</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">},</span><span class="nx">render</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">A</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="p">;</span><span class="nx">A</span><span class="o">++</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">==</span><span class="nx">A</span><span class="o">?</span><span class="nx">Element</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getEntry</span><span class="p">(</span><span class="nx">A</span><span class="p">),</span><span class="s2">&quot;selected&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">Element</span><span class="p">.</span><span class="nx">removeClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getEntry</span><span class="p">(</span><span class="nx">A</span><span class="p">),</span><span class="s2">&quot;selected&quot;</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasFocus</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">true</span><span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">hide</span><span class="p">()}},</span><span class="nx">markPrevious</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">--</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">getEntry</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="p">).</span><span class="nx">scrollIntoView</span><span class="p">(</span><span class="kc">true</span><span class="p">)},</span><span class="nx">markNext</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">++</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">=</span><span class="mi">0</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">getEntry</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="p">).</span><span class="nx">scrollIntoView</span><span class="p">(</span><span class="kc">false</span><span class="p">)},</span><span class="nx">getEntry</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">A</span><span class="p">]},</span><span class="nx">getCurrentEntry</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getEntry</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="p">)},</span><span class="nx">selectEntry</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">updateElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getCurrentEntry</span><span class="p">())},</span><span class="nx">updateElement</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">updateElement</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">updateElement</span><span class="p">(</span><span class="nx">F</span><span class="p">);</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">select</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">F</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">select</span><span class="p">)</span><span class="o">||</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">collectTextNodes</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">select</span><span class="p">)}}</span><span class="k">else</span><span class="p">{</span><span class="nx">D</span><span class="o">=</span><span class="nx">Element</span><span class="p">.</span><span class="nx">collectTextNodesIgnoreClass</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="s2">&quot;informal&quot;</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getTokenBounds</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^\s+/</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">E</span><span class="o">+=</span><span class="nx">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">E</span><span class="o">+</span><span class="nx">D</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">D</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">oldElementValue</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">afterUpdateElement</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">afterUpdateElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">F</span><span class="p">)}},</span><span class="nx">updateChoices</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">hasFocus</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cleanWhitespace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">);</span><span class="nx">Element</span><span class="p">.</span><span class="nx">cleanWhitespace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">down</span><span class="p">());</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">childNodes</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">down</span><span class="p">().</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">A</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="p">;</span><span class="nx">A</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getEntry</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">autocompleteIndex</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">addObservers</span><span class="p">(</span><span class="nx">B</span><span class="p">)}}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="o">=</span><span class="mi">0</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">stopIndicator</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">entryCount</span><span class="o">==</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">autoSelect</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">selectEntry</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">hide</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">()}}},</span><span class="nx">addObservers</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;mouseover&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">onHover</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">onClick</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">))},</span><span class="nx">onObserverEvent</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">tokenBounds</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getToken</span><span class="p">().</span><span class="nx">length</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">minChars</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">getUpdatedChoices</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">hide</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">oldElementValue</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="p">},</span><span class="nx">getToken</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getTokenBounds</span><span class="p">();</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]).</span><span class="nx">strip</span><span class="p">()},</span><span class="nx">getTokenBounds</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="kc">null</span><span class="o">!=</span><span class="k">this</span><span class="p">.</span><span class="nx">tokenBounds</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tokenBounds</span><span class="p">}</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">strip</span><span class="p">().</span><span class="nx">empty</span><span class="p">()){</span><span class="k">return</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]}</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">getFirstDifferencePos</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">oldElementValue</span><span class="p">);</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="p">(</span><span class="nx">F</span><span class="o">==</span><span class="k">this</span><span class="p">.</span><span class="nx">oldElementValue</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">);</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="kd">var</span> <span class="nx">G</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">B</span><span class="o">&lt;</span><span class="nx">A</span><span class="p">;</span><span class="o">++</span><span class="nx">B</span><span class="p">){</span><span class="nx">G</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="p">[</span><span class="nx">B</span><span class="p">],</span><span class="nx">F</span><span class="o">+</span><span class="nx">H</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">G</span><span class="o">&gt;</span><span class="nx">D</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">G</span><span class="p">}</span><span class="nx">G</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">tokens</span><span class="p">[</span><span class="nx">B</span><span class="p">],</span><span class="nx">F</span><span class="o">+</span><span class="nx">H</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">!=</span><span class="nx">G</span><span class="o">&amp;&amp;</span><span class="nx">G</span><span class="o">&lt;</span><span class="nx">C</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nx">G</span><span class="p">}}</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tokenBounds</span><span class="o">=</span><span class="p">[</span><span class="nx">D</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">C</span><span class="p">])}});</span><span class="nx">Autocompleter</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getTokenBounds</span><span class="p">.</span><span class="nx">getFirstDifferencePos</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">B</span><span class="o">&lt;</span><span class="nx">D</span><span class="p">;</span><span class="o">++</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">[</span><span class="nx">B</span><span class="p">]</span><span class="o">!=</span><span class="nx">A</span><span class="p">[</span><span class="nx">B</span><span class="p">]){</span><span class="k">return</span> <span class="nx">B</span><span class="p">}}</span><span class="k">return</span> <span class="nx">D</span><span class="p">};</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">Autocompleter</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Autocompleter</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">baseInitialize</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">asynchronous</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onComplete</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">defaultParams</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="o">||</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="o">=</span><span class="nx">B</span><span class="p">},</span><span class="nx">getUpdatedChoices</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">startIndicator</span><span class="p">();</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">paramName</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getToken</span><span class="p">());</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">callback</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">A</span><span class="p">)</span><span class="o">:</span><span class="nx">A</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">defaultParams</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">parameters</span><span class="o">+=</span><span class="s2">&quot;&amp;&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">defaultParams</span><span class="p">}</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">)},</span><span class="nx">onComplete</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">updateChoices</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">responseText</span><span class="p">)}});</span><span class="nx">Autocompleter</span><span class="p">.</span><span class="nx">Local</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Autocompleter</span><span class="p">.</span><span class="nx">Base</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">baseInitialize</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">array</span><span class="o">=</span><span class="nx">C</span><span class="p">},</span><span class="nx">getUpdatedChoices</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">updateChoices</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">selector</span><span class="p">(</span><span class="k">this</span><span class="p">))},</span><span class="nx">setOptions</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">choices</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="nx">partialSearch</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">partialChars</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">ignoreCase</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">fullSearch</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">selector</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="p">[];</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="p">[];</span><span class="kd">var</span> <span class="nx">H</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">getToken</span><span class="p">();</span><span class="kd">var</span> <span class="nx">G</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">E</span><span class="o">&lt;</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="nx">D</span><span class="p">.</span><span class="nx">length</span><span class="o">&lt;</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">choices</span><span class="p">;</span><span class="nx">E</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">array</span><span class="p">[</span><span class="nx">E</span><span class="p">];</span><span class="kd">var</span> <span class="nx">I</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ignoreCase</span><span class="o">?</span><span class="nx">F</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">H</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span><span class="o">:</span><span class="nx">F</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">H</span><span class="p">);</span><span class="k">while</span><span class="p">(</span><span class="nx">I</span><span class="o">!=-</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">I</span><span class="o">==</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">F</span><span class="p">.</span><span class="nx">length</span><span class="o">!=</span><span class="nx">H</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&lt;li&gt;&lt;strong&gt;&quot;</span><span class="o">+</span><span class="nx">F</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">H</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="o">+</span><span class="nx">F</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">H</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/li&gt;&quot;</span><span class="p">);</span><span class="k">break</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">H</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;=</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">partialChars</span><span class="o">&amp;&amp;</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">partialSearch</span><span class="o">&amp;&amp;</span><span class="nx">I</span><span class="o">!=-</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">fullSearch</span><span class="o">||</span><span class="sr">/\s/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">I</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))){</span><span class="nx">C</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&lt;li&gt;&quot;</span><span class="o">+</span><span class="nx">F</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">I</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;strong&gt;&quot;</span><span class="o">+</span><span class="nx">F</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">I</span><span class="p">,</span><span class="nx">H</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="o">+</span><span class="nx">F</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">I</span><span class="o">+</span><span class="nx">H</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/li&gt;&quot;</span><span class="p">);</span><span class="k">break</span><span class="p">}}}</span><span class="nx">I</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ignoreCase</span><span class="o">?</span><span class="nx">F</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">H</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">(),</span><span class="nx">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="nx">F</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">H</span><span class="p">,</span><span class="nx">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)}}</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">choices</span><span class="o">-</span><span class="nx">D</span><span class="p">.</span><span class="nx">length</span><span class="p">))}</span><span class="k">return</span><span class="s2">&quot;&lt;ul&gt;&quot;</span><span class="o">+</span><span class="nx">D</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/ul&gt;&quot;</span><span class="p">}},</span><span class="nx">A</span><span class="o">||</span><span class="p">{})}});</span><span class="nx">Field</span><span class="p">.</span><span class="nx">scrollFreeActivate</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Field</span><span class="p">.</span><span class="nx">activate</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="mi">1</span><span class="p">)};</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">prepareOptions</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="o">=</span><span class="p">{};</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">dealWithDeprecatedOptions</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span><span class="nx">A</span><span class="o">||</span><span class="p">{});</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">formId</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">id</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">formId</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">id</span><span class="o">+</span><span class="s2">&quot;-inplaceeditor&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">formId</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">formId</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControlOnly</span><span class="o">=</span><span class="kc">false</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">_originalBackground</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;background-color&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;transparent&quot;</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">title</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">clickToEditText</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundCancelHandler</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">handleFormCancellation</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundComplete</span><span class="o">=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onComplete</span><span class="o">||</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundFailureHandler</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">handleAJAXFailure</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundSubmitHandler</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">handleFormSubmission</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundWrapperHandler</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">wrapUp</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">registerListeners</span><span class="p">()},</span><span class="nx">checkForEscapeOrReturn</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_editing</span><span class="o">||</span><span class="nx">A</span><span class="p">.</span><span class="nx">ctrlKey</span><span class="o">||</span><span class="nx">A</span><span class="p">.</span><span class="nx">altKey</span><span class="o">||</span><span class="nx">A</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_ESC</span><span class="o">==</span><span class="nx">A</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">handleFormCancellation</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">Event</span><span class="p">.</span><span class="nx">KEY_RETURN</span><span class="o">==</span><span class="nx">A</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">handleFormSubmission</span><span class="p">(</span><span class="nx">A</span><span class="p">)}}},</span><span class="nx">createControl</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">G</span><span class="o">+</span><span class="s2">&quot;Control&quot;</span><span class="p">];</span><span class="kd">var</span> <span class="nx">F</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">G</span><span class="o">+</span><span class="s2">&quot;Text&quot;</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="o">==</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">F</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;editor_&quot;</span><span class="o">+</span><span class="nx">G</span><span class="o">+</span><span class="s2">&quot;_button&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="s2">&quot;cancel&quot;</span><span class="o">==</span><span class="nx">G</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">onclick</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundCancelHandler</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">[</span><span class="nx">G</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="s2">&quot;link&quot;</span><span class="o">==</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">);</span><span class="nx">D</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">F</span><span class="p">));</span><span class="nx">D</span><span class="p">.</span><span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;cancel&quot;</span><span class="o">==</span><span class="nx">G</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundCancelHandler</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundSubmitHandler</span><span class="p">;</span><span class="nx">D</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;editor_&quot;</span><span class="o">+</span><span class="nx">G</span><span class="o">+</span><span class="s2">&quot;_link&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">D</span><span class="p">.</span><span class="nx">className</span><span class="o">+=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">[</span><span class="nx">G</span><span class="p">]</span><span class="o">=</span><span class="nx">D</span><span class="p">}}},</span><span class="nx">createEditField</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadTextURL</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadingText</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">getText</span><span class="p">());</span><span class="kd">var</span> <span class="nx">B</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="mi">1</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">rows</span><span class="o">&amp;&amp;!</span><span class="sr">/\r|\n/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getText</span><span class="p">())){</span><span class="nx">B</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">size</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">cols</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;</span><span class="nx">A</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">size</span><span class="o">=</span><span class="nx">A</span><span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="nx">B</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;textarea&quot;</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">rows</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">rows</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">autoRows</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">rows</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">cols</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">cols</span><span class="o">||</span><span class="mi">40</span><span class="p">}</span><span class="nx">B</span><span class="p">.</span><span class="nx">name</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">paramName</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="nx">B</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;editor_field&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">submitOnBlur</span><span class="p">){</span><span class="nx">B</span><span class="p">.</span><span class="nx">onblur</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundSubmitHandler</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadTextURL</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">loadExternalText</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">)},</span><span class="nx">createForm</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="o">+</span><span class="nx">D</span><span class="o">+</span><span class="s2">&quot;Controls&quot;</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">C</span><span class="o">||</span><span class="nx">E</span><span class="o">===</span><span class="kc">false</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="nx">B</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">C</span><span class="p">))}</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;form&quot;</span><span class="p">));</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">formId</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">formClassName</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">onsubmit</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundSubmitHandler</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">createEditField</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="s2">&quot;textarea&quot;</span><span class="o">==</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()){</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;br&quot;</span><span class="p">))}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onFormCustomization</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onFormCustomization</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">)}</span><span class="nx">A</span><span class="p">(</span><span class="s2">&quot;Before&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">okControl</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">cancelControl</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">createControl</span><span class="p">(</span><span class="s2">&quot;ok&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundSubmitHandler</span><span class="p">);</span><span class="nx">A</span><span class="p">(</span><span class="s2">&quot;Between&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">okControl</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">cancelControl</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">createControl</span><span class="p">(</span><span class="s2">&quot;cancel&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundCancelHandler</span><span class="p">,</span><span class="s2">&quot;editor_cancel&quot;</span><span class="p">);</span><span class="nx">A</span><span class="p">(</span><span class="s2">&quot;After&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">okControl</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">cancelControl</span><span class="p">)},</span><span class="nx">destroy</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_oldInnerHTML</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_oldInnerHTML</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">leaveEditMode</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">unregisterListeners</span><span class="p">()},</span><span class="nx">enterEditMode</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_saving</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">_editing</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">_editing</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">triggerCallback</span><span class="p">(</span><span class="s2">&quot;onEnterEditMode&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">.</span><span class="nx">hide</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">createForm</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadTextURL</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">postProcessEditField</span><span class="p">()}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">enterHover</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">hoverClassName</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">hoverClassName</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_saving</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">triggerCallback</span><span class="p">(</span><span class="s2">&quot;onEnterHover&quot;</span><span class="p">)},</span><span class="nx">getText</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">unescapeHTML</span><span class="p">()},</span><span class="nx">handleAJAXFailure</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">triggerCallback</span><span class="p">(</span><span class="s2">&quot;onFailure&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_oldInnerHTML</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_oldInnerHTML</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_oldInnerHTML</span><span class="o">=</span><span class="kc">null</span><span class="p">}},</span><span class="nx">handleFormCancellation</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">wrapUp</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">handleFormSubmission</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">;</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">$F</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">prepareSubmission</span><span class="p">();</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">E</span><span class="p">)){</span><span class="nx">E</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">toQueryParams</span><span class="p">()}</span><span class="nx">E</span><span class="p">.</span><span class="nx">editorId</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">htmlResponse</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">evalScripts</span><span class="o">:</span><span class="kc">true</span><span class="p">},</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ajaxOptions</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">parameters</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">onComplete</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundWrapperHandler</span><span class="p">,</span><span class="nx">onFailure</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundFailureHandler</span><span class="p">});</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Updater</span><span class="p">({</span><span class="nx">success</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">},</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="nx">A</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">method</span><span class="o">:</span><span class="s2">&quot;get&quot;</span><span class="p">},</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ajaxOptions</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">parameters</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">onComplete</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundWrapperHandler</span><span class="p">,</span><span class="nx">onFailure</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundFailureHandler</span><span class="p">});</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="nx">A</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">D</span><span class="p">)}},</span><span class="nx">leaveEditMode</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">removeClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">savingClassName</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">removeForm</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">leaveHover</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_originalBackground</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">.</span><span class="nx">show</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">_saving</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_editing</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_oldInnerHTML</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">triggerCallback</span><span class="p">(</span><span class="s2">&quot;onLeaveEditMode&quot;</span><span class="p">)},</span><span class="nx">leaveHover</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">hoverClassName</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">removeClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">hoverClassName</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_saving</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">triggerCallback</span><span class="p">(</span><span class="s2">&quot;onLeaveHover&quot;</span><span class="p">)},</span><span class="nx">loadExternalText</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadingClassName</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">method</span><span class="o">:</span><span class="s2">&quot;get&quot;</span><span class="p">},</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ajaxOptions</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">parameters</span><span class="o">:</span><span class="s2">&quot;editorId=&quot;</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">id</span><span class="p">),</span><span class="nx">onComplete</span><span class="o">:</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">,</span><span class="nx">onSuccess</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">removeClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadingClassName</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">stripLoadedTextTags</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">stripTags</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">postProcessEditField</span><span class="p">()}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">onFailure</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundFailureHandler</span><span class="p">});</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadTextURL</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">postProcessEditField</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">fieldPostCreation</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">)[</span><span class="s2">&quot;focus&quot;</span><span class="o">==</span><span class="nx">A</span><span class="o">?</span><span class="s2">&quot;focus&quot;</span><span class="o">:</span><span class="s2">&quot;activate&quot;</span><span class="p">]()}},</span><span class="nx">prepareOptions</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="p">.</span><span class="nx">DefaultCallbacks</span><span class="p">);[</span><span class="k">this</span><span class="p">.</span><span class="nx">_extraDefaultOptions</span><span class="p">].</span><span class="nx">flatten</span><span class="p">().</span><span class="nx">compact</span><span class="p">().</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span><span class="nx">A</span><span class="p">)}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))},</span><span class="nx">prepareSubmission</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">_saving</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">removeForm</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">leaveHover</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">showSaving</span><span class="p">()},</span><span class="nx">registerListeners</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">_listeners</span><span class="o">=</span><span class="p">{};</span><span class="kd">var</span> <span class="nx">A</span><span class="p">;</span><span class="nx">$H</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="p">.</span><span class="nx">Listeners</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">B</span><span class="p">.</span><span class="nx">value</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_listeners</span><span class="p">[</span><span class="nx">B</span><span class="p">.</span><span class="nx">key</span><span class="p">]</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControlOnly</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span><span class="nx">A</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span><span class="nx">A</span><span class="p">)}}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))},</span><span class="nx">removeForm</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="o">=</span><span class="p">{}},</span><span class="nx">showSaving</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">_oldInnerHTML</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">savingText</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">savingClassName</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_originalBackground</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">show</span><span class="p">()},</span><span class="nx">triggerCallback</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="s2">&quot;function&quot;</span><span class="o">==</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">B</span><span class="p">]){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">B</span><span class="p">](</span><span class="k">this</span><span class="p">,</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">unregisterListeners</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">$H</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_listeners</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControlOnly</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">externalControl</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">value</span><span class="p">)}}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">))},</span><span class="nx">wrapUp</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">leaveEditMode</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">_boundComplete</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)}});</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,{</span><span class="nx">dispose</span><span class="o">:</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">destroy</span><span class="p">});</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceCollectionEditor</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="p">,{</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">$super</span><span class="p">,</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_extraDefaultOptions</span><span class="o">=</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceCollectionEditor</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">;</span><span class="nx">$super</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">createEditField</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;select&quot;</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">name</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">paramName</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">size</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="o">=</span><span class="nx">A</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_collection</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">collection</span><span class="o">||</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadCollectionURL</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">loadCollection</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">checkForExternalText</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">)},</span><span class="nx">loadCollection</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadingClassName</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">showLoadingText</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadingCollectionText</span><span class="p">);</span><span class="kd">var</span> <span class="nx">options</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">method</span><span class="o">:</span><span class="s2">&quot;get&quot;</span><span class="p">},</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ajaxOptions</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">options</span><span class="p">,{</span><span class="nx">parameters</span><span class="o">:</span><span class="s2">&quot;editorId=&quot;</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">id</span><span class="p">),</span><span class="nx">onComplete</span><span class="o">:</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">,</span><span class="nx">onSuccess</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">transport</span><span class="p">){</span><span class="kd">var</span> <span class="nx">js</span><span class="o">=</span><span class="nx">transport</span><span class="p">.</span><span class="nx">responseText</span><span class="p">.</span><span class="nx">strip</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="sr">/^\[.*\]$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">js</span><span class="p">)){</span><span class="k">throw</span> <span class="p">(</span><span class="s2">&quot;Server returned an invalid collection representation.&quot;</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">_collection</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">checkForExternalText</span><span class="p">()}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">onFailure</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">onFailure</span><span class="p">});</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadCollectionURL</span><span class="p">,</span><span class="nx">options</span><span class="p">)},</span><span class="nx">showLoadingText</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="nx">A</span><span class="p">.</span><span class="nx">selected</span><span class="o">=</span><span class="kc">true</span><span class="p">}</span><span class="nx">A</span><span class="p">.</span><span class="nx">update</span><span class="p">((</span><span class="nx">B</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">stripScripts</span><span class="p">().</span><span class="nx">stripTags</span><span class="p">())},</span><span class="nx">checkForExternalText</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getText</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadTextURL</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">loadExternalText</span><span class="p">()}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">buildOptionList</span><span class="p">()}},</span><span class="nx">loadExternalText</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">showLoadingText</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadingText</span><span class="p">);</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">method</span><span class="o">:</span><span class="s2">&quot;get&quot;</span><span class="p">},</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">ajaxOptions</span><span class="p">);</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">parameters</span><span class="o">:</span><span class="s2">&quot;editorId=&quot;</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">id</span><span class="p">),</span><span class="nx">onComplete</span><span class="o">:</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">emptyFunction</span><span class="p">,</span><span class="nx">onSuccess</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_text</span><span class="o">=</span><span class="nx">B</span><span class="p">.</span><span class="nx">responseText</span><span class="p">.</span><span class="nx">strip</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">buildOptionList</span><span class="p">()}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">onFailure</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">onFailure</span><span class="p">});</span><span class="k">new</span> <span class="nx">Ajax</span><span class="p">.</span><span class="nx">Request</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadTextURL</span><span class="p">,</span><span class="nx">A</span><span class="p">)},</span><span class="nx">buildOptionList</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">removeClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loadingClassName</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">_collection</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_collection</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="mi">2</span><span class="o">===</span><span class="nx">D</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="nx">D</span><span class="o">:</span><span class="p">[</span><span class="nx">D</span><span class="p">,</span><span class="nx">D</span><span class="p">].</span><span class="nx">flatten</span><span class="p">()});</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;value&quot;</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">)</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">value</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_text</span><span class="p">;</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">_collection</span><span class="p">.</span><span class="nx">any</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="k">return</span> <span class="nx">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="nx">B</span><span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">C</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">_collection</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="nx">C</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span><span class="nx">C</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">E</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="nx">C</span><span class="p">.</span><span class="nx">selected</span><span class="o">=</span><span class="nx">A</span><span class="o">?</span><span class="nx">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="nx">B</span><span class="o">:</span><span class="mi">0</span><span class="o">==</span><span class="nx">D</span><span class="p">;</span><span class="nx">C</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">C</span><span class="p">)}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="nx">Field</span><span class="p">.</span><span class="nx">scrollFreeActivate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_controls</span><span class="p">.</span><span class="nx">editor</span><span class="p">)}});</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">dealWithDeprecatedOptions</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">D</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">C</span> <span class="k">in</span> <span class="nx">A</span><span class="o">||</span><span class="nx">D</span><span class="o">===</span><span class="kc">undefined</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="nx">A</span><span class="p">[</span><span class="nx">C</span><span class="p">]</span><span class="o">=</span><span class="nx">D</span><span class="p">}</span><span class="nx">B</span><span class="p">(</span><span class="s2">&quot;cancelControl&quot;</span><span class="p">,(</span><span class="nx">A</span><span class="p">.</span><span class="nx">cancelLink</span><span class="o">?</span><span class="s2">&quot;link&quot;</span><span class="o">:</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">cancelButton</span><span class="o">?</span><span class="s2">&quot;button&quot;</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">cancelLink</span><span class="o">==</span><span class="nx">A</span><span class="p">.</span><span class="nx">cancelButton</span><span class="o">==</span><span class="kc">false</span><span class="o">?</span><span class="kc">false</span><span class="o">:</span><span class="kc">undefined</span><span class="p">)));</span><span class="nx">B</span><span class="p">(</span><span class="s2">&quot;okControl&quot;</span><span class="p">,(</span><span class="nx">A</span><span class="p">.</span><span class="nx">okLink</span><span class="o">?</span><span class="s2">&quot;link&quot;</span><span class="o">:</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">okButton</span><span class="o">?</span><span class="s2">&quot;button&quot;</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">okLink</span><span class="o">==</span><span class="nx">A</span><span class="p">.</span><span class="nx">okButton</span><span class="o">==</span><span class="kc">false</span><span class="o">?</span><span class="kc">false</span><span class="o">:</span><span class="kc">undefined</span><span class="p">)));</span><span class="nx">B</span><span class="p">(</span><span class="s2">&quot;highlightColor&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">highlightcolor</span><span class="p">);</span><span class="nx">B</span><span class="p">(</span><span class="s2">&quot;highlightEndColor&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">highlightendcolor</span><span class="p">)};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceEditor</span><span class="p">,{</span><span class="nx">DefaultOptions</span><span class="o">:</span><span class="p">{</span><span class="nx">ajaxOptions</span><span class="o">:</span><span class="p">{},</span><span class="nx">autoRows</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">cancelControl</span><span class="o">:</span><span class="s2">&quot;link&quot;</span><span class="p">,</span><span class="nx">cancelText</span><span class="o">:</span><span class="s2">&quot;cancel&quot;</span><span class="p">,</span><span class="nx">clickToEditText</span><span class="o">:</span><span class="s2">&quot;Click to edit&quot;</span><span class="p">,</span><span class="nx">externalControl</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">externalControlOnly</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">fieldPostCreation</span><span class="o">:</span><span class="s2">&quot;activate&quot;</span><span class="p">,</span><span class="nx">formClassName</span><span class="o">:</span><span class="s2">&quot;inplaceeditor-form&quot;</span><span class="p">,</span><span class="nx">formId</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">highlightColor</span><span class="o">:</span><span class="s2">&quot;#ffff99&quot;</span><span class="p">,</span><span class="nx">highlightEndColor</span><span class="o">:</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span><span class="nx">hoverClassName</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">htmlResponse</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">loadingClassName</span><span class="o">:</span><span class="s2">&quot;inplaceeditor-loading&quot;</span><span class="p">,</span><span class="nx">loadingText</span><span class="o">:</span><span class="s2">&quot;Loading...&quot;</span><span class="p">,</span><span class="nx">okControl</span><span class="o">:</span><span class="s2">&quot;button&quot;</span><span class="p">,</span><span class="nx">okText</span><span class="o">:</span><span class="s2">&quot;ok&quot;</span><span class="p">,</span><span class="nx">paramName</span><span class="o">:</span><span class="s2">&quot;value&quot;</span><span class="p">,</span><span class="nx">rows</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">savingClassName</span><span class="o">:</span><span class="s2">&quot;inplaceeditor-saving&quot;</span><span class="p">,</span><span class="nx">savingText</span><span class="o">:</span><span class="s2">&quot;Saving...&quot;</span><span class="p">,</span><span class="nx">size</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">stripLoadedTextTags</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">submitOnBlur</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">textAfterControls</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">textBeforeControls</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">textBetweenControls</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="nx">DefaultCallbacks</span><span class="o">:</span><span class="p">{</span><span class="nx">callback</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">Form</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(</span><span class="nx">A</span><span class="p">)},</span><span class="nx">onComplete</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Highlight</span><span class="p">(</span><span class="nx">A</span><span class="p">,{</span><span class="nx">startcolor</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">highlightColor</span><span class="p">,</span><span class="nx">keepBackgroundImage</span><span class="o">:</span><span class="kc">true</span><span class="p">})},</span><span class="nx">onEnterEditMode</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">onEnterHover</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">highlightColor</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">_effect</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">_effect</span><span class="p">.</span><span class="nx">cancel</span><span class="p">()}},</span><span class="nx">onFailure</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Error communication with the server: &quot;</span><span class="o">+</span><span class="nx">B</span><span class="p">.</span><span class="nx">responseText</span><span class="p">.</span><span class="nx">stripTags</span><span class="p">())},</span><span class="nx">onFormCustomization</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">onLeaveEditMode</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">onLeaveHover</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">_effect</span><span class="o">=</span><span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Highlight</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">element</span><span class="p">,{</span><span class="nx">startcolor</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">highlightColor</span><span class="p">,</span><span class="nx">endcolor</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">highlightEndColor</span><span class="p">,</span><span class="nx">restorecolor</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">_originalBackground</span><span class="p">,</span><span class="nx">keepBackgroundImage</span><span class="o">:</span><span class="kc">true</span><span class="p">})}},</span><span class="nx">Listeners</span><span class="o">:</span><span class="p">{</span><span class="nx">click</span><span class="o">:</span><span class="s2">&quot;enterEditMode&quot;</span><span class="p">,</span><span class="nx">keydown</span><span class="o">:</span><span class="s2">&quot;checkForEscapeOrReturn&quot;</span><span class="p">,</span><span class="nx">mouseover</span><span class="o">:</span><span class="s2">&quot;enterHover&quot;</span><span class="p">,</span><span class="nx">mouseout</span><span class="o">:</span><span class="s2">&quot;leaveHover&quot;</span><span class="p">}});</span><span class="nx">Ajax</span><span class="p">.</span><span class="nx">InPlaceCollectionEditor</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="o">=</span><span class="p">{</span><span class="nx">loadingCollectionText</span><span class="o">:</span><span class="s2">&quot;Loading options...&quot;</span><span class="p">};</span><span class="nx">Form</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">DelayedObserver</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">C</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">delay</span><span class="o">=</span><span class="nx">A</span><span class="o">||</span><span class="mf">0.5</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">=</span><span class="nx">$F</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="s2">&quot;keyup&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">delayedListener</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">))},</span><span class="nx">delayedListener</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">==</span><span class="nx">$F</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)){</span><span class="k">return</span> <span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">){</span><span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="o">=</span><span class="nx">setTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onTimerEvent</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">delay</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="o">=</span><span class="nx">$F</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">)},</span><span class="nx">onTimerEvent</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span><span class="nx">$F</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">))}});</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Control</span><span class="p">){</span><span class="kd">var</span> <span class="nx">Control</span><span class="o">=</span><span class="p">{}}</span><span class="nx">Control</span><span class="p">.</span><span class="nx">Slider</span><span class="o">=</span><span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">D</span><span class="p">)){</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">collect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">E</span><span class="p">)})}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="o">=</span><span class="p">[</span><span class="nx">$</span><span class="p">(</span><span class="nx">D</span><span class="p">)]}</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="nx">B</span><span class="o">||</span><span class="p">{};</span><span class="k">this</span><span class="p">.</span><span class="nx">axis</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">axis</span><span class="o">||</span><span class="s2">&quot;horizontal&quot;</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">increment</span><span class="o">||</span><span class="mi">1</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">step</span><span class="o">=</span><span class="nb">parseInt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">step</span><span class="o">||</span><span class="s2">&quot;1&quot;</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">range</span><span class="o">||</span><span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="mi">0</span><span class="p">});</span><span class="k">this</span><span class="p">.</span><span class="nx">spans</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">spans</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">spans</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">E</span><span class="p">){</span><span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">E</span><span class="p">)})</span><span class="o">:</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">startSpan</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">startSpan</span><span class="o">||</span><span class="kc">null</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endSpan</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endSpan</span><span class="o">||</span><span class="kc">null</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">restricted</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">restricted</span><span class="o">||</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">maximum</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">maximum</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">end</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">minimum</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">minimum</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">alignX</span><span class="o">=</span><span class="nb">parseInt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">alignX</span><span class="o">||</span><span class="s2">&quot;0&quot;</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">alignY</span><span class="o">=</span><span class="nb">parseInt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">alignY</span><span class="o">||</span><span class="s2">&quot;0&quot;</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">trackLength</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">maximumOffset</span><span class="p">()</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">minimumOffset</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">handleLength</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">isVertical</span><span class="p">()</span><span class="o">?</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="o">!=</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/px$/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">:</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="o">!=</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/px$/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">));</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">disabled</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">setDisabled</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">values</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">sortBy</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">)</span><span class="o">:</span><span class="kc">false</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">minimum</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">.</span><span class="nx">min</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">maximum</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">.</span><span class="nx">max</span><span class="p">()}</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseDown</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">startDrag</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseUp</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">endDrag</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseMove</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">.</span><span class="nx">bindAsEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">F</span><span class="p">,</span><span class="nx">E</span><span class="p">){</span><span class="nx">E</span><span class="o">=</span><span class="nx">C</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="nx">E</span><span class="p">;</span><span class="nx">C</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nb">parseFloat</span><span class="p">((</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">sliderValue</span><span class="p">)</span><span class="o">?</span><span class="nx">C</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">sliderValue</span><span class="p">[</span><span class="nx">E</span><span class="p">]</span><span class="o">:</span><span class="nx">C</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">sliderValue</span><span class="p">)</span><span class="o">||</span><span class="nx">C</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">),</span><span class="nx">E</span><span class="p">);</span><span class="nx">F</span><span class="p">.</span><span class="nx">makePositioned</span><span class="p">().</span><span class="nx">observe</span><span class="p">(</span><span class="s2">&quot;mousedown&quot;</span><span class="p">,</span><span class="nx">C</span><span class="p">.</span><span class="nx">eventMouseDown</span><span class="p">)});</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s2">&quot;mousedown&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseDown</span><span class="p">);</span><span class="nb">document</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s2">&quot;mouseup&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseUp</span><span class="p">);</span><span class="nb">document</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s2">&quot;mousemove&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseMove</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">initialized</span><span class="o">=</span><span class="kc">true</span><span class="p">},</span><span class="nx">dispose</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">,</span><span class="s2">&quot;mousedown&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseDown</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="s2">&quot;mouseup&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseUp</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span><span class="s2">&quot;mousemove&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">eventMouseMove</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stopObserving</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;mousedown&quot;</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">eventMouseDown</span><span class="p">)})},</span><span class="nx">setDisabled</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">true</span><span class="p">},</span><span class="nx">setEnabled</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">false</span><span class="p">},</span><span class="nx">getNearestValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&gt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">.</span><span class="nx">max</span><span class="p">()){</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">.</span><span class="nx">max</span><span class="p">())}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&lt;=</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">.</span><span class="nx">min</span><span class="p">()){</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">.</span><span class="nx">min</span><span class="p">())}</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">A</span><span class="p">);</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedValues</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">D</span><span class="o">-</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="o">&lt;=</span><span class="nx">C</span><span class="p">){</span><span class="nx">B</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="nx">C</span><span class="o">=</span><span class="nx">E</span><span class="p">}});</span><span class="k">return</span> <span class="nx">B</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">end</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">end</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">}</span><span class="k">return</span> <span class="nx">A</span><span class="p">},</span><span class="nx">setValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandleIdx</span><span class="o">=</span><span class="nx">A</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandle</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandleIdx</span><span class="p">];</span><span class="k">this</span><span class="p">.</span><span class="nx">updateStyles</span><span class="p">()}</span><span class="nx">A</span><span class="o">=</span><span class="nx">A</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandleIdx</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">initialized</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">restricted</span><span class="p">){</span><span class="k">if</span><span class="p">((</span><span class="nx">A</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">B</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="o">-</span><span class="mi">1</span><span class="p">])){</span><span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span><span class="k">if</span><span class="p">((</span><span class="nx">A</span><span class="o">&lt;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">B</span><span class="o">&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="o">+</span><span class="mi">1</span><span class="p">])){</span><span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="o">+</span><span class="mi">1</span><span class="p">]}}</span><span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">getNearestValue</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="p">]</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">[</span><span class="nx">A</span><span class="p">].</span><span class="nx">style</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">isVertical</span><span class="p">()</span><span class="o">?</span><span class="s2">&quot;top&quot;</span><span class="o">:</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">translateToPx</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">drawSpans</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="o">||!</span><span class="k">this</span><span class="p">.</span><span class="nx">event</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">updateFinished</span><span class="p">()}},</span><span class="nx">setValueBy</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">A</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandleIdx</span><span class="o">||</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandleIdx</span><span class="o">||</span><span class="mi">0</span><span class="p">)},</span><span class="nx">translateToPx</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="nx">trackLength</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">handleLength</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">end</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nx">A</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">},</span><span class="nx">translateToValue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span><span class="p">((</span><span class="nx">A</span><span class="o">/</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">trackLength</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">handleLength</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">end</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">))</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">)},</span><span class="nx">getRange</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">sortBy</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">K</span><span class="p">);</span><span class="nx">B</span><span class="o">=</span><span class="nx">B</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span> <span class="nx">$R</span><span class="p">(</span><span class="nx">A</span><span class="p">[</span><span class="nx">B</span><span class="p">],</span><span class="nx">A</span><span class="p">[</span><span class="nx">B</span><span class="o">+</span><span class="mi">1</span><span class="p">])},</span><span class="nx">minimumOffset</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isVertical</span><span class="p">()</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">alignY</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">alignX</span><span class="p">)},</span><span class="nx">maximumOffset</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isVertical</span><span class="p">()</span><span class="o">?</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="o">!=</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/px$/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">alignY</span><span class="o">:</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">!=</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/px$/</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">alignX</span><span class="p">)},</span><span class="nx">isVertical</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">axis</span><span class="o">==</span><span class="s2">&quot;vertical&quot;</span><span class="p">)},</span><span class="nx">drawSpans</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">spans</span><span class="p">){</span><span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">spans</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="nx">A</span><span class="p">.</span><span class="nx">setSpan</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">spans</span><span class="p">[</span><span class="nx">B</span><span class="p">],</span><span class="nx">A</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">B</span><span class="p">))})}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">startSpan</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">setSpan</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">startSpan</span><span class="p">,</span><span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">min</span><span class="p">()</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">))}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endSpan</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">setSpan</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">endSpan</span><span class="p">,</span><span class="nx">$R</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">spans</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">max</span><span class="p">()</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">maximum</span><span class="p">))}},</span><span class="nx">setSpan</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isVertical</span><span class="p">()){</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">translateToPx</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">start</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">translateToPx</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">end</span><span class="o">-</span><span class="nx">A</span><span class="p">.</span><span class="nx">start</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">translateToPx</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">start</span><span class="p">);</span><span class="nx">B</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">translateToPx</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">end</span><span class="o">-</span><span class="nx">A</span><span class="p">.</span><span class="nx">start</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">start</span><span class="p">)}},</span><span class="nx">updateStyles</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">Element</span><span class="p">.</span><span class="nx">removeClassName</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="s2">&quot;selected&quot;</span><span class="p">)});</span><span class="nx">Element</span><span class="p">.</span><span class="nx">addClassName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandle</span><span class="p">,</span><span class="s2">&quot;selected&quot;</span><span class="p">)},</span><span class="nx">startDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">C</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">Event</span><span class="p">.</span><span class="nx">isLeftClick</span><span class="p">(</span><span class="nx">C</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">disabled</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="kd">var</span> <span class="nx">D</span><span class="o">=</span><span class="nx">Event</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span><span class="kd">var</span> <span class="nx">E</span><span class="o">=</span><span class="p">[</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerX</span><span class="p">(</span><span class="nx">C</span><span class="p">),</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerY</span><span class="p">(</span><span class="nx">C</span><span class="p">)];</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="o">==</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">){</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">event</span><span class="o">=</span><span class="nx">C</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">translateToValue</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">isVertical</span><span class="p">()</span><span class="o">?</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="nx">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handleLength</span><span class="o">/</span><span class="mi">2</span><span class="p">)));</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandle</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">offsetX</span><span class="o">=</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="k">this</span><span class="p">.</span><span class="nx">offsetY</span><span class="o">=</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span><span class="k">else</span><span class="p">{</span><span class="k">while</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">){</span><span class="nx">D</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">D</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandle</span><span class="o">=</span><span class="nx">D</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandleIdx</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandle</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">updateStyles</span><span class="p">();</span><span class="kd">var</span> <span class="nx">B</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">activeHandle</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">offsetX</span><span class="o">=</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="k">this</span><span class="p">.</span><span class="nx">offsetY</span><span class="o">=</span><span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nx">B</span><span class="p">[</span><span class="mi">1</span><span class="p">])}}}</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">C</span><span class="p">)}},</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="o">=</span><span class="kc">true</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">WebKit</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">scrollBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">)}},</span><span class="nx">draw</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="p">[</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerX</span><span class="p">(</span><span class="nx">B</span><span class="p">),</span><span class="nx">Event</span><span class="p">.</span><span class="nx">pointerY</span><span class="p">(</span><span class="nx">B</span><span class="p">)];</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">cumulativeOffset</span><span class="p">();</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-=</span><span class="k">this</span><span class="p">.</span><span class="nx">offsetX</span><span class="o">+</span><span class="nx">A</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-=</span><span class="k">this</span><span class="p">.</span><span class="nx">offsetY</span><span class="o">+</span><span class="nx">A</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="k">this</span><span class="p">.</span><span class="nx">event</span><span class="o">=</span><span class="nx">B</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">translateToValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isVertical</span><span class="p">()</span><span class="o">?</span><span class="nx">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="nx">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">initialized</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onSlide</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onSlide</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="k">this</span><span class="p">)}},</span><span class="nx">endDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">finishDrag</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span><span class="nx">Event</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">A</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="o">=</span><span class="kc">false</span><span class="p">},</span><span class="nx">finishDrag</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">active</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">dragging</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">updateFinished</span><span class="p">()},</span><span class="nx">updateFinished</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">initialized</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onChange</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">onChange</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">values</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="k">this</span><span class="p">)}</span><span class="k">this</span><span class="p">.</span><span class="nx">event</span><span class="o">=</span><span class="kc">null</span><span class="p">}});</span><span class="nx">Sound</span><span class="o">=</span><span class="p">{</span><span class="nx">tracks</span><span class="o">:</span><span class="p">{},</span><span class="nx">_enabled</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">template</span><span class="o">:</span><span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="s1">&#39;&lt;embed style=&quot;height:0&quot; id=&quot;sound_#{track}_#{id}&quot; src=&quot;#{url}&quot; loop=&quot;false&quot; autostart=&quot;true&quot; hidden=&quot;true&quot;/&gt;&#39;</span><span class="p">),</span><span class="nx">enable</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">_enabled</span><span class="o">=</span><span class="kc">true</span><span class="p">},</span><span class="nx">disable</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">_enabled</span><span class="o">=</span><span class="kc">false</span><span class="p">},</span><span class="nx">play</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">B</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">_enabled</span><span class="p">){</span><span class="k">return</span> <span class="p">}</span><span class="kd">var</span> <span class="nx">A</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">track</span><span class="o">:</span><span class="s2">&quot;global&quot;</span><span class="p">,</span><span class="nx">url</span><span class="o">:</span><span class="nx">B</span><span class="p">,</span><span class="nx">replace</span><span class="o">:</span><span class="kc">false</span><span class="p">},</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{});</span><span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">replace</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="p">]){</span><span class="nx">$R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="p">].</span><span class="nx">id</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">D</span><span class="p">){</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;sound_&quot;</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nx">D</span><span class="p">);</span><span class="nx">C</span><span class="p">.</span><span class="nx">Stop</span><span class="o">&amp;&amp;</span><span class="nx">C</span><span class="p">.</span><span class="nx">Stop</span><span class="p">();</span><span class="nx">C</span><span class="p">.</span><span class="nx">remove</span><span class="p">()});</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="p">]</span><span class="o">=</span><span class="kc">null</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="p">]){</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">0</span><span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="p">].</span><span class="nx">id</span><span class="o">++</span><span class="p">}</span><span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">tracks</span><span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="p">].</span><span class="nx">id</span><span class="p">;</span><span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">insert</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">IE</span><span class="o">?</span><span class="k">new</span> <span class="nx">Element</span><span class="p">(</span><span class="s2">&quot;bgsound&quot;</span><span class="p">,{</span><span class="nx">id</span><span class="o">:</span><span class="s2">&quot;sound_&quot;</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">track</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nx">A</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">src</span><span class="o">:</span><span class="nx">A</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="nx">loop</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">autostart</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span><span class="o">:</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">template</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">A</span><span class="p">))}};</span><span class="k">if</span><span class="p">(</span><span class="nx">Prototype</span><span class="p">.</span><span class="nx">Browser</span><span class="p">.</span><span class="nx">Gecko</span><span class="o">&amp;&amp;</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;Win&quot;</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">plugins</span><span class="o">&amp;&amp;</span><span class="nx">$A</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">plugins</span><span class="p">).</span><span class="nx">detect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;QuickTime&quot;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">})){</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">template</span><span class="o">=</span><span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="s1">&#39;&lt;object id=&quot;sound_#{track}_#{id}&quot; width=&quot;0&quot; height=&quot;0&quot; type=&quot;audio/mpeg&quot; data=&quot;#{url}&quot;/&gt;&#39;</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">plugins</span><span class="o">&amp;&amp;</span><span class="nx">$A</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">plugins</span><span class="p">).</span><span class="nx">detect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;Windows Media&quot;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">})){</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">template</span><span class="o">=</span><span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="s1">&#39;&lt;object id=&quot;sound_#{track}_#{id}&quot; type=&quot;application/x-mplayer2&quot; data=&quot;#{url}&quot;&gt;&lt;/object&gt;&#39;</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">plugins</span><span class="o">&amp;&amp;</span><span class="nx">$A</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">plugins</span><span class="p">).</span><span class="nx">detect</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="k">return</span> <span class="nx">A</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;RealPlayer&quot;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">})){</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">template</span><span class="o">=</span><span class="k">new</span> <span class="nx">Template</span><span class="p">(</span><span class="s1">&#39;&lt;embed type=&quot;audio/x-pn-realaudio-plugin&quot; style=&quot;height:0&quot; id=&quot;sound_#{track}_#{id}&quot; src=&quot;#{url}&quot; loop=&quot;false&quot; autostart=&quot;true&quot; hidden=&quot;true&quot;/&gt;&#39;</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">play</span><span class="o">=</span><span class="kd">function</span><span class="p">(){}}}}};</span>
<span class="kd">var</span> <span class="nx">Cookie</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">data</span><span class="o">:</span> <span class="p">{},</span>
  <span class="nx">options</span><span class="o">:</span> <span class="p">{</span><span class="nx">expires</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">domain</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">path</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">secure</span><span class="o">:</span> <span class="kc">false</span><span class="p">},</span>

<span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{});</span>

  <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Cookie</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">payload</span><span class="p">.</span><span class="nx">evalJSON</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">Cookie</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="p">}</span>
        <span class="nx">Cookie</span><span class="p">.</span><span class="nx">store</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">getData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
    <span class="p">},</span>
    <span class="nx">setData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Cookie</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="nx">Cookie</span><span class="p">.</span><span class="nx">store</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">removeData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">delete</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
        <span class="nx">Cookie</span><span class="p">.</span><span class="nx">store</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">retrieve</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="nx">start</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span> <span class="o">!=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">start</span> <span class="o">+</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>   
        <span class="kd">var</span> <span class="nx">end</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="nx">len</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="nx">end</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">end</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="p">}</span> 
        <span class="k">return</span> <span class="nx">unescape</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">len</span><span class="p">,</span> <span class="nx">end</span><span class="p">));</span>
    <span class="p">},</span>
    <span class="nx">store</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">expires</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">expires</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
            <span class="nx">expires</span> <span class="o">=</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">expires</span> <span class="o">*</span> <span class="mi">86400000</span><span class="p">;</span>
            <span class="nx">expires</span> <span class="o">=</span> <span class="s1">&#39;;expires=&#39;</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nx">expires</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nx">escape</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">(</span><span class="nx">Cookie</span><span class="p">.</span><span class="nx">data</span><span class="p">))</span> <span class="o">+</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">getOptions</span><span class="p">()</span> <span class="o">+</span> <span class="nx">expires</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">erase</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">getOptions</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;;expires=Thu, 01-Jan-1970 00:00:01 GMT&#39;</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">getOptions</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">path</span> <span class="o">?</span> <span class="s1">&#39;;path=&#39;</span> <span class="o">+</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">path</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">domain</span> <span class="o">?</span> <span class="s1">&#39;;domain=&#39;</span> <span class="o">+</span> <span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">domain</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">Cookie</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">secure</span> <span class="o">?</span> <span class="s1">&#39;;secure&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>      
    <span class="p">}</span>
<span class="p">};</span>



<span class="nx">Effect</span><span class="p">.</span><span class="nx">BlindRight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">element</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">elementDimensions</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">getDimensions</span><span class="p">();</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span> 
    <span class="nx">scaleContent</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> 
    <span class="nx">scaleY</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">scaleFrom</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">scaleMode</span><span class="o">:</span> <span class="p">{</span><span class="nx">originalHeight</span><span class="o">:</span> <span class="nx">elementDimensions</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="nx">originalWidth</span><span class="o">:</span> <span class="nx">elementDimensions</span><span class="p">.</span><span class="nx">width</span><span class="p">},</span>
    <span class="nx">restoreAfterFinish</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">afterSetup</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">effect</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">effect</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">makeClipping</span><span class="p">().</span><span class="nx">setStyle</span><span class="p">({</span><span class="nx">width</span><span class="o">:</span> <span class="s1">&#39;0px&#39;</span><span class="p">}).</span><span class="nx">show</span><span class="p">();</span> 
    <span class="p">},</span>  
    <span class="nx">afterFinishInternal</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">effect</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">effect</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">undoClipping</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">},</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="p">{</span> <span class="p">}));</span>
<span class="p">};</span>
<span class="nx">Effect</span><span class="p">.</span><span class="nx">BlindLeft</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">element</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
  <span class="nx">element</span><span class="p">.</span><span class="nx">makeClipping</span><span class="p">();</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">Effect</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span> <span class="nx">scaleContent</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> 
      <span class="nx">scaleY</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> 
      <span class="nx">restoreAfterFinish</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">afterFinishInternal</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">effect</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">effect</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">hide</span><span class="p">().</span><span class="nx">undoClipping</span><span class="p">();</span>
      <span class="p">}</span> 
    <span class="p">},</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="p">{</span> <span class="p">})</span>
  <span class="p">);</span>
<span class="p">};</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 